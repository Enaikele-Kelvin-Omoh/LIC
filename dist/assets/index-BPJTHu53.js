var eO=Object.defineProperty;var S1=n=>{throw TypeError(n)};var tO=(n,e,t)=>e in n?eO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ce=(n,e,t)=>tO(n,typeof e!="symbol"?e+"":e,t),P0=(n,e,t)=>e.has(n)||S1("Cannot "+t);var u=(n,e,t)=>(P0(n,e,"read from private field"),t?t.call(n):e.get(n)),R=(n,e,t)=>e.has(n)?S1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),T=(n,e,t,i)=>(P0(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),C=(n,e,t)=>(P0(n,e,"access private method"),t);var Rn=(n,e,t,i)=>({set _(s){T(n,e,s,t)},get _(){return u(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function uT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var BR={exports:{}},i_={},$R={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg=Symbol.for("react.element"),nO=Symbol.for("react.portal"),iO=Symbol.for("react.fragment"),sO=Symbol.for("react.strict_mode"),rO=Symbol.for("react.profiler"),oO=Symbol.for("react.provider"),aO=Symbol.for("react.context"),lO=Symbol.for("react.forward_ref"),cO=Symbol.for("react.suspense"),uO=Symbol.for("react.memo"),hO=Symbol.for("react.lazy"),b1=Symbol.iterator;function dO(n){return n===null||typeof n!="object"?null:(n=b1&&n[b1]||n["@@iterator"],typeof n=="function"?n:null)}var zR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HR=Object.assign,qR={};function Gh(n,e,t){this.props=n,this.context=e,this.refs=qR,this.updater=t||zR}Gh.prototype.isReactComponent={};Gh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Gh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function WR(){}WR.prototype=Gh.prototype;function hT(n,e,t){this.props=n,this.context=e,this.refs=qR,this.updater=t||zR}var dT=hT.prototype=new WR;dT.constructor=hT;HR(dT,Gh.prototype);dT.isPureReactComponent=!0;var I1=Array.isArray,GR=Object.prototype.hasOwnProperty,fT={current:null},KR={key:!0,ref:!0,__self:!0,__source:!0};function XR(n,e,t){var i,s={},r=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)GR.call(e,i)&&!KR.hasOwnProperty(i)&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return{$$typeof:yg,type:n,key:r,ref:o,props:s,_owner:fT.current}}function fO(n,e){return{$$typeof:yg,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function pT(n){return typeof n=="object"&&n!==null&&n.$$typeof===yg}function pO(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var C1=/\/+/g;function N0(n,e){return typeof n=="object"&&n!==null&&n.key!=null?pO(""+n.key):e.toString(36)}function Vm(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case yg:case nO:o=!0}}if(o)return o=n,s=s(o),n=i===""?"."+N0(o,0):i,I1(s)?(t="",n!=null&&(t=n.replace(C1,"$&/")+"/"),Vm(s,e,t,"",function(c){return c})):s!=null&&(pT(s)&&(s=fO(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(C1,"$&/")+"/")+n)),e.push(s)),1;if(o=0,i=i===""?".":i+":",I1(n))for(var a=0;a<n.length;a++){r=n[a];var l=i+N0(r,a);o+=Vm(r,e,t,l,s)}else if(l=dO(n),typeof l=="function")for(n=l.call(n),a=0;!(r=n.next()).done;)r=r.value,l=i+N0(r,a++),o+=Vm(r,e,t,l,s);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rm(n,e,t){if(n==null)return n;var i=[],s=0;return Vm(n,i,"","",function(r){return e.call(t,r,s++)}),i}function gO(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var jn={current:null},Um={transition:null},mO={ReactCurrentDispatcher:jn,ReactCurrentBatchConfig:Um,ReactCurrentOwner:fT};function QR(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:rm,forEach:function(n,e,t){rm(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return rm(n,function(){e++}),e},toArray:function(n){return rm(n,function(e){return e})||[]},only:function(n){if(!pT(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Se.Component=Gh;Se.Fragment=iO;Se.Profiler=rO;Se.PureComponent=hT;Se.StrictMode=sO;Se.Suspense=cO;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mO;Se.act=QR;Se.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=HR({},n.props),s=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=fT.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)GR.call(e,l)&&!KR.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:yg,type:n.type,key:s,ref:r,props:i,_owner:o}};Se.createContext=function(n){return n={$$typeof:aO,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:oO,_context:n},n.Consumer=n};Se.createElement=XR;Se.createFactory=function(n){var e=XR.bind(null,n);return e.type=n,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(n){return{$$typeof:lO,render:n}};Se.isValidElement=pT;Se.lazy=function(n){return{$$typeof:hO,_payload:{_status:-1,_result:n},_init:gO}};Se.memo=function(n,e){return{$$typeof:uO,type:n,compare:e===void 0?null:e}};Se.startTransition=function(n){var e=Um.transition;Um.transition={};try{n()}finally{Um.transition=e}};Se.unstable_act=QR;Se.useCallback=function(n,e){return jn.current.useCallback(n,e)};Se.useContext=function(n){return jn.current.useContext(n)};Se.useDebugValue=function(){};Se.useDeferredValue=function(n){return jn.current.useDeferredValue(n)};Se.useEffect=function(n,e){return jn.current.useEffect(n,e)};Se.useId=function(){return jn.current.useId()};Se.useImperativeHandle=function(n,e,t){return jn.current.useImperativeHandle(n,e,t)};Se.useInsertionEffect=function(n,e){return jn.current.useInsertionEffect(n,e)};Se.useLayoutEffect=function(n,e){return jn.current.useLayoutEffect(n,e)};Se.useMemo=function(n,e){return jn.current.useMemo(n,e)};Se.useReducer=function(n,e,t){return jn.current.useReducer(n,e,t)};Se.useRef=function(n){return jn.current.useRef(n)};Se.useState=function(n){return jn.current.useState(n)};Se.useSyncExternalStore=function(n,e,t){return jn.current.useSyncExternalStore(n,e,t)};Se.useTransition=function(){return jn.current.useTransition()};Se.version="18.3.1";$R.exports=Se;var U=$R.exports;const Ge=uT(U);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yO=U,vO=Symbol.for("react.element"),_O=Symbol.for("react.fragment"),wO=Object.prototype.hasOwnProperty,EO=yO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AO={key:!0,ref:!0,__self:!0,__source:!0};function YR(n,e,t){var i,s={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)wO.call(e,i)&&!AO.hasOwnProperty(i)&&(s[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:vO,type:n,key:r,ref:o,props:s,_owner:EO.current}}i_.Fragment=_O;i_.jsx=YR;i_.jsxs=YR;BR.exports=i_;var N=BR.exports,JR={exports:{}},Ri={},ZR={exports:{}},ek={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(B,Q){var ie=B.length;B.push(Q);e:for(;0<ie;){var fe=ie-1>>>1,ne=B[fe];if(0<s(ne,Q))B[fe]=Q,B[ie]=ne,ie=fe;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var Q=B[0],ie=B.pop();if(ie!==Q){B[0]=ie;e:for(var fe=0,ne=B.length,ae=ne>>>1;fe<ae;){var $e=2*(fe+1)-1,Ke=B[$e],De=$e+1,_e=B[De];if(0>s(Ke,ie))De<ne&&0>s(_e,Ke)?(B[fe]=_e,B[De]=ie,fe=De):(B[fe]=Ke,B[$e]=ie,fe=$e);else if(De<ne&&0>s(_e,ie))B[fe]=_e,B[De]=ie,fe=De;else break e}}return Q}function s(B,Q){var ie=B.sortIndex-Q.sortIndex;return ie!==0?ie:B.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,f=null,p=3,g=!1,y=!1,_=!1,A=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(B){for(var Q=t(c);Q!==null;){if(Q.callback===null)i(c);else if(Q.startTime<=B)i(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=t(c)}}function P(B){if(_=!1,S(B),!y)if(t(l)!==null)y=!0,K(O);else{var Q=t(c);Q!==null&&z(P,Q.startTime-B)}}function O(B,Q){y=!1,_&&(_=!1,v(b),b=-1),g=!0;var ie=p;try{for(S(Q),f=t(l);f!==null&&(!(f.expirationTime>Q)||B&&!M());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,p=f.priorityLevel;var ne=fe(f.expirationTime<=Q);Q=n.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&i(l),S(Q)}else i(l);f=t(l)}if(f!==null)var ae=!0;else{var $e=t(c);$e!==null&&z(P,$e.startTime-Q),ae=!1}return ae}finally{f=null,p=ie,g=!1}}var F=!1,I=null,b=-1,k=5,L=-1;function M(){return!(n.unstable_now()-L<k)}function V(){if(I!==null){var B=n.unstable_now();L=B;var Q=!0;try{Q=I(!0,B)}finally{Q?D():(F=!1,I=null)}}else F=!1}var D;if(typeof E=="function")D=function(){E(V)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Pe=oe.port2;oe.port1.onmessage=V,D=function(){Pe.postMessage(null)}}else D=function(){A(V,0)};function K(B){I=B,F||(F=!0,D())}function z(B,Q){b=A(function(){B(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,K(O))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var ie=p;p=Q;try{return B()}finally{p=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,Q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var ie=p;p=B;try{return Q()}finally{p=ie}},n.unstable_scheduleCallback=function(B,Q,ie){var fe=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?fe+ie:fe):ie=fe,B){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=ie+ne,B={id:h++,callback:Q,priorityLevel:B,startTime:ie,expirationTime:ne,sortIndex:-1},ie>fe?(B.sortIndex=ie,e(c,B),t(l)===null&&B===t(c)&&(_?(v(b),b=-1):_=!0,z(P,ie-fe))):(B.sortIndex=ne,e(l,B),y||g||(y=!0,K(O))),B},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(B){var Q=p;return function(){var ie=p;p=Q;try{return B.apply(this,arguments)}finally{p=ie}}}})(ek);ZR.exports=ek;var TO=ZR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SO=U,Ci=TO;function W(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tk=new Set,Af={};function Ec(n,e){Rh(n,e),Rh(n+"Capture",e)}function Rh(n,e){for(Af[n]=e,n=0;n<e.length;n++)tk.add(e[n])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rw=Object.prototype.hasOwnProperty,bO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,R1={},k1={};function IO(n){return Rw.call(k1,n)?!0:Rw.call(R1,n)?!1:bO.test(n)?k1[n]=!0:(R1[n]=!0,!1)}function CO(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function RO(n,e,t,i){if(e===null||typeof e>"u"||CO(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Bn(n,e,t,i,s,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){sn[n]=new Bn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];sn[e]=new Bn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){sn[n]=new Bn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){sn[n]=new Bn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){sn[n]=new Bn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){sn[n]=new Bn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){sn[n]=new Bn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){sn[n]=new Bn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){sn[n]=new Bn(n,5,!1,n.toLowerCase(),null,!1,!1)});var gT=/[\-:]([a-z])/g;function mT(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(gT,mT);sn[e]=new Bn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(gT,mT);sn[e]=new Bn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(gT,mT);sn[e]=new Bn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){sn[n]=new Bn(n,1,!1,n.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Bn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){sn[n]=new Bn(n,1,!1,n.toLowerCase(),null,!0,!0)});function yT(n,e,t,i){var s=sn.hasOwnProperty(e)?sn[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(RO(e,t,s,i)&&(t=null),i||s===null?IO(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,i=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var go=SO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,om=Symbol.for("react.element"),Yc=Symbol.for("react.portal"),Jc=Symbol.for("react.fragment"),vT=Symbol.for("react.strict_mode"),kw=Symbol.for("react.profiler"),nk=Symbol.for("react.provider"),ik=Symbol.for("react.context"),_T=Symbol.for("react.forward_ref"),xw=Symbol.for("react.suspense"),Pw=Symbol.for("react.suspense_list"),wT=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),sk=Symbol.for("react.offscreen"),x1=Symbol.iterator;function _d(n){return n===null||typeof n!="object"?null:(n=x1&&n[x1]||n["@@iterator"],typeof n=="function"?n:null)}var dt=Object.assign,L0;function Pd(n){if(L0===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);L0=e&&e[1]||""}return`
`+L0+n}var D0=!1;function M0(n,e){if(!n||D0)return"";D0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){i=c}n.call(e.prototype)}else{try{throw Error()}catch(c){i=c}n()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),r=i.stack.split(`
`),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==r[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{D0=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Pd(n):""}function kO(n){switch(n.tag){case 5:return Pd(n.type);case 16:return Pd("Lazy");case 13:return Pd("Suspense");case 19:return Pd("SuspenseList");case 0:case 2:case 15:return n=M0(n.type,!1),n;case 11:return n=M0(n.type.render,!1),n;case 1:return n=M0(n.type,!0),n;default:return""}}function Nw(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Jc:return"Fragment";case Yc:return"Portal";case kw:return"Profiler";case vT:return"StrictMode";case xw:return"Suspense";case Pw:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ik:return(n.displayName||"Context")+".Consumer";case nk:return(n._context.displayName||"Context")+".Provider";case _T:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case wT:return e=n.displayName||null,e!==null?e:Nw(n.type)||"Memo";case To:e=n._payload,n=n._init;try{return Nw(n(e))}catch{}}return null}function xO(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nw(e);case 8:return e===vT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ea(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function rk(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function PO(n){var e=rk(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function am(n){n._valueTracker||(n._valueTracker=PO(n))}function ok(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=rk(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function Vy(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Lw(n,e){var t=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function P1(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ea(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ak(n,e){e=e.checked,e!=null&&yT(n,"checked",e,!1)}function Dw(n,e){ak(n,e);var t=Ea(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Mw(n,e.type,t):e.hasOwnProperty("defaultValue")&&Mw(n,e.type,Ea(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function N1(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Mw(n,e,t){(e!=="number"||Vy(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Nd=Array.isArray;function du(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ea(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Ow(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function L1(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(W(92));if(Nd(t)){if(1<t.length)throw Error(W(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ea(t)}}function lk(n,e){var t=Ea(e.value),i=Ea(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function D1(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function ck(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fw(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?ck(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var lm,uk=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(lm=lm||document.createElement("div"),lm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lm.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Tf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var sf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NO=["Webkit","ms","Moz","O"];Object.keys(sf).forEach(function(n){NO.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),sf[e]=sf[n]})});function hk(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||sf.hasOwnProperty(n)&&sf[n]?(""+e).trim():e+"px"}function dk(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,s=hk(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,s):n[t]=s}}var LO=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vw(n,e){if(e){if(LO[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Uw(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jw=null;function ET(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Bw=null,fu=null,pu=null;function M1(n){if(n=wg(n)){if(typeof Bw!="function")throw Error(W(280));var e=n.stateNode;e&&(e=l_(e),Bw(n.stateNode,n.type,e))}}function fk(n){fu?pu?pu.push(n):pu=[n]:fu=n}function pk(){if(fu){var n=fu,e=pu;if(pu=fu=null,M1(n),e)for(n=0;n<e.length;n++)M1(e[n])}}function gk(n,e){return n(e)}function mk(){}var O0=!1;function yk(n,e,t){if(O0)return n(e,t);O0=!0;try{return gk(n,e,t)}finally{O0=!1,(fu!==null||pu!==null)&&(mk(),pk())}}function Sf(n,e){var t=n.stateNode;if(t===null)return null;var i=l_(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(W(231,e,typeof t));return t}var $w=!1;if(ro)try{var wd={};Object.defineProperty(wd,"passive",{get:function(){$w=!0}}),window.addEventListener("test",wd,wd),window.removeEventListener("test",wd,wd)}catch{$w=!1}function DO(n,e,t,i,s,r,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(h){this.onError(h)}}var rf=!1,Uy=null,jy=!1,zw=null,MO={onError:function(n){rf=!0,Uy=n}};function OO(n,e,t,i,s,r,o,a,l){rf=!1,Uy=null,DO.apply(MO,arguments)}function FO(n,e,t,i,s,r,o,a,l){if(OO.apply(this,arguments),rf){if(rf){var c=Uy;rf=!1,Uy=null}else throw Error(W(198));jy||(jy=!0,zw=c)}}function Ac(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function vk(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function O1(n){if(Ac(n)!==n)throw Error(W(188))}function VO(n){var e=n.alternate;if(!e){if(e=Ac(n),e===null)throw Error(W(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return O1(s),n;if(r===i)return O1(s),e;r=r.sibling}throw Error(W(188))}if(t.return!==i.return)t=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(t.alternate!==i)throw Error(W(190))}if(t.tag!==3)throw Error(W(188));return t.stateNode.current===t?n:e}function _k(n){return n=VO(n),n!==null?wk(n):null}function wk(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=wk(n);if(e!==null)return e;n=n.sibling}return null}var Ek=Ci.unstable_scheduleCallback,F1=Ci.unstable_cancelCallback,UO=Ci.unstable_shouldYield,jO=Ci.unstable_requestPaint,Et=Ci.unstable_now,BO=Ci.unstable_getCurrentPriorityLevel,AT=Ci.unstable_ImmediatePriority,Ak=Ci.unstable_UserBlockingPriority,By=Ci.unstable_NormalPriority,$O=Ci.unstable_LowPriority,Tk=Ci.unstable_IdlePriority,s_=null,Zs=null;function zO(n){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(s_,n,void 0,(n.current.flags&128)===128)}catch{}}var _s=Math.clz32?Math.clz32:WO,HO=Math.log,qO=Math.LN2;function WO(n){return n>>>=0,n===0?32:31-(HO(n)/qO|0)|0}var cm=64,um=4194304;function Ld(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function $y(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,s=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?i=Ld(a):(r&=o,r!==0&&(i=Ld(r)))}else o=t&~s,o!==0?i=Ld(o):r!==0&&(i=Ld(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,r=e&-e,s>=r||s===16&&(r&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-_s(e),s=1<<t,i|=n[t],e&=~s;return i}function GO(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KO(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-_s(r),a=1<<o,l=s[o];l===-1?(!(a&t)||a&i)&&(s[o]=GO(a,e)):l<=e&&(n.expiredLanes|=a),r&=~a}}function Hw(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Sk(){var n=cm;return cm<<=1,!(cm&4194240)&&(cm=64),n}function F0(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function vg(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-_s(e),n[e]=t}function XO(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-_s(t),r=1<<s;e[s]=0,i[s]=-1,n[s]=-1,t&=~r}}function TT(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-_s(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}var Be=0;function bk(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Ik,ST,Ck,Rk,kk,qw=!1,hm=[],ua=null,ha=null,da=null,bf=new Map,If=new Map,bo=[],QO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function V1(n,e){switch(n){case"focusin":case"focusout":ua=null;break;case"dragenter":case"dragleave":ha=null;break;case"mouseover":case"mouseout":da=null;break;case"pointerover":case"pointerout":bf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":If.delete(e.pointerId)}}function Ed(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=wg(e),e!==null&&ST(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function YO(n,e,t,i,s){switch(e){case"focusin":return ua=Ed(ua,n,e,t,i,s),!0;case"dragenter":return ha=Ed(ha,n,e,t,i,s),!0;case"mouseover":return da=Ed(da,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return bf.set(r,Ed(bf.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,If.set(r,Ed(If.get(r)||null,n,e,t,i,s)),!0}return!1}function xk(n){var e=tl(n.target);if(e!==null){var t=Ac(e);if(t!==null){if(e=t.tag,e===13){if(e=vk(t),e!==null){n.blockedOn=e,kk(n.priority,function(){Ck(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function jm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Ww(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);jw=i,t.target.dispatchEvent(i),jw=null}else return e=wg(t),e!==null&&ST(e),n.blockedOn=t,!1;e.shift()}return!0}function U1(n,e,t){jm(n)&&t.delete(e)}function JO(){qw=!1,ua!==null&&jm(ua)&&(ua=null),ha!==null&&jm(ha)&&(ha=null),da!==null&&jm(da)&&(da=null),bf.forEach(U1),If.forEach(U1)}function Ad(n,e){n.blockedOn===e&&(n.blockedOn=null,qw||(qw=!0,Ci.unstable_scheduleCallback(Ci.unstable_NormalPriority,JO)))}function Cf(n){function e(s){return Ad(s,n)}if(0<hm.length){Ad(hm[0],n);for(var t=1;t<hm.length;t++){var i=hm[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ua!==null&&Ad(ua,n),ha!==null&&Ad(ha,n),da!==null&&Ad(da,n),bf.forEach(e),If.forEach(e),t=0;t<bo.length;t++)i=bo[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<bo.length&&(t=bo[0],t.blockedOn===null);)xk(t),t.blockedOn===null&&bo.shift()}var gu=go.ReactCurrentBatchConfig,zy=!0;function ZO(n,e,t,i){var s=Be,r=gu.transition;gu.transition=null;try{Be=1,bT(n,e,t,i)}finally{Be=s,gu.transition=r}}function eF(n,e,t,i){var s=Be,r=gu.transition;gu.transition=null;try{Be=4,bT(n,e,t,i)}finally{Be=s,gu.transition=r}}function bT(n,e,t,i){if(zy){var s=Ww(n,e,t,i);if(s===null)G0(n,e,i,Hy,t),V1(n,i);else if(YO(s,n,e,t,i))i.stopPropagation();else if(V1(n,i),e&4&&-1<QO.indexOf(n)){for(;s!==null;){var r=wg(s);if(r!==null&&Ik(r),r=Ww(n,e,t,i),r===null&&G0(n,e,i,Hy,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else G0(n,e,i,null,t)}}var Hy=null;function Ww(n,e,t,i){if(Hy=null,n=ET(i),n=tl(n),n!==null)if(e=Ac(n),e===null)n=null;else if(t=e.tag,t===13){if(n=vk(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Hy=n,null}function Pk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BO()){case AT:return 1;case Ak:return 4;case By:case $O:return 16;case Tk:return 536870912;default:return 16}default:return 16}}var oa=null,IT=null,Bm=null;function Nk(){if(Bm)return Bm;var n,e=IT,t=e.length,i,s="value"in oa?oa.value:oa.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===s[r-i];i++);return Bm=s.slice(n,1<i?1-i:void 0)}function $m(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dm(){return!0}function j1(){return!1}function ki(n){function e(t,i,s,r,o){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?dm:j1,this.isPropagationStopped=j1,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dm)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dm)},persist:function(){},isPersistent:dm}),e}var Kh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},CT=ki(Kh),_g=dt({},Kh,{view:0,detail:0}),tF=ki(_g),V0,U0,Td,r_=dt({},_g,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RT,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Td&&(Td&&n.type==="mousemove"?(V0=n.screenX-Td.screenX,U0=n.screenY-Td.screenY):U0=V0=0,Td=n),V0)},movementY:function(n){return"movementY"in n?n.movementY:U0}}),B1=ki(r_),nF=dt({},r_,{dataTransfer:0}),iF=ki(nF),sF=dt({},_g,{relatedTarget:0}),j0=ki(sF),rF=dt({},Kh,{animationName:0,elapsedTime:0,pseudoElement:0}),oF=ki(rF),aF=dt({},Kh,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),lF=ki(aF),cF=dt({},Kh,{data:0}),$1=ki(cF),uF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fF(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=dF[n])?!!e[n]:!1}function RT(){return fF}var pF=dt({},_g,{key:function(n){if(n.key){var e=uF[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=$m(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?hF[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RT,charCode:function(n){return n.type==="keypress"?$m(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?$m(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),gF=ki(pF),mF=dt({},r_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z1=ki(mF),yF=dt({},_g,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RT}),vF=ki(yF),_F=dt({},Kh,{propertyName:0,elapsedTime:0,pseudoElement:0}),wF=ki(_F),EF=dt({},r_,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),AF=ki(EF),TF=[9,13,27,32],kT=ro&&"CompositionEvent"in window,of=null;ro&&"documentMode"in document&&(of=document.documentMode);var SF=ro&&"TextEvent"in window&&!of,Lk=ro&&(!kT||of&&8<of&&11>=of),H1=" ",q1=!1;function Dk(n,e){switch(n){case"keyup":return TF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mk(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Zc=!1;function bF(n,e){switch(n){case"compositionend":return Mk(e);case"keypress":return e.which!==32?null:(q1=!0,H1);case"textInput":return n=e.data,n===H1&&q1?null:n;default:return null}}function IF(n,e){if(Zc)return n==="compositionend"||!kT&&Dk(n,e)?(n=Nk(),Bm=IT=oa=null,Zc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Lk&&e.locale!=="ko"?null:e.data;default:return null}}var CF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function W1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!CF[n.type]:e==="textarea"}function Ok(n,e,t,i){fk(i),e=qy(e,"onChange"),0<e.length&&(t=new CT("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var af=null,Rf=null;function RF(n){Gk(n,0)}function o_(n){var e=nu(n);if(ok(e))return n}function kF(n,e){if(n==="change")return e}var Fk=!1;if(ro){var B0;if(ro){var $0="oninput"in document;if(!$0){var G1=document.createElement("div");G1.setAttribute("oninput","return;"),$0=typeof G1.oninput=="function"}B0=$0}else B0=!1;Fk=B0&&(!document.documentMode||9<document.documentMode)}function K1(){af&&(af.detachEvent("onpropertychange",Vk),Rf=af=null)}function Vk(n){if(n.propertyName==="value"&&o_(Rf)){var e=[];Ok(e,Rf,n,ET(n)),yk(RF,e)}}function xF(n,e,t){n==="focusin"?(K1(),af=e,Rf=t,af.attachEvent("onpropertychange",Vk)):n==="focusout"&&K1()}function PF(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return o_(Rf)}function NF(n,e){if(n==="click")return o_(e)}function LF(n,e){if(n==="input"||n==="change")return o_(e)}function DF(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var As=typeof Object.is=="function"?Object.is:DF;function kf(n,e){if(As(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!Rw.call(e,s)||!As(n[s],e[s]))return!1}return!0}function X1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Q1(n,e){var t=X1(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=X1(t)}}function Uk(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Uk(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function jk(){for(var n=window,e=Vy();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Vy(n.document)}return e}function xT(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function MF(n){var e=jk(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Uk(t.ownerDocument.documentElement,t)){if(i!==null&&xT(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=Q1(t,r);var o=Q1(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var OF=ro&&"documentMode"in document&&11>=document.documentMode,eu=null,Gw=null,lf=null,Kw=!1;function Y1(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Kw||eu==null||eu!==Vy(i)||(i=eu,"selectionStart"in i&&xT(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),lf&&kf(lf,i)||(lf=i,i=qy(Gw,"onSelect"),0<i.length&&(e=new CT("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=eu)))}function fm(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var tu={animationend:fm("Animation","AnimationEnd"),animationiteration:fm("Animation","AnimationIteration"),animationstart:fm("Animation","AnimationStart"),transitionend:fm("Transition","TransitionEnd")},z0={},Bk={};ro&&(Bk=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function a_(n){if(z0[n])return z0[n];if(!tu[n])return n;var e=tu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Bk)return z0[n]=e[t];return n}var $k=a_("animationend"),zk=a_("animationiteration"),Hk=a_("animationstart"),qk=a_("transitionend"),Wk=new Map,J1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(n,e){Wk.set(n,e),Ec(e,[n])}for(var H0=0;H0<J1.length;H0++){var q0=J1[H0],FF=q0.toLowerCase(),VF=q0[0].toUpperCase()+q0.slice(1);La(FF,"on"+VF)}La($k,"onAnimationEnd");La(zk,"onAnimationIteration");La(Hk,"onAnimationStart");La("dblclick","onDoubleClick");La("focusin","onFocus");La("focusout","onBlur");La(qk,"onTransitionEnd");Rh("onMouseEnter",["mouseout","mouseover"]);Rh("onMouseLeave",["mouseout","mouseover"]);Rh("onPointerEnter",["pointerout","pointerover"]);Rh("onPointerLeave",["pointerout","pointerover"]);Ec("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ec("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ec("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ec("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ec("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ec("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dd));function Z1(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,FO(i,e,void 0,n),n.currentTarget=null}function Gk(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;Z1(s,a,c),r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;Z1(s,a,c),r=l}}}if(jy)throw n=zw,jy=!1,zw=null,n}function Je(n,e){var t=e[Zw];t===void 0&&(t=e[Zw]=new Set);var i=n+"__bubble";t.has(i)||(Kk(e,n,2,!1),t.add(i))}function W0(n,e,t){var i=0;e&&(i|=4),Kk(t,n,i,e)}var pm="_reactListening"+Math.random().toString(36).slice(2);function xf(n){if(!n[pm]){n[pm]=!0,tk.forEach(function(t){t!=="selectionchange"&&(UF.has(t)||W0(t,!1,n),W0(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[pm]||(e[pm]=!0,W0("selectionchange",!1,e))}}function Kk(n,e,t,i){switch(Pk(e)){case 1:var s=ZO;break;case 4:s=eF;break;default:s=bT}t=s.bind(null,e,t,n),s=void 0,!$w||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function G0(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=tl(a),o===null)return;if(l=o.tag,l===5||l===6){i=r=o;continue e}a=a.parentNode}}i=i.return}yk(function(){var c=r,h=ET(t),f=[];e:{var p=Wk.get(n);if(p!==void 0){var g=CT,y=n;switch(n){case"keypress":if($m(t)===0)break e;case"keydown":case"keyup":g=gF;break;case"focusin":y="focus",g=j0;break;case"focusout":y="blur",g=j0;break;case"beforeblur":case"afterblur":g=j0;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=B1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=iF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=vF;break;case $k:case zk:case Hk:g=oF;break;case qk:g=wF;break;case"scroll":g=tF;break;case"wheel":g=AF;break;case"copy":case"cut":case"paste":g=lF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=z1}var _=(e&4)!==0,A=!_&&n==="scroll",v=_?p!==null?p+"Capture":null:p;_=[];for(var E=c,S;E!==null;){S=E;var P=S.stateNode;if(S.tag===5&&P!==null&&(S=P,v!==null&&(P=Sf(E,v),P!=null&&_.push(Pf(E,P,S)))),A)break;E=E.return}0<_.length&&(p=new g(p,y,null,t,h),f.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==jw&&(y=t.relatedTarget||t.fromElement)&&(tl(y)||y[oo]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(y=t.relatedTarget||t.toElement,g=c,y=y?tl(y):null,y!==null&&(A=Ac(y),y!==A||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=c),g!==y)){if(_=B1,P="onMouseLeave",v="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(_=z1,P="onPointerLeave",v="onPointerEnter",E="pointer"),A=g==null?p:nu(g),S=y==null?p:nu(y),p=new _(P,E+"leave",g,t,h),p.target=A,p.relatedTarget=S,P=null,tl(h)===c&&(_=new _(v,E+"enter",y,t,h),_.target=S,_.relatedTarget=A,P=_),A=P,g&&y)t:{for(_=g,v=y,E=0,S=_;S;S=Vc(S))E++;for(S=0,P=v;P;P=Vc(P))S++;for(;0<E-S;)_=Vc(_),E--;for(;0<S-E;)v=Vc(v),S--;for(;E--;){if(_===v||v!==null&&_===v.alternate)break t;_=Vc(_),v=Vc(v)}_=null}else _=null;g!==null&&eI(f,p,g,_,!1),y!==null&&A!==null&&eI(f,A,y,_,!0)}}e:{if(p=c?nu(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var O=kF;else if(W1(p))if(Fk)O=LF;else{O=PF;var F=xF}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=NF);if(O&&(O=O(n,c))){Ok(f,O,t,h);break e}F&&F(n,p,c),n==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&Mw(p,"number",p.value)}switch(F=c?nu(c):window,n){case"focusin":(W1(F)||F.contentEditable==="true")&&(eu=F,Gw=c,lf=null);break;case"focusout":lf=Gw=eu=null;break;case"mousedown":Kw=!0;break;case"contextmenu":case"mouseup":case"dragend":Kw=!1,Y1(f,t,h);break;case"selectionchange":if(OF)break;case"keydown":case"keyup":Y1(f,t,h)}var I;if(kT)e:{switch(n){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Zc?Dk(n,t)&&(b="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(b="onCompositionStart");b&&(Lk&&t.locale!=="ko"&&(Zc||b!=="onCompositionStart"?b==="onCompositionEnd"&&Zc&&(I=Nk()):(oa=h,IT="value"in oa?oa.value:oa.textContent,Zc=!0)),F=qy(c,b),0<F.length&&(b=new $1(b,n,null,t,h),f.push({event:b,listeners:F}),I?b.data=I:(I=Mk(t),I!==null&&(b.data=I)))),(I=SF?bF(n,t):IF(n,t))&&(c=qy(c,"onBeforeInput"),0<c.length&&(h=new $1("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:c}),h.data=I))}Gk(f,e)})}function Pf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function qy(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;s.tag===5&&r!==null&&(s=r,r=Sf(n,t),r!=null&&i.unshift(Pf(n,r,s)),r=Sf(n,e),r!=null&&i.push(Pf(n,r,s))),n=n.return}return i}function Vc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function eI(n,e,t,i,s){for(var r=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,s?(l=Sf(t,r),l!=null&&o.unshift(Pf(t,l,a))):s||(l=Sf(t,r),l!=null&&o.push(Pf(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var jF=/\r\n?/g,BF=/\u0000|\uFFFD/g;function tI(n){return(typeof n=="string"?n:""+n).replace(jF,`
`).replace(BF,"")}function gm(n,e,t){if(e=tI(e),tI(n)!==e&&t)throw Error(W(425))}function Wy(){}var Xw=null,Qw=null;function Yw(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jw=typeof setTimeout=="function"?setTimeout:void 0,$F=typeof clearTimeout=="function"?clearTimeout:void 0,nI=typeof Promise=="function"?Promise:void 0,zF=typeof queueMicrotask=="function"?queueMicrotask:typeof nI<"u"?function(n){return nI.resolve(null).then(n).catch(HF)}:Jw;function HF(n){setTimeout(function(){throw n})}function K0(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(i===0){n.removeChild(s),Cf(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=s}while(t);Cf(e)}function fa(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function iI(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Xh=Math.random().toString(36).slice(2),Ys="__reactFiber$"+Xh,Nf="__reactProps$"+Xh,oo="__reactContainer$"+Xh,Zw="__reactEvents$"+Xh,qF="__reactListeners$"+Xh,WF="__reactHandles$"+Xh;function tl(n){var e=n[Ys];if(e)return e;for(var t=n.parentNode;t;){if(e=t[oo]||t[Ys]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=iI(n);n!==null;){if(t=n[Ys])return t;n=iI(n)}return e}n=t,t=n.parentNode}return null}function wg(n){return n=n[Ys]||n[oo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function nu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(W(33))}function l_(n){return n[Nf]||null}var eE=[],iu=-1;function Da(n){return{current:n}}function et(n){0>iu||(n.current=eE[iu],eE[iu]=null,iu--)}function Qe(n,e){iu++,eE[iu]=n.current,n.current=e}var Aa={},Sn=Da(Aa),ei=Da(!1),oc=Aa;function kh(n,e){var t=n.type.contextTypes;if(!t)return Aa;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},r;for(r in t)s[r]=e[r];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function ti(n){return n=n.childContextTypes,n!=null}function Gy(){et(ei),et(Sn)}function sI(n,e,t){if(Sn.current!==Aa)throw Error(W(168));Qe(Sn,e),Qe(ei,t)}function Xk(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(W(108,xO(n)||"Unknown",s));return dt({},t,i)}function Ky(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Aa,oc=Sn.current,Qe(Sn,n),Qe(ei,ei.current),!0}function rI(n,e,t){var i=n.stateNode;if(!i)throw Error(W(169));t?(n=Xk(n,e,oc),i.__reactInternalMemoizedMergedChildContext=n,et(ei),et(Sn),Qe(Sn,n)):et(ei),Qe(ei,t)}var wr=null,c_=!1,X0=!1;function Qk(n){wr===null?wr=[n]:wr.push(n)}function GF(n){c_=!0,Qk(n)}function Ma(){if(!X0&&wr!==null){X0=!0;var n=0,e=Be;try{var t=wr;for(Be=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}wr=null,c_=!1}catch(s){throw wr!==null&&(wr=wr.slice(n+1)),Ek(AT,Ma),s}finally{Be=e,X0=!1}}return null}var su=[],ru=0,Xy=null,Qy=0,Ui=[],ji=0,ac=null,Wr=1,Gr="";function Ga(n,e){su[ru++]=Qy,su[ru++]=Xy,Xy=n,Qy=e}function Yk(n,e,t){Ui[ji++]=Wr,Ui[ji++]=Gr,Ui[ji++]=ac,ac=n;var i=Wr;n=Gr;var s=32-_s(i)-1;i&=~(1<<s),t+=1;var r=32-_s(e)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,Wr=1<<32-_s(e)+s|t<<s|i,Gr=r+n}else Wr=1<<r|t<<s|i,Gr=n}function PT(n){n.return!==null&&(Ga(n,1),Yk(n,1,0))}function NT(n){for(;n===Xy;)Xy=su[--ru],su[ru]=null,Qy=su[--ru],su[ru]=null;for(;n===ac;)ac=Ui[--ji],Ui[ji]=null,Gr=Ui[--ji],Ui[ji]=null,Wr=Ui[--ji],Ui[ji]=null}var Ti=null,wi=null,st=!1,gs=null;function Jk(n,e){var t=zi(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function oI(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ti=n,wi=fa(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ti=n,wi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ac!==null?{id:Wr,overflow:Gr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=zi(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ti=n,wi=null,!0):!1;default:return!1}}function tE(n){return(n.mode&1)!==0&&(n.flags&128)===0}function nE(n){if(st){var e=wi;if(e){var t=e;if(!oI(n,e)){if(tE(n))throw Error(W(418));e=fa(t.nextSibling);var i=Ti;e&&oI(n,e)?Jk(i,t):(n.flags=n.flags&-4097|2,st=!1,Ti=n)}}else{if(tE(n))throw Error(W(418));n.flags=n.flags&-4097|2,st=!1,Ti=n}}}function aI(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ti=n}function mm(n){if(n!==Ti)return!1;if(!st)return aI(n),st=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Yw(n.type,n.memoizedProps)),e&&(e=wi)){if(tE(n))throw Zk(),Error(W(418));for(;e;)Jk(n,e),e=fa(e.nextSibling)}if(aI(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(W(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){wi=fa(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}wi=null}}else wi=Ti?fa(n.stateNode.nextSibling):null;return!0}function Zk(){for(var n=wi;n;)n=fa(n.nextSibling)}function xh(){wi=Ti=null,st=!1}function LT(n){gs===null?gs=[n]:gs.push(n)}var KF=go.ReactCurrentBatchConfig;function Sd(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(W(309));var i=t.stateNode}if(!i)throw Error(W(147,n));var s=i,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=s.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(W(284));if(!t._owner)throw Error(W(290,n))}return n}function ym(n,e){throw n=Object.prototype.toString.call(e),Error(W(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function lI(n){var e=n._init;return e(n._payload)}function ex(n){function e(v,E){if(n){var S=v.deletions;S===null?(v.deletions=[E],v.flags|=16):S.push(E)}}function t(v,E){if(!n)return null;for(;E!==null;)e(v,E),E=E.sibling;return null}function i(v,E){for(v=new Map;E!==null;)E.key!==null?v.set(E.key,E):v.set(E.index,E),E=E.sibling;return v}function s(v,E){return v=ya(v,E),v.index=0,v.sibling=null,v}function r(v,E,S){return v.index=S,n?(S=v.alternate,S!==null?(S=S.index,S<E?(v.flags|=2,E):S):(v.flags|=2,E)):(v.flags|=1048576,E)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,E,S,P){return E===null||E.tag!==6?(E=nw(S,v.mode,P),E.return=v,E):(E=s(E,S),E.return=v,E)}function l(v,E,S,P){var O=S.type;return O===Jc?h(v,E,S.props.children,P,S.key):E!==null&&(E.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===To&&lI(O)===E.type)?(P=s(E,S.props),P.ref=Sd(v,E,S),P.return=v,P):(P=Xm(S.type,S.key,S.props,null,v.mode,P),P.ref=Sd(v,E,S),P.return=v,P)}function c(v,E,S,P){return E===null||E.tag!==4||E.stateNode.containerInfo!==S.containerInfo||E.stateNode.implementation!==S.implementation?(E=iw(S,v.mode,P),E.return=v,E):(E=s(E,S.children||[]),E.return=v,E)}function h(v,E,S,P,O){return E===null||E.tag!==7?(E=nc(S,v.mode,P,O),E.return=v,E):(E=s(E,S),E.return=v,E)}function f(v,E,S){if(typeof E=="string"&&E!==""||typeof E=="number")return E=nw(""+E,v.mode,S),E.return=v,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case om:return S=Xm(E.type,E.key,E.props,null,v.mode,S),S.ref=Sd(v,null,E),S.return=v,S;case Yc:return E=iw(E,v.mode,S),E.return=v,E;case To:var P=E._init;return f(v,P(E._payload),S)}if(Nd(E)||_d(E))return E=nc(E,v.mode,S,null),E.return=v,E;ym(v,E)}return null}function p(v,E,S,P){var O=E!==null?E.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return O!==null?null:a(v,E,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case om:return S.key===O?l(v,E,S,P):null;case Yc:return S.key===O?c(v,E,S,P):null;case To:return O=S._init,p(v,E,O(S._payload),P)}if(Nd(S)||_d(S))return O!==null?null:h(v,E,S,P,null);ym(v,S)}return null}function g(v,E,S,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return v=v.get(S)||null,a(E,v,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case om:return v=v.get(P.key===null?S:P.key)||null,l(E,v,P,O);case Yc:return v=v.get(P.key===null?S:P.key)||null,c(E,v,P,O);case To:var F=P._init;return g(v,E,S,F(P._payload),O)}if(Nd(P)||_d(P))return v=v.get(S)||null,h(E,v,P,O,null);ym(E,P)}return null}function y(v,E,S,P){for(var O=null,F=null,I=E,b=E=0,k=null;I!==null&&b<S.length;b++){I.index>b?(k=I,I=null):k=I.sibling;var L=p(v,I,S[b],P);if(L===null){I===null&&(I=k);break}n&&I&&L.alternate===null&&e(v,I),E=r(L,E,b),F===null?O=L:F.sibling=L,F=L,I=k}if(b===S.length)return t(v,I),st&&Ga(v,b),O;if(I===null){for(;b<S.length;b++)I=f(v,S[b],P),I!==null&&(E=r(I,E,b),F===null?O=I:F.sibling=I,F=I);return st&&Ga(v,b),O}for(I=i(v,I);b<S.length;b++)k=g(I,v,b,S[b],P),k!==null&&(n&&k.alternate!==null&&I.delete(k.key===null?b:k.key),E=r(k,E,b),F===null?O=k:F.sibling=k,F=k);return n&&I.forEach(function(M){return e(v,M)}),st&&Ga(v,b),O}function _(v,E,S,P){var O=_d(S);if(typeof O!="function")throw Error(W(150));if(S=O.call(S),S==null)throw Error(W(151));for(var F=O=null,I=E,b=E=0,k=null,L=S.next();I!==null&&!L.done;b++,L=S.next()){I.index>b?(k=I,I=null):k=I.sibling;var M=p(v,I,L.value,P);if(M===null){I===null&&(I=k);break}n&&I&&M.alternate===null&&e(v,I),E=r(M,E,b),F===null?O=M:F.sibling=M,F=M,I=k}if(L.done)return t(v,I),st&&Ga(v,b),O;if(I===null){for(;!L.done;b++,L=S.next())L=f(v,L.value,P),L!==null&&(E=r(L,E,b),F===null?O=L:F.sibling=L,F=L);return st&&Ga(v,b),O}for(I=i(v,I);!L.done;b++,L=S.next())L=g(I,v,b,L.value,P),L!==null&&(n&&L.alternate!==null&&I.delete(L.key===null?b:L.key),E=r(L,E,b),F===null?O=L:F.sibling=L,F=L);return n&&I.forEach(function(V){return e(v,V)}),st&&Ga(v,b),O}function A(v,E,S,P){if(typeof S=="object"&&S!==null&&S.type===Jc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case om:e:{for(var O=S.key,F=E;F!==null;){if(F.key===O){if(O=S.type,O===Jc){if(F.tag===7){t(v,F.sibling),E=s(F,S.props.children),E.return=v,v=E;break e}}else if(F.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===To&&lI(O)===F.type){t(v,F.sibling),E=s(F,S.props),E.ref=Sd(v,F,S),E.return=v,v=E;break e}t(v,F);break}else e(v,F);F=F.sibling}S.type===Jc?(E=nc(S.props.children,v.mode,P,S.key),E.return=v,v=E):(P=Xm(S.type,S.key,S.props,null,v.mode,P),P.ref=Sd(v,E,S),P.return=v,v=P)}return o(v);case Yc:e:{for(F=S.key;E!==null;){if(E.key===F)if(E.tag===4&&E.stateNode.containerInfo===S.containerInfo&&E.stateNode.implementation===S.implementation){t(v,E.sibling),E=s(E,S.children||[]),E.return=v,v=E;break e}else{t(v,E);break}else e(v,E);E=E.sibling}E=iw(S,v.mode,P),E.return=v,v=E}return o(v);case To:return F=S._init,A(v,E,F(S._payload),P)}if(Nd(S))return y(v,E,S,P);if(_d(S))return _(v,E,S,P);ym(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,E!==null&&E.tag===6?(t(v,E.sibling),E=s(E,S),E.return=v,v=E):(t(v,E),E=nw(S,v.mode,P),E.return=v,v=E),o(v)):t(v,E)}return A}var Ph=ex(!0),tx=ex(!1),Yy=Da(null),Jy=null,ou=null,DT=null;function MT(){DT=ou=Jy=null}function OT(n){var e=Yy.current;et(Yy),n._currentValue=e}function iE(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function mu(n,e){Jy=n,DT=ou=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Zn=!0),n.firstContext=null)}function Wi(n){var e=n._currentValue;if(DT!==n)if(n={context:n,memoizedValue:e,next:null},ou===null){if(Jy===null)throw Error(W(308));ou=n,Jy.dependencies={lanes:0,firstContext:n}}else ou=ou.next=n;return e}var nl=null;function FT(n){nl===null?nl=[n]:nl.push(n)}function nx(n,e,t,i){var s=e.interleaved;return s===null?(t.next=t,FT(e)):(t.next=s.next,s.next=t),e.interleaved=t,ao(n,i)}function ao(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var So=!1;function VT(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ix(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Jr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function pa(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Ne&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,ao(n,t)}return s=i.interleaved,s===null?(e.next=e,FT(i)):(e.next=s.next,s.next=e),i.interleaved=e,ao(n,t)}function zm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,TT(n,t)}}function cI(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?s=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Zy(n,e,t,i){var s=n.updateQueue;So=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?r=c:o.next=c,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(r!==null){var f=s.baseState;o=0,h=c=l=null,a=r;do{var p=a.lane,g=a.eventTime;if((i&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,_=a;switch(p=e,g=t,_.tag){case 1:if(y=_.payload,typeof y=="function"){f=y.call(g,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,p=typeof y=="function"?y.call(g,f,p):y,p==null)break e;f=dt({},f,p);break e;case 2:So=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=g,l=f):h=h.next=g,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else r===null&&(s.shared.lanes=0);cc|=o,n.lanes=o,n.memoizedState=f}}function uI(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],s=i.callback;if(s!==null){if(i.callback=null,i=t,typeof s!="function")throw Error(W(191,s));s.call(i)}}}var Eg={},er=Da(Eg),Lf=Da(Eg),Df=Da(Eg);function il(n){if(n===Eg)throw Error(W(174));return n}function UT(n,e){switch(Qe(Df,e),Qe(Lf,n),Qe(er,Eg),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fw(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Fw(e,n)}et(er),Qe(er,e)}function Nh(){et(er),et(Lf),et(Df)}function sx(n){il(Df.current);var e=il(er.current),t=Fw(e,n.type);e!==t&&(Qe(Lf,n),Qe(er,t))}function jT(n){Lf.current===n&&(et(er),et(Lf))}var lt=Da(0);function ev(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Q0=[];function BT(){for(var n=0;n<Q0.length;n++)Q0[n]._workInProgressVersionPrimary=null;Q0.length=0}var Hm=go.ReactCurrentDispatcher,Y0=go.ReactCurrentBatchConfig,lc=0,ut=null,Lt=null,Ht=null,tv=!1,cf=!1,Mf=0,XF=0;function cn(){throw Error(W(321))}function $T(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!As(n[t],e[t]))return!1;return!0}function zT(n,e,t,i,s,r){if(lc=r,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hm.current=n===null||n.memoizedState===null?ZF:eV,n=t(i,s),cf){r=0;do{if(cf=!1,Mf=0,25<=r)throw Error(W(301));r+=1,Ht=Lt=null,e.updateQueue=null,Hm.current=tV,n=t(i,s)}while(cf)}if(Hm.current=nv,e=Lt!==null&&Lt.next!==null,lc=0,Ht=Lt=ut=null,tv=!1,e)throw Error(W(300));return n}function HT(){var n=Mf!==0;return Mf=0,n}function Ns(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?ut.memoizedState=Ht=n:Ht=Ht.next=n,Ht}function Gi(){if(Lt===null){var n=ut.alternate;n=n!==null?n.memoizedState:null}else n=Lt.next;var e=Ht===null?ut.memoizedState:Ht.next;if(e!==null)Ht=e,Lt=n;else{if(n===null)throw Error(W(310));Lt=n,n={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Ht===null?ut.memoizedState=Ht=n:Ht=Ht.next=n}return Ht}function Of(n,e){return typeof e=="function"?e(n):e}function J0(n){var e=Gi(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var i=Lt,s=i.baseQueue,r=t.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}i.baseQueue=s=r,t.pending=null}if(s!==null){r=s.next,i=i.baseState;var a=o=null,l=null,c=r;do{var h=c.lane;if((lc&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:n(i,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=i):l=l.next=f,ut.lanes|=h,cc|=h}c=c.next}while(c!==null&&c!==r);l===null?o=i:l.next=a,As(i,e.memoizedState)||(Zn=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){s=n;do r=s.lane,ut.lanes|=r,cc|=r,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Z0(n){var e=Gi(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do r=n(r,o.action),o=o.next;while(o!==s);As(r,e.memoizedState)||(Zn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function rx(){}function ox(n,e){var t=ut,i=Gi(),s=e(),r=!As(i.memoizedState,s);if(r&&(i.memoizedState=s,Zn=!0),i=i.queue,qT(cx.bind(null,t,i,n),[n]),i.getSnapshot!==e||r||Ht!==null&&Ht.memoizedState.tag&1){if(t.flags|=2048,Ff(9,lx.bind(null,t,i,s,e),void 0,null),qt===null)throw Error(W(349));lc&30||ax(t,e,s)}return s}function ax(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function lx(n,e,t,i){e.value=t,e.getSnapshot=i,ux(e)&&hx(n)}function cx(n,e,t){return t(function(){ux(e)&&hx(n)})}function ux(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!As(n,t)}catch{return!0}}function hx(n){var e=ao(n,1);e!==null&&ws(e,n,1,-1)}function hI(n){var e=Ns();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Of,lastRenderedState:n},e.queue=n,n=n.dispatch=JF.bind(null,ut,n),[e.memoizedState,n]}function Ff(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function dx(){return Gi().memoizedState}function qm(n,e,t,i){var s=Ns();ut.flags|=n,s.memoizedState=Ff(1|e,t,void 0,i===void 0?null:i)}function u_(n,e,t,i){var s=Gi();i=i===void 0?null:i;var r=void 0;if(Lt!==null){var o=Lt.memoizedState;if(r=o.destroy,i!==null&&$T(i,o.deps)){s.memoizedState=Ff(e,t,r,i);return}}ut.flags|=n,s.memoizedState=Ff(1|e,t,r,i)}function dI(n,e){return qm(8390656,8,n,e)}function qT(n,e){return u_(2048,8,n,e)}function fx(n,e){return u_(4,2,n,e)}function px(n,e){return u_(4,4,n,e)}function gx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function mx(n,e,t){return t=t!=null?t.concat([n]):null,u_(4,4,gx.bind(null,e,n),t)}function WT(){}function yx(n,e){var t=Gi();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&$T(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function vx(n,e){var t=Gi();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&$T(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function _x(n,e,t){return lc&21?(As(t,e)||(t=Sk(),ut.lanes|=t,cc|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Zn=!0),n.memoizedState=t)}function QF(n,e){var t=Be;Be=t!==0&&4>t?t:4,n(!0);var i=Y0.transition;Y0.transition={};try{n(!1),e()}finally{Be=t,Y0.transition=i}}function wx(){return Gi().memoizedState}function YF(n,e,t){var i=ma(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},Ex(n))Ax(e,t);else if(t=nx(n,e,t,i),t!==null){var s=On();ws(t,n,i,s),Tx(t,e,i)}}function JF(n,e,t){var i=ma(n),s={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(Ex(n))Ax(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(s.hasEagerState=!0,s.eagerState=a,As(a,o)){var l=e.interleaved;l===null?(s.next=s,FT(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=nx(n,e,s,i),t!==null&&(s=On(),ws(t,n,i,s),Tx(t,e,i))}}function Ex(n){var e=n.alternate;return n===ut||e!==null&&e===ut}function Ax(n,e){cf=tv=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Tx(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,TT(n,t)}}var nv={readContext:Wi,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useInsertionEffect:cn,useLayoutEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useMutableSource:cn,useSyncExternalStore:cn,useId:cn,unstable_isNewReconciler:!1},ZF={readContext:Wi,useCallback:function(n,e){return Ns().memoizedState=[n,e===void 0?null:e],n},useContext:Wi,useEffect:dI,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,qm(4194308,4,gx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return qm(4194308,4,n,e)},useInsertionEffect:function(n,e){return qm(4,2,n,e)},useMemo:function(n,e){var t=Ns();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ns();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=YF.bind(null,ut,n),[i.memoizedState,n]},useRef:function(n){var e=Ns();return n={current:n},e.memoizedState=n},useState:hI,useDebugValue:WT,useDeferredValue:function(n){return Ns().memoizedState=n},useTransition:function(){var n=hI(!1),e=n[0];return n=QF.bind(null,n[1]),Ns().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=ut,s=Ns();if(st){if(t===void 0)throw Error(W(407));t=t()}else{if(t=e(),qt===null)throw Error(W(349));lc&30||ax(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,dI(cx.bind(null,i,r,n),[n]),i.flags|=2048,Ff(9,lx.bind(null,i,r,t,e),void 0,null),t},useId:function(){var n=Ns(),e=qt.identifierPrefix;if(st){var t=Gr,i=Wr;t=(i&~(1<<32-_s(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Mf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=XF++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},eV={readContext:Wi,useCallback:yx,useContext:Wi,useEffect:qT,useImperativeHandle:mx,useInsertionEffect:fx,useLayoutEffect:px,useMemo:vx,useReducer:J0,useRef:dx,useState:function(){return J0(Of)},useDebugValue:WT,useDeferredValue:function(n){var e=Gi();return _x(e,Lt.memoizedState,n)},useTransition:function(){var n=J0(Of)[0],e=Gi().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:ox,useId:wx,unstable_isNewReconciler:!1},tV={readContext:Wi,useCallback:yx,useContext:Wi,useEffect:qT,useImperativeHandle:mx,useInsertionEffect:fx,useLayoutEffect:px,useMemo:vx,useReducer:Z0,useRef:dx,useState:function(){return Z0(Of)},useDebugValue:WT,useDeferredValue:function(n){var e=Gi();return Lt===null?e.memoizedState=n:_x(e,Lt.memoizedState,n)},useTransition:function(){var n=Z0(Of)[0],e=Gi().memoizedState;return[n,e]},useMutableSource:rx,useSyncExternalStore:ox,useId:wx,unstable_isNewReconciler:!1};function Zi(n,e){if(n&&n.defaultProps){e=dt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function sE(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:dt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var h_={isMounted:function(n){return(n=n._reactInternals)?Ac(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=On(),s=ma(n),r=Jr(i,s);r.payload=e,t!=null&&(r.callback=t),e=pa(n,r,s),e!==null&&(ws(e,n,s,i),zm(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=On(),s=ma(n),r=Jr(i,s);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=pa(n,r,s),e!==null&&(ws(e,n,s,i),zm(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=On(),i=ma(n),s=Jr(t,i);s.tag=2,e!=null&&(s.callback=e),e=pa(n,s,i),e!==null&&(ws(e,n,i,t),zm(e,n,i))}};function fI(n,e,t,i,s,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,o):e.prototype&&e.prototype.isPureReactComponent?!kf(t,i)||!kf(s,r):!0}function Sx(n,e,t){var i=!1,s=Aa,r=e.contextType;return typeof r=="object"&&r!==null?r=Wi(r):(s=ti(e)?oc:Sn.current,i=e.contextTypes,r=(i=i!=null)?kh(n,s):Aa),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=h_,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=r),e}function pI(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&h_.enqueueReplaceState(e,e.state,null)}function rE(n,e,t,i){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},VT(n);var r=e.contextType;typeof r=="object"&&r!==null?s.context=Wi(r):(r=ti(e)?oc:Sn.current,s.context=kh(n,r)),s.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(sE(n,e,r,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&h_.enqueueReplaceState(s,s.state,null),Zy(n,t,s,i),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Lh(n,e){try{var t="",i=e;do t+=kO(i),i=i.return;while(i);var s=t}catch(r){s=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:s,digest:null}}function ew(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function oE(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var nV=typeof WeakMap=="function"?WeakMap:Map;function bx(n,e,t){t=Jr(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){sv||(sv=!0,mE=i),oE(n,e)},t}function Ix(n,e,t){t=Jr(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;t.payload=function(){return i(s)},t.callback=function(){oE(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){oE(n,e),typeof i!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function gI(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new nV;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(s.add(t),n=mV.bind(null,n,e,t),e.then(n,n))}function mI(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function yI(n,e,t,i,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Jr(-1,1),e.tag=2,pa(t,e,1))),t.lanes|=1),n)}var iV=go.ReactCurrentOwner,Zn=!1;function Ln(n,e,t,i){e.child=n===null?tx(e,null,t,i):Ph(e,n.child,t,i)}function vI(n,e,t,i,s){t=t.render;var r=e.ref;return mu(e,s),i=zT(n,e,t,i,r,s),t=HT(),n!==null&&!Zn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,lo(n,e,s)):(st&&t&&PT(e),e.flags|=1,Ln(n,e,i,s),e.child)}function _I(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!eS(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,Cx(n,e,r,i,s)):(n=Xm(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&s)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:kf,t(o,i)&&n.ref===e.ref)return lo(n,e,s)}return e.flags|=1,n=ya(r,i),n.ref=e.ref,n.return=e,e.child=n}function Cx(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(kf(r,i)&&n.ref===e.ref)if(Zn=!1,e.pendingProps=i=r,(n.lanes&s)!==0)n.flags&131072&&(Zn=!0);else return e.lanes=n.lanes,lo(n,e,s)}return aE(n,e,t,i,s)}function Rx(n,e,t){var i=e.pendingProps,s=i.children,r=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(lu,vi),vi|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Qe(lu,vi),vi|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:t,Qe(lu,vi),vi|=i}else r!==null?(i=r.baseLanes|t,e.memoizedState=null):i=t,Qe(lu,vi),vi|=i;return Ln(n,e,s,t),e.child}function kx(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function aE(n,e,t,i,s){var r=ti(t)?oc:Sn.current;return r=kh(e,r),mu(e,s),t=zT(n,e,t,i,r,s),i=HT(),n!==null&&!Zn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,lo(n,e,s)):(st&&i&&PT(e),e.flags|=1,Ln(n,e,t,s),e.child)}function wI(n,e,t,i,s){if(ti(t)){var r=!0;Ky(e)}else r=!1;if(mu(e,s),e.stateNode===null)Wm(n,e),Sx(e,t,i),rE(e,t,i,s),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Wi(c):(c=ti(t)?oc:Sn.current,c=kh(e,c));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&pI(e,o,i,c),So=!1;var p=e.memoizedState;o.state=p,Zy(e,i,o,s),l=e.memoizedState,a!==i||p!==l||ei.current||So?(typeof h=="function"&&(sE(e,t,h,i),l=e.memoizedState),(a=So||fI(e,t,a,i,p,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,ix(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Zi(e.type,a),o.props=c,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Wi(l):(l=ti(t)?oc:Sn.current,l=kh(e,l));var g=t.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&pI(e,o,i,l),So=!1,p=e.memoizedState,o.state=p,Zy(e,i,o,s);var y=e.memoizedState;a!==f||p!==y||ei.current||So?(typeof g=="function"&&(sE(e,t,g,i),y=e.memoizedState),(c=So||fI(e,t,c,i,p,y,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),o.props=i,o.state=y,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return lE(n,e,t,i,r,s)}function lE(n,e,t,i,s,r){kx(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&rI(e,t,!1),lo(n,e,r);i=e.stateNode,iV.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Ph(e,n.child,null,r),e.child=Ph(e,null,a,r)):Ln(n,e,a,r),e.memoizedState=i.state,s&&rI(e,t,!0),e.child}function xx(n){var e=n.stateNode;e.pendingContext?sI(n,e.pendingContext,e.pendingContext!==e.context):e.context&&sI(n,e.context,!1),UT(n,e.containerInfo)}function EI(n,e,t,i,s){return xh(),LT(s),e.flags|=256,Ln(n,e,t,i),e.child}var cE={dehydrated:null,treeContext:null,retryLane:0};function uE(n){return{baseLanes:n,cachePool:null,transitions:null}}function Px(n,e,t){var i=e.pendingProps,s=lt.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Qe(lt,s&1),n===null)return nE(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,r?(i=e.mode,r=e.child,o={mode:"hidden",children:o},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=p_(o,i,0,null),n=nc(n,i,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=uE(t),e.memoizedState=cE,n):GT(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return sV(n,e,o,i,a,s,t);if(r){r=i.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=ya(s,l),i.subtreeFlags=s.subtreeFlags&14680064),a!==null?r=ya(a,r):(r=nc(r,o,t,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=n.child.memoizedState,o=o===null?uE(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=cE,i}return r=n.child,n=r.sibling,i=ya(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function GT(n,e){return e=p_({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function vm(n,e,t,i){return i!==null&&LT(i),Ph(e,n.child,null,t),n=GT(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function sV(n,e,t,i,s,r,o){if(t)return e.flags&256?(e.flags&=-257,i=ew(Error(W(422))),vm(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=i.fallback,s=e.mode,i=p_({mode:"visible",children:i.children},s,0,null),r=nc(r,s,o,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&Ph(e,n.child,null,o),e.child.memoizedState=uE(o),e.memoizedState=cE,r);if(!(e.mode&1))return vm(n,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var a=i.dgst;return i=a,r=Error(W(419)),i=ew(r,i,void 0),vm(n,e,o,i)}if(a=(o&n.childLanes)!==0,Zn||a){if(i=qt,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==r.retryLane&&(r.retryLane=s,ao(n,s),ws(i,n,s,-1))}return ZT(),i=ew(Error(W(421))),vm(n,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=yV.bind(null,n),s._reactRetry=e,null):(n=r.treeContext,wi=fa(s.nextSibling),Ti=e,st=!0,gs=null,n!==null&&(Ui[ji++]=Wr,Ui[ji++]=Gr,Ui[ji++]=ac,Wr=n.id,Gr=n.overflow,ac=e),e=GT(e,i.children),e.flags|=4096,e)}function AI(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),iE(n.return,e,t)}function tw(n,e,t,i,s){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=t,r.tailMode=s)}function Nx(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if(Ln(n,e,i.children,t),i=lt.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&AI(n,t,e);else if(n.tag===19)AI(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Qe(lt,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&ev(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),tw(e,!1,s,t,r);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&ev(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}tw(e,!0,t,null,r);break;case"together":tw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wm(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function lo(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),cc|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(W(153));if(e.child!==null){for(n=e.child,t=ya(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ya(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function rV(n,e,t){switch(e.tag){case 3:xx(e),xh();break;case 5:sx(e);break;case 1:ti(e.type)&&Ky(e);break;case 4:UT(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;Qe(Yy,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Qe(lt,lt.current&1),e.flags|=128,null):t&e.child.childLanes?Px(n,e,t):(Qe(lt,lt.current&1),n=lo(n,e,t),n!==null?n.sibling:null);Qe(lt,lt.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return Nx(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Qe(lt,lt.current),i)break;return null;case 22:case 23:return e.lanes=0,Rx(n,e,t)}return lo(n,e,t)}var Lx,hE,Dx,Mx;Lx=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};hE=function(){};Dx=function(n,e,t,i){var s=n.memoizedProps;if(s!==i){n=e.stateNode,il(er.current);var r=null;switch(t){case"input":s=Lw(n,s),i=Lw(n,i),r=[];break;case"select":s=dt({},s,{value:void 0}),i=dt({},i,{value:void 0}),r=[];break;case"textarea":s=Ow(n,s),i=Ow(n,i),r=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Wy)}Vw(t,i);var o;t=null;for(c in s)if(!i.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Af.hasOwnProperty(c)?r||(r=[]):(r=r||[]).push(c,null));for(c in i){var l=i[c];if(a=s!=null?s[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(r||(r=[]),r.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(r=r||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Af.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Je("scroll",n),r||a===l||(r=[])):(r=r||[]).push(c,l))}t&&(r=r||[]).push("style",t);var c=r;(e.updateQueue=c)&&(e.flags|=4)}};Mx=function(n,e,t,i){t!==i&&(e.flags|=4)};function bd(n,e){if(!st)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function un(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function oV(n,e,t){var i=e.pendingProps;switch(NT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(e),null;case 1:return ti(e.type)&&Gy(),un(e),null;case 3:return i=e.stateNode,Nh(),et(ei),et(Sn),BT(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(mm(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gs!==null&&(_E(gs),gs=null))),hE(n,e),un(e),null;case 5:jT(e);var s=il(Df.current);if(t=e.type,n!==null&&e.stateNode!=null)Dx(n,e,t,i,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(W(166));return un(e),null}if(n=il(er.current),mm(e)){i=e.stateNode,t=e.type;var r=e.memoizedProps;switch(i[Ys]=e,i[Nf]=r,n=(e.mode&1)!==0,t){case"dialog":Je("cancel",i),Je("close",i);break;case"iframe":case"object":case"embed":Je("load",i);break;case"video":case"audio":for(s=0;s<Dd.length;s++)Je(Dd[s],i);break;case"source":Je("error",i);break;case"img":case"image":case"link":Je("error",i),Je("load",i);break;case"details":Je("toggle",i);break;case"input":P1(i,r),Je("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},Je("invalid",i);break;case"textarea":L1(i,r),Je("invalid",i)}Vw(t,r),s=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?i.textContent!==a&&(r.suppressHydrationWarning!==!0&&gm(i.textContent,a,n),s=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&gm(i.textContent,a,n),s=["children",""+a]):Af.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Je("scroll",i)}switch(t){case"input":am(i),N1(i,r,!0);break;case"textarea":am(i),D1(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=Wy)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=ck(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Ys]=e,n[Nf]=i,Lx(n,e,!1,!1),e.stateNode=n;e:{switch(o=Uw(t,i),t){case"dialog":Je("cancel",n),Je("close",n),s=i;break;case"iframe":case"object":case"embed":Je("load",n),s=i;break;case"video":case"audio":for(s=0;s<Dd.length;s++)Je(Dd[s],n);s=i;break;case"source":Je("error",n),s=i;break;case"img":case"image":case"link":Je("error",n),Je("load",n),s=i;break;case"details":Je("toggle",n),s=i;break;case"input":P1(n,i),s=Lw(n,i),Je("invalid",n);break;case"option":s=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},s=dt({},i,{value:void 0}),Je("invalid",n);break;case"textarea":L1(n,i),s=Ow(n,i),Je("invalid",n);break;default:s=i}Vw(t,s),a=s;for(r in a)if(a.hasOwnProperty(r)){var l=a[r];r==="style"?dk(n,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&uk(n,l)):r==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Tf(n,l):typeof l=="number"&&Tf(n,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Af.hasOwnProperty(r)?l!=null&&r==="onScroll"&&Je("scroll",n):l!=null&&yT(n,r,l,o))}switch(t){case"input":am(n),N1(n,i,!1);break;case"textarea":am(n),D1(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ea(i.value));break;case"select":n.multiple=!!i.multiple,r=i.value,r!=null?du(n,!!i.multiple,r,!1):i.defaultValue!=null&&du(n,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Wy)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return un(e),null;case 6:if(n&&e.stateNode!=null)Mx(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(W(166));if(t=il(Df.current),il(er.current),mm(e)){if(i=e.stateNode,t=e.memoizedProps,i[Ys]=e,(r=i.nodeValue!==t)&&(n=Ti,n!==null))switch(n.tag){case 3:gm(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&gm(i.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Ys]=e,e.stateNode=i}return un(e),null;case 13:if(et(lt),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(st&&wi!==null&&e.mode&1&&!(e.flags&128))Zk(),xh(),e.flags|=98560,r=!1;else if(r=mm(e),i!==null&&i.dehydrated!==null){if(n===null){if(!r)throw Error(W(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(W(317));r[Ys]=e}else xh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;un(e),r=!1}else gs!==null&&(_E(gs),gs=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||lt.current&1?Dt===0&&(Dt=3):ZT())),e.updateQueue!==null&&(e.flags|=4),un(e),null);case 4:return Nh(),hE(n,e),n===null&&xf(e.stateNode.containerInfo),un(e),null;case 10:return OT(e.type._context),un(e),null;case 17:return ti(e.type)&&Gy(),un(e),null;case 19:if(et(lt),r=e.memoizedState,r===null)return un(e),null;if(i=(e.flags&128)!==0,o=r.rendering,o===null)if(i)bd(r,!1);else{if(Dt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=ev(n),o!==null){for(e.flags|=128,bd(r,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)r=t,n=i,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Qe(lt,lt.current&1|2),e.child}n=n.sibling}r.tail!==null&&Et()>Dh&&(e.flags|=128,i=!0,bd(r,!1),e.lanes=4194304)}else{if(!i)if(n=ev(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),bd(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!st)return un(e),null}else 2*Et()-r.renderingStartTime>Dh&&t!==1073741824&&(e.flags|=128,i=!0,bd(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Et(),e.sibling=null,t=lt.current,Qe(lt,i?t&1|2:t&1),e):(un(e),null);case 22:case 23:return JT(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?vi&1073741824&&(un(e),e.subtreeFlags&6&&(e.flags|=8192)):un(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function aV(n,e){switch(NT(e),e.tag){case 1:return ti(e.type)&&Gy(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Nh(),et(ei),et(Sn),BT(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return jT(e),null;case 13:if(et(lt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(W(340));xh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return et(lt),null;case 4:return Nh(),null;case 10:return OT(e.type._context),null;case 22:case 23:return JT(),null;case 24:return null;default:return null}}var _m=!1,En=!1,lV=typeof WeakSet=="function"?WeakSet:Set,Z=null;function au(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){mt(n,e,i)}else t.current=null}function dE(n,e,t){try{t()}catch(i){mt(n,e,i)}}var TI=!1;function cV(n,e){if(Xw=zy,n=jk(),xT(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,h=0,f=n,p=null;t:for(;;){for(var g;f!==t||s!==0&&f.nodeType!==3||(a=o+s),f!==r||i!==0&&f.nodeType!==3||(l=o+i),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++c===s&&(a=o),p===r&&++h===i&&(l=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Qw={focusedElem:n,selectionRange:t},zy=!1,Z=e;Z!==null;)if(e=Z,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Z=n;else for(;Z!==null;){e=Z;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,A=y.memoizedState,v=e.stateNode,E=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:Zi(e.type,_),A);v.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(P){mt(e,e.return,P)}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}return y=TI,TI=!1,y}function uf(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&n)===n){var r=s.destroy;s.destroy=void 0,r!==void 0&&dE(e,t,r)}s=s.next}while(s!==i)}}function d_(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function fE(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Ox(n){var e=n.alternate;e!==null&&(n.alternate=null,Ox(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ys],delete e[Nf],delete e[Zw],delete e[qF],delete e[WF])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Fx(n){return n.tag===5||n.tag===3||n.tag===4}function SI(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Fx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function pE(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Wy));else if(i!==4&&(n=n.child,n!==null))for(pE(n,e,t),n=n.sibling;n!==null;)pE(n,e,t),n=n.sibling}function gE(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(gE(n,e,t),n=n.sibling;n!==null;)gE(n,e,t),n=n.sibling}var Jt=null,ps=!1;function wo(n,e,t){for(t=t.child;t!==null;)Vx(n,e,t),t=t.sibling}function Vx(n,e,t){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(s_,t)}catch{}switch(t.tag){case 5:En||au(t,e);case 6:var i=Jt,s=ps;Jt=null,wo(n,e,t),Jt=i,ps=s,Jt!==null&&(ps?(n=Jt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Jt.removeChild(t.stateNode));break;case 18:Jt!==null&&(ps?(n=Jt,t=t.stateNode,n.nodeType===8?K0(n.parentNode,t):n.nodeType===1&&K0(n,t),Cf(n)):K0(Jt,t.stateNode));break;case 4:i=Jt,s=ps,Jt=t.stateNode.containerInfo,ps=!0,wo(n,e,t),Jt=i,ps=s;break;case 0:case 11:case 14:case 15:if(!En&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var r=s,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&dE(t,e,o),s=s.next}while(s!==i)}wo(n,e,t);break;case 1:if(!En&&(au(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){mt(t,e,a)}wo(n,e,t);break;case 21:wo(n,e,t);break;case 22:t.mode&1?(En=(i=En)||t.memoizedState!==null,wo(n,e,t),En=i):wo(n,e,t);break;default:wo(n,e,t)}}function bI(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new lV),e.forEach(function(i){var s=vV.bind(null,n,i);t.has(i)||(t.add(i),i.then(s,s))})}}function Yi(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Jt=a.stateNode,ps=!1;break e;case 3:Jt=a.stateNode.containerInfo,ps=!0;break e;case 4:Jt=a.stateNode.containerInfo,ps=!0;break e}a=a.return}if(Jt===null)throw Error(W(160));Vx(r,o,s),Jt=null,ps=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){mt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ux(e,n),e=e.sibling}function Ux(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Yi(e,n),Rs(n),i&4){try{uf(3,n,n.return),d_(3,n)}catch(_){mt(n,n.return,_)}try{uf(5,n,n.return)}catch(_){mt(n,n.return,_)}}break;case 1:Yi(e,n),Rs(n),i&512&&t!==null&&au(t,t.return);break;case 5:if(Yi(e,n),Rs(n),i&512&&t!==null&&au(t,t.return),n.flags&32){var s=n.stateNode;try{Tf(s,"")}catch(_){mt(n,n.return,_)}}if(i&4&&(s=n.stateNode,s!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&ak(s,r),Uw(a,o);var c=Uw(a,r);for(o=0;o<l.length;o+=2){var h=l[o],f=l[o+1];h==="style"?dk(s,f):h==="dangerouslySetInnerHTML"?uk(s,f):h==="children"?Tf(s,f):yT(s,h,f,c)}switch(a){case"input":Dw(s,r);break;case"textarea":lk(s,r);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var g=r.value;g!=null?du(s,!!r.multiple,g,!1):p!==!!r.multiple&&(r.defaultValue!=null?du(s,!!r.multiple,r.defaultValue,!0):du(s,!!r.multiple,r.multiple?[]:"",!1))}s[Nf]=r}catch(_){mt(n,n.return,_)}}break;case 6:if(Yi(e,n),Rs(n),i&4){if(n.stateNode===null)throw Error(W(162));s=n.stateNode,r=n.memoizedProps;try{s.nodeValue=r}catch(_){mt(n,n.return,_)}}break;case 3:if(Yi(e,n),Rs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Cf(e.containerInfo)}catch(_){mt(n,n.return,_)}break;case 4:Yi(e,n),Rs(n);break;case 13:Yi(e,n),Rs(n),s=n.child,s.flags&8192&&(r=s.memoizedState!==null,s.stateNode.isHidden=r,!r||s.alternate!==null&&s.alternate.memoizedState!==null||(QT=Et())),i&4&&bI(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(En=(c=En)||h,Yi(e,n),En=c):Yi(e,n),Rs(n),i&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!h&&n.mode&1)for(Z=n,h=n.child;h!==null;){for(f=Z=h;Z!==null;){switch(p=Z,g=p.child,p.tag){case 0:case 11:case 14:case 15:uf(4,p,p.return);break;case 1:au(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(_){mt(i,t,_)}}break;case 5:au(p,p.return);break;case 22:if(p.memoizedState!==null){CI(f);continue}}g!==null?(g.return=p,Z=g):CI(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,c?(r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=hk("display",o))}catch(_){mt(n,n.return,_)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(_){mt(n,n.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Yi(e,n),Rs(n),i&4&&bI(n);break;case 21:break;default:Yi(e,n),Rs(n)}}function Rs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Fx(t)){var i=t;break e}t=t.return}throw Error(W(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(Tf(s,""),i.flags&=-33);var r=SI(n);gE(n,r,s);break;case 3:case 4:var o=i.stateNode.containerInfo,a=SI(n);pE(n,a,o);break;default:throw Error(W(161))}}catch(l){mt(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function uV(n,e,t){Z=n,jx(n)}function jx(n,e,t){for(var i=(n.mode&1)!==0;Z!==null;){var s=Z,r=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||_m;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||En;a=_m;var c=En;if(_m=o,(En=l)&&!c)for(Z=s;Z!==null;)o=Z,l=o.child,o.tag===22&&o.memoizedState!==null?RI(s):l!==null?(l.return=o,Z=l):RI(s);for(;r!==null;)Z=r,jx(r),r=r.sibling;Z=s,_m=a,En=c}II(n)}else s.subtreeFlags&8772&&r!==null?(r.return=s,Z=r):II(n)}}function II(n){for(;Z!==null;){var e=Z;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:En||d_(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!En)if(t===null)i.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Zi(e.type,t.memoizedProps);i.componentDidUpdate(s,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&uI(e,r,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}uI(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Cf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}En||e.flags&512&&fE(e)}catch(p){mt(e,e.return,p)}}if(e===n){Z=null;break}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}}function CI(n){for(;Z!==null;){var e=Z;if(e===n){Z=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Z=t;break}Z=e.return}}function RI(n){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{d_(4,e)}catch(l){mt(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(l){mt(e,s,l)}}var r=e.return;try{fE(e)}catch(l){mt(e,r,l)}break;case 5:var o=e.return;try{fE(e)}catch(l){mt(e,o,l)}}}catch(l){mt(e,e.return,l)}if(e===n){Z=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Z=a;break}Z=e.return}}var hV=Math.ceil,iv=go.ReactCurrentDispatcher,KT=go.ReactCurrentOwner,Hi=go.ReactCurrentBatchConfig,Ne=0,qt=null,bt=null,nn=0,vi=0,lu=Da(0),Dt=0,Vf=null,cc=0,f_=0,XT=0,hf=null,Qn=null,QT=0,Dh=1/0,yr=null,sv=!1,mE=null,ga=null,wm=!1,aa=null,rv=0,df=0,yE=null,Gm=-1,Km=0;function On(){return Ne&6?Et():Gm!==-1?Gm:Gm=Et()}function ma(n){return n.mode&1?Ne&2&&nn!==0?nn&-nn:KF.transition!==null?(Km===0&&(Km=Sk()),Km):(n=Be,n!==0||(n=window.event,n=n===void 0?16:Pk(n.type)),n):1}function ws(n,e,t,i){if(50<df)throw df=0,yE=null,Error(W(185));vg(n,t,i),(!(Ne&2)||n!==qt)&&(n===qt&&(!(Ne&2)&&(f_|=t),Dt===4&&Io(n,nn)),ni(n,i),t===1&&Ne===0&&!(e.mode&1)&&(Dh=Et()+500,c_&&Ma()))}function ni(n,e){var t=n.callbackNode;KO(n,e);var i=$y(n,n===qt?nn:0);if(i===0)t!==null&&F1(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&F1(t),e===1)n.tag===0?GF(kI.bind(null,n)):Qk(kI.bind(null,n)),zF(function(){!(Ne&6)&&Ma()}),t=null;else{switch(bk(i)){case 1:t=AT;break;case 4:t=Ak;break;case 16:t=By;break;case 536870912:t=Tk;break;default:t=By}t=Kx(t,Bx.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Bx(n,e){if(Gm=-1,Km=0,Ne&6)throw Error(W(327));var t=n.callbackNode;if(yu()&&n.callbackNode!==t)return null;var i=$y(n,n===qt?nn:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=ov(n,i);else{e=i;var s=Ne;Ne|=2;var r=zx();(qt!==n||nn!==e)&&(yr=null,Dh=Et()+500,tc(n,e));do try{pV();break}catch(a){$x(n,a)}while(!0);MT(),iv.current=r,Ne=s,bt!==null?e=0:(qt=null,nn=0,e=Dt)}if(e!==0){if(e===2&&(s=Hw(n),s!==0&&(i=s,e=vE(n,s))),e===1)throw t=Vf,tc(n,0),Io(n,i),ni(n,Et()),t;if(e===6)Io(n,i);else{if(s=n.current.alternate,!(i&30)&&!dV(s)&&(e=ov(n,i),e===2&&(r=Hw(n),r!==0&&(i=r,e=vE(n,r))),e===1))throw t=Vf,tc(n,0),Io(n,i),ni(n,Et()),t;switch(n.finishedWork=s,n.finishedLanes=i,e){case 0:case 1:throw Error(W(345));case 2:Ka(n,Qn,yr);break;case 3:if(Io(n,i),(i&130023424)===i&&(e=QT+500-Et(),10<e)){if($y(n,0)!==0)break;if(s=n.suspendedLanes,(s&i)!==i){On(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=Jw(Ka.bind(null,n,Qn,yr),e);break}Ka(n,Qn,yr);break;case 4:if(Io(n,i),(i&4194240)===i)break;for(e=n.eventTimes,s=-1;0<i;){var o=31-_s(i);r=1<<o,o=e[o],o>s&&(s=o),i&=~r}if(i=s,i=Et()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*hV(i/1960))-i,10<i){n.timeoutHandle=Jw(Ka.bind(null,n,Qn,yr),i);break}Ka(n,Qn,yr);break;case 5:Ka(n,Qn,yr);break;default:throw Error(W(329))}}}return ni(n,Et()),n.callbackNode===t?Bx.bind(null,n):null}function vE(n,e){var t=hf;return n.current.memoizedState.isDehydrated&&(tc(n,e).flags|=256),n=ov(n,e),n!==2&&(e=Qn,Qn=t,e!==null&&_E(e)),n}function _E(n){Qn===null?Qn=n:Qn.push.apply(Qn,n)}function dV(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!As(r(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Io(n,e){for(e&=~XT,e&=~f_,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-_s(e),i=1<<t;n[t]=-1,e&=~i}}function kI(n){if(Ne&6)throw Error(W(327));yu();var e=$y(n,0);if(!(e&1))return ni(n,Et()),null;var t=ov(n,e);if(n.tag!==0&&t===2){var i=Hw(n);i!==0&&(e=i,t=vE(n,i))}if(t===1)throw t=Vf,tc(n,0),Io(n,e),ni(n,Et()),t;if(t===6)throw Error(W(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ka(n,Qn,yr),ni(n,Et()),null}function YT(n,e){var t=Ne;Ne|=1;try{return n(e)}finally{Ne=t,Ne===0&&(Dh=Et()+500,c_&&Ma())}}function uc(n){aa!==null&&aa.tag===0&&!(Ne&6)&&yu();var e=Ne;Ne|=1;var t=Hi.transition,i=Be;try{if(Hi.transition=null,Be=1,n)return n()}finally{Be=i,Hi.transition=t,Ne=e,!(Ne&6)&&Ma()}}function JT(){vi=lu.current,et(lu)}function tc(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,$F(t)),bt!==null)for(t=bt.return;t!==null;){var i=t;switch(NT(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Gy();break;case 3:Nh(),et(ei),et(Sn),BT();break;case 5:jT(i);break;case 4:Nh();break;case 13:et(lt);break;case 19:et(lt);break;case 10:OT(i.type._context);break;case 22:case 23:JT()}t=t.return}if(qt=n,bt=n=ya(n.current,null),nn=vi=e,Dt=0,Vf=null,XT=f_=cc=0,Qn=hf=null,nl!==null){for(e=0;e<nl.length;e++)if(t=nl[e],i=t.interleaved,i!==null){t.interleaved=null;var s=i.next,r=t.pending;if(r!==null){var o=r.next;r.next=s,i.next=o}t.pending=i}nl=null}return n}function $x(n,e){do{var t=bt;try{if(MT(),Hm.current=nv,tv){for(var i=ut.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}tv=!1}if(lc=0,Ht=Lt=ut=null,cf=!1,Mf=0,KT.current=null,t===null||t.return===null){Dt=1,Vf=e,bt=null;break}e:{var r=n,o=t.return,a=t,l=e;if(e=nn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=mI(o);if(g!==null){g.flags&=-257,yI(g,o,a,r,e),g.mode&1&&gI(r,c,e),e=g,l=c;var y=e.updateQueue;if(y===null){var _=new Set;_.add(l),e.updateQueue=_}else y.add(l);break e}else{if(!(e&1)){gI(r,c,e),ZT();break e}l=Error(W(426))}}else if(st&&a.mode&1){var A=mI(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),yI(A,o,a,r,e),LT(Lh(l,a));break e}}r=l=Lh(l,a),Dt!==4&&(Dt=2),hf===null?hf=[r]:hf.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=bx(r,l,e);cI(r,v);break e;case 1:a=l;var E=r.type,S=r.stateNode;if(!(r.flags&128)&&(typeof E.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ga===null||!ga.has(S)))){r.flags|=65536,e&=-e,r.lanes|=e;var P=Ix(r,a,e);cI(r,P);break e}}r=r.return}while(r!==null)}qx(t)}catch(O){e=O,bt===t&&t!==null&&(bt=t=t.return);continue}break}while(!0)}function zx(){var n=iv.current;return iv.current=nv,n===null?nv:n}function ZT(){(Dt===0||Dt===3||Dt===2)&&(Dt=4),qt===null||!(cc&268435455)&&!(f_&268435455)||Io(qt,nn)}function ov(n,e){var t=Ne;Ne|=2;var i=zx();(qt!==n||nn!==e)&&(yr=null,tc(n,e));do try{fV();break}catch(s){$x(n,s)}while(!0);if(MT(),Ne=t,iv.current=i,bt!==null)throw Error(W(261));return qt=null,nn=0,Dt}function fV(){for(;bt!==null;)Hx(bt)}function pV(){for(;bt!==null&&!UO();)Hx(bt)}function Hx(n){var e=Gx(n.alternate,n,vi);n.memoizedProps=n.pendingProps,e===null?qx(n):bt=e,KT.current=null}function qx(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=aV(t,e),t!==null){t.flags&=32767,bt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Dt=6,bt=null;return}}else if(t=oV(t,e,vi),t!==null){bt=t;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=n}while(e!==null);Dt===0&&(Dt=5)}function Ka(n,e,t){var i=Be,s=Hi.transition;try{Hi.transition=null,Be=1,gV(n,e,t,i)}finally{Hi.transition=s,Be=i}return null}function gV(n,e,t,i){do yu();while(aa!==null);if(Ne&6)throw Error(W(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(W(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(XO(n,r),n===qt&&(bt=qt=null,nn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||wm||(wm=!0,Kx(By,function(){return yu(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Hi.transition,Hi.transition=null;var o=Be;Be=1;var a=Ne;Ne|=4,KT.current=null,cV(n,t),Ux(t,n),MF(Qw),zy=!!Xw,Qw=Xw=null,n.current=t,uV(t),jO(),Ne=a,Be=o,Hi.transition=r}else n.current=t;if(wm&&(wm=!1,aa=n,rv=s),r=n.pendingLanes,r===0&&(ga=null),zO(t.stateNode),ni(n,Et()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],i(s.value,{componentStack:s.stack,digest:s.digest});if(sv)throw sv=!1,n=mE,mE=null,n;return rv&1&&n.tag!==0&&yu(),r=n.pendingLanes,r&1?n===yE?df++:(df=0,yE=n):df=0,Ma(),null}function yu(){if(aa!==null){var n=bk(rv),e=Hi.transition,t=Be;try{if(Hi.transition=null,Be=16>n?16:n,aa===null)var i=!1;else{if(n=aa,aa=null,rv=0,Ne&6)throw Error(W(331));var s=Ne;for(Ne|=4,Z=n.current;Z!==null;){var r=Z,o=r.child;if(Z.flags&16){var a=r.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Z=c;Z!==null;){var h=Z;switch(h.tag){case 0:case 11:case 15:uf(8,h,r)}var f=h.child;if(f!==null)f.return=h,Z=f;else for(;Z!==null;){h=Z;var p=h.sibling,g=h.return;if(Ox(h),h===c){Z=null;break}if(p!==null){p.return=g,Z=p;break}Z=g}}}var y=r.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var A=_.sibling;_.sibling=null,_=A}while(_!==null)}}Z=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,Z=o;else e:for(;Z!==null;){if(r=Z,r.flags&2048)switch(r.tag){case 0:case 11:case 15:uf(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,Z=v;break e}Z=r.return}}var E=n.current;for(Z=E;Z!==null;){o=Z;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Z=S;else e:for(o=E;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:d_(9,a)}}catch(O){mt(a,a.return,O)}if(a===o){Z=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,Z=P;break e}Z=a.return}}if(Ne=s,Ma(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(s_,n)}catch{}i=!0}return i}finally{Be=t,Hi.transition=e}}return!1}function xI(n,e,t){e=Lh(t,e),e=bx(n,e,1),n=pa(n,e,1),e=On(),n!==null&&(vg(n,1,e),ni(n,e))}function mt(n,e,t){if(n.tag===3)xI(n,n,t);else for(;e!==null;){if(e.tag===3){xI(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ga===null||!ga.has(i))){n=Lh(t,n),n=Ix(e,n,1),e=pa(e,n,1),n=On(),e!==null&&(vg(e,1,n),ni(e,n));break}}e=e.return}}function mV(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=On(),n.pingedLanes|=n.suspendedLanes&t,qt===n&&(nn&t)===t&&(Dt===4||Dt===3&&(nn&130023424)===nn&&500>Et()-QT?tc(n,0):XT|=t),ni(n,e)}function Wx(n,e){e===0&&(n.mode&1?(e=um,um<<=1,!(um&130023424)&&(um=4194304)):e=1);var t=On();n=ao(n,e),n!==null&&(vg(n,e,t),ni(n,t))}function yV(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Wx(n,t)}function vV(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(W(314))}i!==null&&i.delete(e),Wx(n,t)}var Gx;Gx=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ei.current)Zn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Zn=!1,rV(n,e,t);Zn=!!(n.flags&131072)}else Zn=!1,st&&e.flags&1048576&&Yk(e,Qy,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Wm(n,e),n=e.pendingProps;var s=kh(e,Sn.current);mu(e,t),s=zT(null,e,i,n,s,t);var r=HT();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ti(i)?(r=!0,Ky(e)):r=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,VT(e),s.updater=h_,e.stateNode=s,s._reactInternals=e,rE(e,i,n,t),e=lE(null,e,i,!0,r,t)):(e.tag=0,st&&r&&PT(e),Ln(null,e,s,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Wm(n,e),n=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=wV(i),n=Zi(i,n),s){case 0:e=aE(null,e,i,n,t);break e;case 1:e=wI(null,e,i,n,t);break e;case 11:e=vI(null,e,i,n,t);break e;case 14:e=_I(null,e,i,Zi(i.type,n),t);break e}throw Error(W(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zi(i,s),aE(n,e,i,s,t);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zi(i,s),wI(n,e,i,s,t);case 3:e:{if(xx(e),n===null)throw Error(W(387));i=e.pendingProps,r=e.memoizedState,s=r.element,ix(n,e),Zy(e,i,null,t);var o=e.memoizedState;if(i=o.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){s=Lh(Error(W(423)),e),e=EI(n,e,i,t,s);break e}else if(i!==s){s=Lh(Error(W(424)),e),e=EI(n,e,i,t,s);break e}else for(wi=fa(e.stateNode.containerInfo.firstChild),Ti=e,st=!0,gs=null,t=tx(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(xh(),i===s){e=lo(n,e,t);break e}Ln(n,e,i,t)}e=e.child}return e;case 5:return sx(e),n===null&&nE(e),i=e.type,s=e.pendingProps,r=n!==null?n.memoizedProps:null,o=s.children,Yw(i,s)?o=null:r!==null&&Yw(i,r)&&(e.flags|=32),kx(n,e),Ln(n,e,o,t),e.child;case 6:return n===null&&nE(e),null;case 13:return Px(n,e,t);case 4:return UT(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Ph(e,null,i,t):Ln(n,e,i,t),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zi(i,s),vI(n,e,i,s,t);case 7:return Ln(n,e,e.pendingProps,t),e.child;case 8:return Ln(n,e,e.pendingProps.children,t),e.child;case 12:return Ln(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,r=e.memoizedProps,o=s.value,Qe(Yy,i._currentValue),i._currentValue=o,r!==null)if(As(r.value,o)){if(r.children===s.children&&!ei.current){e=lo(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(r.tag===1){l=Jr(-1,t&-t),l.tag=2;var c=r.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}r.lanes|=t,l=r.alternate,l!==null&&(l.lanes|=t),iE(r.return,t,e),a.lanes|=t;break}l=l.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(W(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),iE(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}Ln(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,mu(e,t),s=Wi(s),i=i(s),e.flags|=1,Ln(n,e,i,t),e.child;case 14:return i=e.type,s=Zi(i,e.pendingProps),s=Zi(i.type,s),_I(n,e,i,s,t);case 15:return Cx(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Zi(i,s),Wm(n,e),e.tag=1,ti(i)?(n=!0,Ky(e)):n=!1,mu(e,t),Sx(e,i,s),rE(e,i,s,t),lE(null,e,i,!0,n,t);case 19:return Nx(n,e,t);case 22:return Rx(n,e,t)}throw Error(W(156,e.tag))};function Kx(n,e){return Ek(n,e)}function _V(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zi(n,e,t,i){return new _V(n,e,t,i)}function eS(n){return n=n.prototype,!(!n||!n.isReactComponent)}function wV(n){if(typeof n=="function")return eS(n)?1:0;if(n!=null){if(n=n.$$typeof,n===_T)return 11;if(n===wT)return 14}return 2}function ya(n,e){var t=n.alternate;return t===null?(t=zi(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Xm(n,e,t,i,s,r){var o=2;if(i=n,typeof n=="function")eS(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Jc:return nc(t.children,s,r,e);case vT:o=8,s|=8;break;case kw:return n=zi(12,t,e,s|2),n.elementType=kw,n.lanes=r,n;case xw:return n=zi(13,t,e,s),n.elementType=xw,n.lanes=r,n;case Pw:return n=zi(19,t,e,s),n.elementType=Pw,n.lanes=r,n;case sk:return p_(t,s,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case nk:o=10;break e;case ik:o=9;break e;case _T:o=11;break e;case wT:o=14;break e;case To:o=16,i=null;break e}throw Error(W(130,n==null?n:typeof n,""))}return e=zi(o,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function nc(n,e,t,i){return n=zi(7,n,i,e),n.lanes=t,n}function p_(n,e,t,i){return n=zi(22,n,i,e),n.elementType=sk,n.lanes=t,n.stateNode={isHidden:!1},n}function nw(n,e,t){return n=zi(6,n,null,e),n.lanes=t,n}function iw(n,e,t){return e=zi(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function EV(n,e,t,i,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=F0(0),this.expirationTimes=F0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=F0(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function tS(n,e,t,i,s,r,o,a,l){return n=new EV(n,e,t,a,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=zi(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},VT(r),n}function AV(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yc,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function Xx(n){if(!n)return Aa;n=n._reactInternals;e:{if(Ac(n)!==n||n.tag!==1)throw Error(W(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ti(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(n.tag===1){var t=n.type;if(ti(t))return Xk(n,t,e)}return e}function Qx(n,e,t,i,s,r,o,a,l){return n=tS(t,i,!0,n,s,r,o,a,l),n.context=Xx(null),t=n.current,i=On(),s=ma(t),r=Jr(i,s),r.callback=e??null,pa(t,r,s),n.current.lanes=s,vg(n,s,i),ni(n,i),n}function g_(n,e,t,i){var s=e.current,r=On(),o=ma(s);return t=Xx(t),e.context===null?e.context=t:e.pendingContext=t,e=Jr(r,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=pa(s,e,o),n!==null&&(ws(n,s,o,r),zm(n,s,o)),o}function av(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function PI(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function nS(n,e){PI(n,e),(n=n.alternate)&&PI(n,e)}function TV(){return null}var Yx=typeof reportError=="function"?reportError:function(n){console.error(n)};function iS(n){this._internalRoot=n}m_.prototype.render=iS.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(W(409));g_(n,e,null,null)};m_.prototype.unmount=iS.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;uc(function(){g_(null,n,null,null)}),e[oo]=null}};function m_(n){this._internalRoot=n}m_.prototype.unstable_scheduleHydration=function(n){if(n){var e=Rk();n={blockedOn:null,target:n,priority:e};for(var t=0;t<bo.length&&e!==0&&e<bo[t].priority;t++);bo.splice(t,0,n),t===0&&xk(n)}};function sS(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function y_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function NI(){}function SV(n,e,t,i,s){if(s){if(typeof i=="function"){var r=i;i=function(){var c=av(o);r.call(c)}}var o=Qx(e,i,n,0,null,!1,!1,"",NI);return n._reactRootContainer=o,n[oo]=o.current,xf(n.nodeType===8?n.parentNode:n),uc(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof i=="function"){var a=i;i=function(){var c=av(l);a.call(c)}}var l=tS(n,0,!1,null,null,!1,!1,"",NI);return n._reactRootContainer=l,n[oo]=l.current,xf(n.nodeType===8?n.parentNode:n),uc(function(){g_(e,l,t,i)}),l}function v_(n,e,t,i,s){var r=t._reactRootContainer;if(r){var o=r;if(typeof s=="function"){var a=s;s=function(){var l=av(o);a.call(l)}}g_(e,o,n,s)}else o=SV(t,e,n,s,i);return av(o)}Ik=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ld(e.pendingLanes);t!==0&&(TT(e,t|1),ni(e,Et()),!(Ne&6)&&(Dh=Et()+500,Ma()))}break;case 13:uc(function(){var i=ao(n,1);if(i!==null){var s=On();ws(i,n,1,s)}}),nS(n,1)}};ST=function(n){if(n.tag===13){var e=ao(n,134217728);if(e!==null){var t=On();ws(e,n,134217728,t)}nS(n,134217728)}};Ck=function(n){if(n.tag===13){var e=ma(n),t=ao(n,e);if(t!==null){var i=On();ws(t,n,e,i)}nS(n,e)}};Rk=function(){return Be};kk=function(n,e){var t=Be;try{return Be=n,e()}finally{Be=t}};Bw=function(n,e,t){switch(e){case"input":if(Dw(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=l_(i);if(!s)throw Error(W(90));ok(i),Dw(i,s)}}}break;case"textarea":lk(n,t);break;case"select":e=t.value,e!=null&&du(n,!!t.multiple,e,!1)}};gk=YT;mk=uc;var bV={usingClientEntryPoint:!1,Events:[wg,nu,l_,fk,pk,YT]},Id={findFiberByHostInstance:tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},IV={bundleType:Id.bundleType,version:Id.version,rendererPackageName:Id.rendererPackageName,rendererConfig:Id.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:go.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=_k(n),n===null?null:n.stateNode},findFiberByHostInstance:Id.findFiberByHostInstance||TV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{s_=Em.inject(IV),Zs=Em}catch{}}Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bV;Ri.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sS(e))throw Error(W(200));return AV(n,e,null,t)};Ri.createRoot=function(n,e){if(!sS(n))throw Error(W(299));var t=!1,i="",s=Yx;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=tS(n,1,!1,null,null,t,!1,i,s),n[oo]=e.current,xf(n.nodeType===8?n.parentNode:n),new iS(e)};Ri.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(W(188)):(n=Object.keys(n).join(","),Error(W(268,n)));return n=_k(e),n=n===null?null:n.stateNode,n};Ri.flushSync=function(n){return uc(n)};Ri.hydrate=function(n,e,t){if(!y_(e))throw Error(W(200));return v_(null,n,e,!0,t)};Ri.hydrateRoot=function(n,e,t){if(!sS(n))throw Error(W(405));var i=t!=null&&t.hydratedSources||null,s=!1,r="",o=Yx;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Qx(e,null,n,1,t??null,s,!1,r,o),n[oo]=e.current,xf(n),i)for(n=0;n<i.length;n++)t=i[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new m_(e)};Ri.render=function(n,e,t){if(!y_(e))throw Error(W(200));return v_(null,n,e,!1,t)};Ri.unmountComponentAtNode=function(n){if(!y_(n))throw Error(W(40));return n._reactRootContainer?(uc(function(){v_(null,null,n,!1,function(){n._reactRootContainer=null,n[oo]=null})}),!0):!1};Ri.unstable_batchedUpdates=YT;Ri.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!y_(t))throw Error(W(200));if(n==null||n._reactInternals===void 0)throw Error(W(38));return v_(n,e,t,!1,i)};Ri.version="18.3.1-next-f1338f8080-20240426";function Jx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jx)}catch(n){console.error(n)}}Jx(),JR.exports=Ri;var CV=JR.exports,Zx,LI=CV;Zx=LI.createRoot,LI.hydrateRoot;var rS={};Object.defineProperty(rS,"__esModule",{value:!0});rS.parse=DV;rS.serialize=MV;const RV=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,kV=/^[\u0021-\u003A\u003C-\u007E]*$/,xV=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,PV=/^[\u0020-\u003A\u003D-\u007E]*$/,NV=Object.prototype.toString,LV=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function DV(n,e){const t=new LV,i=n.length;if(i<2)return t;const s=(e==null?void 0:e.decode)||OV;let r=0;do{const o=n.indexOf("=",r);if(o===-1)break;const a=n.indexOf(";",r),l=a===-1?i:a;if(o>l){r=n.lastIndexOf(";",o-1)+1;continue}const c=DI(n,r,o),h=MI(n,o,c),f=n.slice(c,h);if(t[f]===void 0){let p=DI(n,o+1,l),g=MI(n,l,p);const y=s(n.slice(p,g));t[f]=y}r=l+1}while(r<i);return t}function DI(n,e,t){do{const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}while(++e<t);return t}function MI(n,e,t){for(;e>t;){const i=n.charCodeAt(--e);if(i!==32&&i!==9)return e+1}return t}function MV(n,e,t){const i=(t==null?void 0:t.encode)||encodeURIComponent;if(!RV.test(n))throw new TypeError(`argument name is invalid: ${n}`);const s=i(e);if(!kV.test(s))throw new TypeError(`argument val is invalid: ${e}`);let r=n+"="+s;if(!t)return r;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);r+="; Max-Age="+t.maxAge}if(t.domain){if(!xV.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);r+="; Domain="+t.domain}if(t.path){if(!PV.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);r+="; Path="+t.path}if(t.expires){if(!FV(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);r+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(r+="; HttpOnly"),t.secure&&(r+="; Secure"),t.partitioned&&(r+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"none":r+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return r}function OV(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function FV(n){return NV.call(n)==="[object Date]"}/**
 * react-router v7.0.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OI="popstate";function VV(n={}){function e(i,s){let{pathname:r,search:o,hash:a}=i.location;return wE("",{pathname:r,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){return typeof s=="string"?s:Uf(s)}return jV(e,t,null,n)}function ht(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Oa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UV(){return Math.random().toString(36).substring(2,10)}function FI(n,e){return{usr:n.state,key:n.key,idx:e}}function wE(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Qh(e):e,state:t,key:e&&e.key||i||UV()}}function Uf({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Qh(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function jV(n,e,t,i={}){let{window:s=document.defaultView,v5Compat:r=!1}=i,o=s.history,a="POP",l=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let A=h(),v=A==null?null:A-c;c=A,l&&l({action:a,location:_.location,delta:v})}function p(A,v){a="PUSH";let E=wE(_.location,A,v);c=h()+1;let S=FI(E,c),P=_.createHref(E);try{o.pushState(S,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(P)}r&&l&&l({action:a,location:_.location,delta:1})}function g(A,v){a="REPLACE";let E=wE(_.location,A,v);c=h();let S=FI(E,c),P=_.createHref(E);o.replaceState(S,"",P),r&&l&&l({action:a,location:_.location,delta:0})}function y(A){let v=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof A=="string"?A:Uf(A);return E=E.replace(/ $/,"%20"),ht(v,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,v)}let _={get action(){return a},get location(){return n(s,o)},listen(A){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(OI,f),l=A,()=>{s.removeEventListener(OI,f),l=null}},createHref(A){return e(s,A)},createURL:y,encodeLocation(A){let v=y(A);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:g,go(A){return o.go(A)}};return _}function eP(n,e,t="/"){return BV(n,e,t,!1)}function BV(n,e,t,i){let s=typeof e=="string"?Qh(e):e,r=Ta(s.pathname||"/",t);if(r==null)return null;let o=tP(n);$V(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=ZV(r);a=YV(o[l],c,i)}return a}function tP(n,e=[],t=[],i=""){let s=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(ht(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let c=Zr([i,l.relativePath]),h=t.concat(l);r.children&&r.children.length>0&&(ht(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),tP(r.children,e,h,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:XV(c,r.index),routesMeta:h})};return n.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))s(r,o);else for(let l of nP(r.path))s(r,o,l)}),e}function nP(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),r=t.replace(/\?$/,"");if(i.length===0)return s?[r,""]:[r];let o=nP(i.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function $V(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:QV(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var zV=/^:[\w-]+$/,HV=3,qV=2,WV=1,GV=10,KV=-2,VI=n=>n==="*";function XV(n,e){let t=n.split("/"),i=t.length;return t.some(VI)&&(i+=KV),e&&(i+=qV),t.filter(s=>!VI(s)).reduce((s,r)=>s+(zV.test(r)?HV:r===""?WV:GV),i)}function QV(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function YV(n,e,t=!1){let{routesMeta:i}=n,s={},r="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],c=a===i.length-1,h=r==="/"?e:e.slice(r.length)||"/",f=lv({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),p=l.route;if(!f&&c&&t&&!i[i.length-1].route.index&&(f=lv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Zr([r,f.pathname]),pathnameBase:iU(Zr([r,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(r=Zr([r,f.pathnameBase]))}return o}function lv(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=JV(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let r=s[0],o=r.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:i.reduce((c,{paramName:h,isOptional:f},p)=>{if(h==="*"){let y=a[p]||"";o=r.slice(0,r.length-y.length).replace(/(.)\/+$/,"$1")}const g=a[p];return f&&!g?c[h]=void 0:c[h]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:n}}function JV(n,e=!1,t=!0){Oa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function ZV(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Oa(!1,`The URL path "${n}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ta(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function eU(n,e="/"){let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?Qh(n):n;return{pathname:t?t.startsWith("/")?t:tU(t,e):e,search:sU(i),hash:rU(s)}}function tU(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function sw(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nU(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function iP(n){let e=nU(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function sP(n,e,t,i=!1){let s;typeof n=="string"?s=Qh(n):(s={...n},ht(!s.pathname||!s.pathname.includes("?"),sw("?","pathname","search",s)),ht(!s.pathname||!s.pathname.includes("#"),sw("#","pathname","hash",s)),ht(!s.search||!s.search.includes("#"),sw("#","search","hash",s)));let r=n===""||s.pathname==="",o=r?"/":s.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!i&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=eU(s,a),c=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Zr=n=>n.join("/").replace(/\/\/+/g,"/"),iU=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),sU=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,rU=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function oU(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var rP=["POST","PUT","PATCH","DELETE"];new Set(rP);var aU=["GET",...rP];new Set(aU);var Yh=U.createContext(null);Yh.displayName="DataRouter";var __=U.createContext(null);__.displayName="DataRouterState";var oP=U.createContext({isTransitioning:!1});oP.displayName="ViewTransition";var lU=U.createContext(new Map);lU.displayName="Fetchers";var cU=U.createContext(null);cU.displayName="Await";var lr=U.createContext(null);lr.displayName="Navigation";var Ag=U.createContext(null);Ag.displayName="Location";var cr=U.createContext({outlet:null,matches:[],isDataRoute:!1});cr.displayName="Route";var oS=U.createContext(null);oS.displayName="RouteError";function uU(n,{relative:e}={}){ht(Tg(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=U.useContext(lr),{hash:s,pathname:r,search:o}=Sg(n,{relative:e}),a=r;return t!=="/"&&(a=r==="/"?t:Zr([t,r])),i.createHref({pathname:a,search:o,hash:s})}function Tg(){return U.useContext(Ag)!=null}function mo(){return ht(Tg(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Ag).location}var aP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function lP(n){U.useContext(lr).static||U.useLayoutEffect(n)}function Tc(){let{isDataRoute:n}=U.useContext(cr);return n?TU():hU()}function hU(){ht(Tg(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Yh),{basename:e,navigator:t}=U.useContext(lr),{matches:i}=U.useContext(cr),{pathname:s}=mo(),r=JSON.stringify(iP(i)),o=U.useRef(!1);return lP(()=>{o.current=!0}),U.useCallback((l,c={})=>{if(Oa(o.current,aP),!o.current)return;if(typeof l=="number"){t.go(l);return}let h=sP(l,JSON.parse(r),s,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Zr([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,r,s,n])}U.createContext(null);function cP(){let{matches:n}=U.useContext(cr),e=n[n.length-1];return e?e.params:{}}function Sg(n,{relative:e}={}){let{matches:t}=U.useContext(cr),{pathname:i}=mo(),s=JSON.stringify(iP(t));return U.useMemo(()=>sP(n,JSON.parse(s),i,e==="path"),[n,s,i,e])}function dU(n,e){return uP(n,e)}function uP(n,e,t,i){var _;ht(Tg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=U.useContext(lr),{matches:r}=U.useContext(cr),o=r[r.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=mo(),h;if(e){let A=typeof e=="string"?Qh(e):e;ht(l==="/"||((_=A.pathname)==null?void 0:_.startsWith(l)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${l}" but pathname "${A.pathname}" was given in the \`location\` prop.`),h=A}else h=c;let f=h.pathname||"/",p=f;if(l!=="/"){let A=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(A.length).join("/")}let g=eP(n,{pathname:p}),y=yU(g&&g.map(A=>Object.assign({},A,{params:Object.assign({},a,A.params),pathname:Zr([l,s.encodeLocation?s.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?l:Zr([l,s.encodeLocation?s.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),r,t,i);return e&&y?U.createElement(Ag.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},y):y}function fU(){let n=AU(),e=oU(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:s},t):null,null)}var pU=U.createElement(fU,null),gU=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?U.createElement(cr.Provider,{value:this.props.routeContext},U.createElement(oS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function mU({routeContext:n,match:e,children:t}){let i=U.useContext(Yh);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(cr.Provider,{value:n},t)}function yU(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,r=t==null?void 0:t.errors;if(r!=null){let l=s.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);ht(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<s.length;l++){let c=s[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:h,errors:f}=t,p=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||p){o=!0,a>=0?s=s.slice(0,a+1):s=[s[0]];break}}}return s.reduceRight((l,c,h)=>{let f,p=!1,g=null,y=null;t&&(f=r&&c.route.id?r[c.route.id]:void 0,g=c.route.errorElement||pU,o&&(a<0&&h===0?(SU("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):a===h&&(p=!0,y=c.route.hydrateFallbackElement||null)));let _=e.concat(s.slice(0,h+1)),A=()=>{let v;return f?v=g:p?v=y:c.route.Component?v=U.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,U.createElement(mU,{match:c,routeContext:{outlet:l,matches:_,isDataRoute:t!=null},children:v})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?U.createElement(gU,{location:t.location,revalidation:t.revalidation,component:g,error:f,children:A(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):A()},null)}function aS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vU(n){let e=U.useContext(Yh);return ht(e,aS(n)),e}function _U(n){let e=U.useContext(__);return ht(e,aS(n)),e}function wU(n){let e=U.useContext(cr);return ht(e,aS(n)),e}function lS(n){let e=wU(n),t=e.matches[e.matches.length-1];return ht(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function EU(){return lS("useRouteId")}function AU(){var i;let n=U.useContext(oS),e=_U("useRouteError"),t=lS("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function TU(){let{router:n}=vU("useNavigate"),e=lS("useNavigate"),t=U.useRef(!1);return lP(()=>{t.current=!0}),U.useCallback(async(s,r={})=>{Oa(t.current,aP),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...r}))},[n,e])}var UI={};function SU(n,e,t){UI[n]||(UI[n]=!0,Oa(!1,t))}U.memo(bU);function bU({routes:n,future:e,state:t}){return uP(n,void 0,t,e)}function Uc(n){ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function IU({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:s,static:r=!1}){ht(!Tg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),a=U.useMemo(()=>({basename:o,navigator:s,static:r,future:{}}),[o,s,r]);typeof t=="string"&&(t=Qh(t));let{pathname:l="/",search:c="",hash:h="",state:f=null,key:p="default"}=t,g=U.useMemo(()=>{let y=Ta(l,o);return y==null?null:{location:{pathname:y,search:c,hash:h,state:f,key:p},navigationType:i}},[o,l,c,h,f,p,i]);return Oa(g!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:U.createElement(lr.Provider,{value:a},U.createElement(Ag.Provider,{children:e,value:g}))}function CU({children:n,location:e}){return dU(EE(n),e)}function EE(n,e=[]){let t=[];return U.Children.forEach(n,(i,s)=>{if(!U.isValidElement(i))return;let r=[...e,s];if(i.type===U.Fragment){t.push.apply(t,EE(i.props.children,r));return}ht(i.type===Uc,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ht(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||r.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=EE(i.props.children,r)),t.push(o)}),t}var Qm="get",Ym="application/x-www-form-urlencoded";function w_(n){return n!=null&&typeof n.tagName=="string"}function RU(n){return w_(n)&&n.tagName.toLowerCase()==="button"}function kU(n){return w_(n)&&n.tagName.toLowerCase()==="form"}function xU(n){return w_(n)&&n.tagName.toLowerCase()==="input"}function PU(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function NU(n,e){return n.button===0&&(!e||e==="_self")&&!PU(n)}var Am=null;function LU(){if(Am===null)try{new FormData(document.createElement("form"),0),Am=!1}catch{Am=!0}return Am}var DU=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rw(n){return n!=null&&!DU.has(n)?(Oa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ym}"`),null):n}function MU(n,e){let t,i,s,r,o;if(kU(n)){let a=n.getAttribute("action");i=a?Ta(a,e):null,t=n.getAttribute("method")||Qm,s=rw(n.getAttribute("enctype"))||Ym,r=new FormData(n)}else if(RU(n)||xU(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(i=l?Ta(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||Qm,s=rw(n.getAttribute("formenctype"))||rw(a.getAttribute("enctype"))||Ym,r=new FormData(a,n),!LU()){let{name:c,type:h,value:f}=n;if(h==="image"){let p=c?`${c}.`:"";r.append(`${p}x`,"0"),r.append(`${p}y`,"0")}else c&&r.append(c,f)}}else{if(w_(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Qm,i=null,s=Ym,o=n}return r&&s==="text/plain"&&(o=r,r=void 0),{action:i,method:t.toLowerCase(),encType:s,formData:r,body:o}}function cS(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function OU(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function FU(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function VU(n,e,t){let i=await Promise.all(n.map(async s=>{let r=e.routes[s.route.id];if(r){let o=await OU(r,t);return o.links?o.links():[]}return[]}));return $U(i.flat(1).filter(FU).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function jI(n,e,t,i,s,r){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var h;return t[c].pathname!==l.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var f;let h=i.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function UU(n,e){return jU(n.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let s=[i.module];return i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function jU(n){return[...new Set(n)]}function BU(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function $U(n,e){let t=new Set;return new Set(e),n.reduce((i,s)=>{let r=JSON.stringify(BU(s));return t.has(r)||(t.add(r),i.push({key:r,link:s})),i},[])}function zU(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function HU(){let n=U.useContext(Yh);return cS(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function qU(){let n=U.useContext(__);return cS(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var uS=U.createContext(void 0);uS.displayName="FrameworkContext";function hP(){let n=U.useContext(uS);return cS(n,"You must render this element inside a <HydratedRouter> element"),n}function WU(n,e){let t=U.useContext(uS),[i,s]=U.useState(!1),[r,o]=U.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:f}=e,p=U.useRef(null);U.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let _=v=>{v.forEach(E=>{o(E.isIntersecting)})},A=new IntersectionObserver(_,{threshold:.5});return p.current&&A.observe(p.current),()=>{A.disconnect()}}},[n]),U.useEffect(()=>{if(i){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[i]);let g=()=>{s(!0)},y=()=>{s(!1),o(!1)};return t?n!=="intent"?[r,p,{}]:[r,p,{onFocus:Cd(a,g),onBlur:Cd(l,y),onMouseEnter:Cd(c,g),onMouseLeave:Cd(h,y),onTouchStart:Cd(f,g)}]:[!1,p,{}]}function Cd(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function GU({page:n,...e}){let{router:t}=HU(),i=U.useMemo(()=>eP(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?U.createElement(XU,{page:n,matches:i,...e}):(console.warn(`Tried to prefetch ${n} but no routes matched.`),null)}function KU(n){let{manifest:e,routeModules:t}=hP(),[i,s]=U.useState([]);return U.useEffect(()=>{let r=!1;return VU(n,e,t).then(o=>{r||s(o)}),()=>{r=!0}},[n,e,t]),i}function XU({page:n,matches:e,...t}){let i=mo(),{manifest:s,routeModules:r}=hP(),{loaderData:o,matches:a}=qU(),l=U.useMemo(()=>jI(n,e,a,s,i,"data"),[n,e,a,s,i]),c=U.useMemo(()=>jI(n,e,a,s,i,"assets"),[n,e,a,s,i]),h=U.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let g=new Set,y=!1;if(e.forEach(A=>{var E;let v=s.routes[A.route.id];!v||!v.hasLoader||(!l.some(S=>S.route.id===A.route.id)&&A.route.id in o&&((E=r[A.route.id])!=null&&E.shouldRevalidate)||v.hasClientLoader?y=!0:g.add(A.route.id))}),g.size===0)return[];let _=zU(n);return y&&g.size>0&&_.searchParams.set("_routes",e.filter(A=>g.has(A.route.id)).map(A=>A.route.id).join(",")),[_.pathname+_.search]},[o,i,s,l,e,n,r]),f=U.useMemo(()=>UU(c,s),[c,s]),p=KU(c);return U.createElement(U.Fragment,null,h.map(g=>U.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...t})),f.map(g=>U.createElement("link",{key:g,rel:"modulepreload",href:g,...t})),p.map(({key:g,link:y})=>U.createElement("link",{key:g,...y})))}function QU(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var dP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{dP&&(window.__reactRouterVersion="7.0.1")}catch{}function YU({basename:n,children:e,window:t}){let i=U.useRef();i.current==null&&(i.current=VV({window:t,v5Compat:!0}));let s=i.current,[r,o]=U.useState({action:s.action,location:s.location}),a=U.useCallback(l=>{U.startTransition(()=>o(l))},[o]);return U.useLayoutEffect(()=>s.listen(a),[s,a]),U.createElement(IU,{basename:n,children:e,location:r.location,navigationType:r.action,navigator:s})}var fP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pP=U.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:s,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:f,...p},g){let{basename:y}=U.useContext(lr),_=typeof c=="string"&&fP.test(c),A,v=!1;if(typeof c=="string"&&_&&(A=c,dP))try{let k=new URL(window.location.href),L=c.startsWith("//")?new URL(k.protocol+c):new URL(c),M=Ta(L.pathname,y);L.origin===k.origin&&M!=null?c=M+L.search+L.hash:v=!0}catch{Oa(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=uU(c,{relative:s}),[S,P,O]=WU(i,p),F=t4(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:s,viewTransition:f});function I(k){e&&e(k),k.defaultPrevented||F(k)}let b=U.createElement("a",{...p,...O,href:A||E,onClick:v||r?e:I,ref:QU(g,P),target:l,"data-discover":!_&&t==="render"?"true":void 0});return S&&!_?U.createElement(U.Fragment,null,b,U.createElement(GU,{page:E})):b});pP.displayName="Link";var JU=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:s=!1,style:r,to:o,viewTransition:a,children:l,...c},h){let f=Sg(o,{relative:c.relative}),p=mo(),g=U.useContext(__),{navigator:y,basename:_}=U.useContext(lr),A=g!=null&&o4(f)&&a===!0,v=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,E=p.pathname,S=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(E=E.toLowerCase(),S=S?S.toLowerCase():null,v=v.toLowerCase()),S&&_&&(S=Ta(S,_)||S);const P=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let O=E===v||!s&&E.startsWith(v)&&E.charAt(P)==="/",F=S!=null&&(S===v||!s&&S.startsWith(v)&&S.charAt(v.length)==="/"),I={isActive:O,isPending:F,isTransitioning:A},b=O?e:void 0,k;typeof i=="function"?k=i(I):k=[i,O?"active":null,F?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let L=typeof r=="function"?r(I):r;return U.createElement(pP,{...c,"aria-current":b,className:k,ref:h,style:L,to:o,viewTransition:a},typeof l=="function"?l(I):l)});JU.displayName="NavLink";var ZU=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:s,state:r,method:o=Qm,action:a,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:f,...p},g)=>{let y=s4(),_=r4(a,{relative:c}),A=o.toLowerCase()==="get"?"get":"post",v=typeof a=="string"&&fP.test(a),E=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let P=S.nativeEvent.submitter,O=(P==null?void 0:P.getAttribute("formmethod"))||o;y(P||S.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:s,state:r,relative:c,preventScrollReset:h,viewTransition:f})};return U.createElement("form",{ref:g,method:A,action:_,onSubmit:i?l:E,...p,"data-discover":!v&&n==="render"?"true":void 0})});ZU.displayName="Form";function e4(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gP(n){let e=U.useContext(Yh);return ht(e,e4(n)),e}function t4(n,{target:e,replace:t,state:i,preventScrollReset:s,relative:r,viewTransition:o}={}){let a=Tc(),l=mo(),c=Sg(n,{relative:r});return U.useCallback(h=>{if(NU(h,e)){h.preventDefault();let f=t!==void 0?t:Uf(l)===Uf(c);a(n,{replace:f,state:i,preventScrollReset:s,relative:r,viewTransition:o})}},[l,a,c,t,i,e,n,s,r,o])}var n4=0,i4=()=>`__${String(++n4)}__`;function s4(){let{router:n}=gP("useSubmit"),{basename:e}=U.useContext(lr),t=EU();return U.useCallback(async(i,s={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=MU(i,e);if(s.navigate===!1){let h=s.fetcherKey||i4();await n.fetch(h,t,s.action||r,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await n.navigate(s.action||r,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function r4(n,{relative:e}={}){let{basename:t}=U.useContext(lr),i=U.useContext(cr);ht(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),r={...Sg(n||".",{relative:e})},o=mo();if(n==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();r.search=h?`?${h}`:""}}return(!n||n===".")&&s.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:Zr([t,r.pathname])),Uf(r)}function o4(n,e={}){let t=U.useContext(oP);ht(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=gP("useViewTransitionState"),s=Sg(n,{relative:e.relative});if(!t.isTransitioning)return!1;let r=Ta(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=Ta(t.nextLocation.pathname,i)||t.nextLocation.pathname;return lv(s.pathname,o)!=null||lv(s.pathname,r)!=null}new TextEncoder;const Yn={authPage:{baseUrl:"/auth",dynamicUrl:"/auth"},lecturePage:{baseUrl:"/lecture",dynamicUrl:"/lecture/:lectureId"},dashboardPage:{baseUrl:"/dashboard",dynamicUrl:"/dashboard"},notepadPage:{baseUrl:"/notepad",dynamicUrl:"/notepad/:notepadId"},unresolvedPage:{baseUrl:"*",dynamicUrl:"*"}},hS="/assets/logo-PcoCmuoR.png";function mP(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=mP(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function la(){for(var n,e,t=0,i="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=mP(n))&&(i&&(i+=" "),i+=e);return i}const jf=n=>typeof n=="number"&&!isNaN(n),ic=n=>typeof n=="string",Ei=n=>typeof n=="function",Jm=n=>ic(n)||Ei(n)?n:null,AE=n=>U.isValidElement(n)||ic(n)||Ei(n)||jf(n);function a4(n,e,t){t===void 0&&(t=300);const{scrollHeight:i,style:s}=n;requestAnimationFrame(()=>{s.minHeight="initial",s.height=i+"px",s.transition=`all ${t}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,t)})})}function E_(n){let{enter:e,exit:t,appendPosition:i=!1,collapse:s=!0,collapseDuration:r=300}=n;return function(o){let{children:a,position:l,preventExitTransition:c,done:h,nodeRef:f,isIn:p,playToast:g}=o;const y=i?`${e}--${l}`:e,_=i?`${t}--${l}`:t,A=U.useRef(0);return U.useLayoutEffect(()=>{const v=f.current,E=y.split(" "),S=P=>{P.target===f.current&&(g(),v.removeEventListener("animationend",S),v.removeEventListener("animationcancel",S),A.current===0&&P.type!=="animationcancel"&&v.classList.remove(...E))};v.classList.add(...E),v.addEventListener("animationend",S),v.addEventListener("animationcancel",S)},[]),U.useEffect(()=>{const v=f.current,E=()=>{v.removeEventListener("animationend",E),s?a4(v,h,r):h()};p||(c?E():(A.current=1,v.className+=` ${_}`,v.addEventListener("animationend",E)))},[p]),Ge.createElement(Ge.Fragment,null,a)}}function BI(n,e){return n!=null?{content:n.content,containerId:n.props.containerId,id:n.props.toastId,theme:n.props.theme,type:n.props.type,data:n.props.data||{},isLoading:n.props.isLoading,icon:n.props.icon,status:e}:{}}const Dn=new Map;let Bf=[];const TE=new Set,l4=n=>TE.forEach(e=>e(n)),yP=()=>Dn.size>0;function vP(n,e){var t;if(e)return!((t=Dn.get(e))==null||!t.isToastActive(n));let i=!1;return Dn.forEach(s=>{s.isToastActive(n)&&(i=!0)}),i}function _P(n,e){AE(n)&&(yP()||Bf.push({content:n,options:e}),Dn.forEach(t=>{t.buildToast(n,e)}))}function $I(n,e){Dn.forEach(t=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===t.id&&t.toggle(n,e==null?void 0:e.id):t.toggle(n,e==null?void 0:e.id)})}function c4(n){const{subscribe:e,getSnapshot:t,setProps:i}=U.useRef(function(r){const o=r.containerId||1;return{subscribe(a){const l=function(h,f,p){let g=1,y=0,_=[],A=[],v=[],E=f;const S=new Map,P=new Set,O=()=>{v=Array.from(S.values()),P.forEach(b=>b())},F=b=>{A=b==null?[]:A.filter(k=>k!==b),O()},I=b=>{const{toastId:k,onOpen:L,updateId:M,children:V}=b.props,D=M==null;b.staleId&&S.delete(b.staleId),S.set(k,b),A=[...A,b.props.toastId].filter(oe=>oe!==b.staleId),O(),p(BI(b,D?"added":"updated")),D&&Ei(L)&&L(U.isValidElement(V)&&V.props)};return{id:h,props:E,observe:b=>(P.add(b),()=>P.delete(b)),toggle:(b,k)=>{S.forEach(L=>{k!=null&&k!==L.props.toastId||Ei(L.toggle)&&L.toggle(b)})},removeToast:F,toasts:S,clearQueue:()=>{y-=_.length,_=[]},buildToast:(b,k)=>{if((ne=>{let{containerId:ae,toastId:$e,updateId:Ke}=ne;const De=ae?ae!==h:h!==1,_e=S.has($e)&&Ke==null;return De||_e})(k))return;const{toastId:L,updateId:M,data:V,staleId:D,delay:oe}=k,Pe=()=>{F(L)},K=M==null;K&&y++;const z={...E,style:E.toastStyle,key:g++,...Object.fromEntries(Object.entries(k).filter(ne=>{let[ae,$e]=ne;return $e!=null})),toastId:L,updateId:M,data:V,closeToast:Pe,isIn:!1,className:Jm(k.className||E.toastClassName),bodyClassName:Jm(k.bodyClassName||E.bodyClassName),progressClassName:Jm(k.progressClassName||E.progressClassName),autoClose:!k.isLoading&&(B=k.autoClose,Q=E.autoClose,B===!1||jf(B)&&B>0?B:Q),deleteToast(){const ne=S.get(L),{onClose:ae,children:$e}=ne.props;Ei(ae)&&ae(U.isValidElement($e)&&$e.props),p(BI(ne,"removed")),S.delete(L),y--,y<0&&(y=0),_.length>0?I(_.shift()):O()}};var B,Q;z.closeButton=E.closeButton,k.closeButton===!1||AE(k.closeButton)?z.closeButton=k.closeButton:k.closeButton===!0&&(z.closeButton=!AE(E.closeButton)||E.closeButton);let ie=b;U.isValidElement(b)&&!ic(b.type)?ie=U.cloneElement(b,{closeToast:Pe,toastProps:z,data:V}):Ei(b)&&(ie=b({closeToast:Pe,toastProps:z,data:V}));const fe={content:ie,props:z,staleId:D};E.limit&&E.limit>0&&y>E.limit&&K?_.push(fe):jf(oe)?setTimeout(()=>{I(fe)},oe):I(fe)},setProps(b){E=b},setToggle:(b,k)=>{S.get(b).toggle=k},isToastActive:b=>A.some(k=>k===b),getSnapshot:()=>v}}(o,r,l4);Dn.set(o,l);const c=l.observe(a);return Bf.forEach(h=>_P(h.content,h.options)),Bf=[],()=>{c(),Dn.delete(o)}},setProps(a){var l;(l=Dn.get(o))==null||l.setProps(a)},getSnapshot(){var a;return(a=Dn.get(o))==null?void 0:a.getSnapshot()}}}(n)).current;i(n);const s=U.useSyncExternalStore(e,t,t);return{getToastToRender:function(r){if(!s)return[];const o=new Map;return n.newestOnTop&&s.reverse(),s.forEach(a=>{const{position:l}=a.props;o.has(l)||o.set(l,[]),o.get(l).push(a)}),Array.from(o,a=>r(a[0],a[1]))},isToastActive:vP,count:s==null?void 0:s.length}}function u4(n){const[e,t]=U.useState(!1),[i,s]=U.useState(!1),r=U.useRef(null),o=U.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:h,closeOnClick:f}=n;var p,g;function y(){t(!0)}function _(){t(!1)}function A(S){const P=r.current;o.canDrag&&P&&(o.didMove=!0,e&&_(),o.delta=n.draggableDirection==="x"?S.clientX-o.start:S.clientY-o.start,o.start!==S.clientX&&(o.canCloseOnClick=!1),P.style.transform=`translate3d(${n.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,P.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function v(){document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",v);const S=r.current;if(o.canDrag&&o.didMove&&S){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),n.closeToast(),void n.collapseAll();S.style.transition="transform 0.2s, opacity 0.2s",S.style.removeProperty("transform"),S.style.removeProperty("opacity")}}(g=Dn.get((p={id:n.toastId,containerId:n.containerId,fn:t}).containerId||1))==null||g.setToggle(p.id,p.fn),U.useEffect(()=>{if(n.pauseOnFocusLoss)return document.hasFocus()||_(),window.addEventListener("focus",y),window.addEventListener("blur",_),()=>{window.removeEventListener("focus",y),window.removeEventListener("blur",_)}},[n.pauseOnFocusLoss]);const E={onPointerDown:function(S){if(n.draggable===!0||n.draggable===S.pointerType){o.didMove=!1,document.addEventListener("pointermove",A),document.addEventListener("pointerup",v);const P=r.current;o.canCloseOnClick=!0,o.canDrag=!0,P.style.transition="none",n.draggableDirection==="x"?(o.start=S.clientX,o.removalDistance=P.offsetWidth*(n.draggablePercent/100)):(o.start=S.clientY,o.removalDistance=P.offsetHeight*(n.draggablePercent===80?1.5*n.draggablePercent:n.draggablePercent)/100)}},onPointerUp:function(S){const{top:P,bottom:O,left:F,right:I}=r.current.getBoundingClientRect();S.nativeEvent.type!=="touchend"&&n.pauseOnHover&&S.clientX>=F&&S.clientX<=I&&S.clientY>=P&&S.clientY<=O?_():y()}};return a&&l&&(E.onMouseEnter=_,n.stacked||(E.onMouseLeave=y)),f&&(E.onClick=S=>{h&&h(S),o.canCloseOnClick&&c()}),{playToast:y,pauseToast:_,isRunning:e,preventExitTransition:i,toastRef:r,eventHandlers:E}}function h4(n){let{delay:e,isRunning:t,closeToast:i,type:s="default",hide:r,className:o,style:a,controlledProgress:l,progress:c,rtl:h,isIn:f,theme:p}=n;const g=r||l&&c===0,y={...a,animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};l&&(y.transform=`scaleX(${c})`);const _=la("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":h}),A=Ei(o)?o({rtl:h,type:s,defaultClassName:_}):la(_,o),v={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{f&&i()}};return Ge.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},Ge.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${p} Toastify__progress-bar--${s}`}),Ge.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:A,style:y,...v}))}let d4=1;const wP=()=>""+d4++;function f4(n){return n&&(ic(n.toastId)||jf(n.toastId))?n.toastId:wP()}function ff(n,e){return _P(n,e),e.toastId}function cv(n,e){return{...e,type:e&&e.type||n,toastId:f4(e)}}function Tm(n){return(e,t)=>ff(e,cv(n,t))}function he(n,e){return ff(n,cv("default",e))}he.loading=(n,e)=>ff(n,cv("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),he.promise=function(n,e,t){let i,{pending:s,error:r,success:o}=e;s&&(i=ic(s)?he.loading(s,t):he.loading(s.render,{...t,...s}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(h,f,p)=>{if(f==null)return void he.dismiss(i);const g={type:h,...a,...t,data:p},y=ic(f)?{render:f}:f;return i?he.update(i,{...g,...y}):he(y.render,{...g,...y}),p},c=Ei(n)?n():n;return c.then(h=>l("success",o,h)).catch(h=>l("error",r,h)),c},he.success=Tm("success"),he.info=Tm("info"),he.error=Tm("error"),he.warning=Tm("warning"),he.warn=he.warning,he.dark=(n,e)=>ff(n,cv("default",{theme:"dark",...e})),he.dismiss=function(n){(function(e){var t;if(yP()){if(e==null||ic(t=e)||jf(t))Dn.forEach(i=>{i.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const i=Dn.get(e.containerId);i?i.removeToast(e.id):Dn.forEach(s=>{s.removeToast(e.id)})}}else Bf=Bf.filter(i=>e!=null&&i.options.toastId!==e)})(n)},he.clearWaitingQueue=function(n){n===void 0&&(n={}),Dn.forEach(e=>{!e.props.limit||n.containerId&&e.id!==n.containerId||e.clearQueue()})},he.isActive=vP,he.update=function(n,e){e===void 0&&(e={});const t=((i,s)=>{var r;let{containerId:o}=s;return(r=Dn.get(o||1))==null?void 0:r.toasts.get(i)})(n,e);if(t){const{props:i,content:s}=t,r={delay:100,...i,...e,toastId:e.toastId||n,updateId:wP()};r.toastId!==n&&(r.staleId=n);const o=r.render||s;delete r.render,ff(o,r)}},he.done=n=>{he.update(n,{progress:1})},he.onChange=function(n){return TE.add(n),()=>{TE.delete(n)}},he.play=n=>$I(!0,n),he.pause=n=>$I(!1,n);const p4=typeof window<"u"?U.useLayoutEffect:U.useEffect,Sm=n=>{let{theme:e,type:t,isLoading:i,...s}=n;return Ge.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...s})},ow={info:function(n){return Ge.createElement(Sm,{...n},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(n){return Ge.createElement(Sm,{...n},Ge.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(n){return Ge.createElement(Sm,{...n},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(n){return Ge.createElement(Sm,{...n},Ge.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Ge.createElement("div",{className:"Toastify__spinner"})}},g4=n=>{const{isRunning:e,preventExitTransition:t,toastRef:i,eventHandlers:s,playToast:r}=u4(n),{closeButton:o,children:a,autoClose:l,onClick:c,type:h,hideProgressBar:f,closeToast:p,transition:g,position:y,className:_,style:A,bodyClassName:v,bodyStyle:E,progressClassName:S,progressStyle:P,updateId:O,role:F,progress:I,rtl:b,toastId:k,deleteToast:L,isIn:M,isLoading:V,closeOnClick:D,theme:oe}=n,Pe=la("Toastify__toast",`Toastify__toast-theme--${oe}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":b},{"Toastify__toast--close-on-click":D}),K=Ei(_)?_({rtl:b,position:y,type:h,defaultClassName:Pe}):la(Pe,_),z=function(fe){let{theme:ne,type:ae,isLoading:$e,icon:Ke}=fe,De=null;const _e={theme:ne,type:ae};return Ke===!1||(Ei(Ke)?De=Ke({..._e,isLoading:$e}):U.isValidElement(Ke)?De=U.cloneElement(Ke,_e):$e?De=ow.spinner():(Cs=>Cs in ow)(ae)&&(De=ow[ae](_e))),De}(n),B=!!I||!l,Q={closeToast:p,type:h,theme:oe};let ie=null;return o===!1||(ie=Ei(o)?o(Q):U.isValidElement(o)?U.cloneElement(o,Q):function(fe){let{closeToast:ne,theme:ae,ariaLabel:$e="close"}=fe;return Ge.createElement("button",{className:`Toastify__close-button Toastify__close-button--${ae}`,type:"button",onClick:Ke=>{Ke.stopPropagation(),ne(Ke)},"aria-label":$e},Ge.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ge.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(Q)),Ge.createElement(g,{isIn:M,done:L,position:y,preventExitTransition:t,nodeRef:i,playToast:r},Ge.createElement("div",{id:k,onClick:c,"data-in":M,className:K,...s,style:A,ref:i},Ge.createElement("div",{...M&&{role:F},className:Ei(v)?v({type:h}):la("Toastify__toast-body",v),style:E},z!=null&&Ge.createElement("div",{className:la("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!V})},z),Ge.createElement("div",null,a)),ie,Ge.createElement(h4,{...O&&!B?{key:`pb-${O}`}:{},rtl:b,theme:oe,delay:l,isRunning:e,isIn:M,closeToast:p,hide:f,type:h,style:P,className:S,controlledProgress:B,progress:I||0})))},A_=function(n,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${n}-enter`,exit:`Toastify--animate Toastify__${n}-exit`,appendPosition:e}},EP=E_(A_("bounce",!0));E_(A_("slide",!0));E_(A_("zoom"));const m4=E_(A_("flip")),y4={position:"top-right",transition:EP,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function v4(n){let e={...y4,...n};const t=n.stacked,[i,s]=U.useState(!0),r=U.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=c4(e),{className:c,style:h,rtl:f,containerId:p}=e;function g(_){const A=la("Toastify__toast-container",`Toastify__toast-container--${_}`,{"Toastify__toast-container--rtl":f});return Ei(c)?c({position:_,rtl:f,defaultClassName:A}):la(A,Jm(c))}function y(){t&&(s(!0),he.play())}return p4(()=>{if(t){var _;const A=r.current.querySelectorAll('[data-in="true"]'),v=12,E=(_=e.position)==null?void 0:_.includes("top");let S=0,P=0;Array.from(A).reverse().forEach((O,F)=>{const I=O;I.classList.add("Toastify__toast--stacked"),F>0&&(I.dataset.collapsed=`${i}`),I.dataset.pos||(I.dataset.pos=E?"top":"bot");const b=S*(i?.2:1)+(i?0:v*F);I.style.setProperty("--y",`${E?b:-1*b}px`),I.style.setProperty("--g",`${v}`),I.style.setProperty("--s",""+(1-(i?P:0))),S+=I.offsetHeight,P+=.025})}},[i,l,t]),Ge.createElement("div",{ref:r,className:"Toastify",id:p,onMouseEnter:()=>{t&&(s(!1),he.pause())},onMouseLeave:y},o((_,A)=>{const v=A.length?{...h}:{...h,pointerEvents:"none"};return Ge.createElement("div",{className:g(_),style:v,key:`container-${_}`},A.map(E=>{let{content:S,props:P}=E;return Ge.createElement(g4,{...P,stacked:t,collapseAll:y,isIn:a(P.toastId,P.containerId),style:P.style,key:`toast-${P.key}`},S)}))}))}var AP={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function s(l,c,h){this.fn=l,this.context=c,this.once=h||!1}function r(l,c,h,f,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new s(h,f||l,p),y=t?t+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],g]:l._events[y].push(g):(l._events[y]=g,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new i:delete l._events[c]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],h,f;if(this._eventsCount===0)return c;for(f in h=this._events)e.call(h,f)&&c.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(h)):c},a.prototype.listeners=function(c){var h=t?t+c:c,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,g=f.length,y=new Array(g);p<g;p++)y[p]=f[p].fn;return y},a.prototype.listenerCount=function(c){var h=t?t+c:c,f=this._events[h];return f?f.fn?1:f.length:0},a.prototype.emit=function(c,h,f,p,g,y){var _=t?t+c:c;if(!this._events[_])return!1;var A=this._events[_],v=arguments.length,E,S;if(A.fn){switch(A.once&&this.removeListener(c,A.fn,void 0,!0),v){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,h),!0;case 3:return A.fn.call(A.context,h,f),!0;case 4:return A.fn.call(A.context,h,f,p),!0;case 5:return A.fn.call(A.context,h,f,p,g),!0;case 6:return A.fn.call(A.context,h,f,p,g,y),!0}for(S=1,E=new Array(v-1);S<v;S++)E[S-1]=arguments[S];A.fn.apply(A.context,E)}else{var P=A.length,O;for(S=0;S<P;S++)switch(A[S].once&&this.removeListener(c,A[S].fn,void 0,!0),v){case 1:A[S].fn.call(A[S].context);break;case 2:A[S].fn.call(A[S].context,h);break;case 3:A[S].fn.call(A[S].context,h,f);break;case 4:A[S].fn.call(A[S].context,h,f,p);break;default:if(!E)for(O=1,E=new Array(v-1);O<v;O++)E[O-1]=arguments[O];A[S].fn.apply(A[S].context,E)}}return!0},a.prototype.on=function(c,h,f){return r(this,c,h,f,!1)},a.prototype.once=function(c,h,f){return r(this,c,h,f,!0)},a.prototype.removeListener=function(c,h,f,p){var g=t?t+c:c;if(!this._events[g])return this;if(!h)return o(this,g),this;var y=this._events[g];if(y.fn)y.fn===h&&(!p||y.once)&&(!f||y.context===f)&&o(this,g);else{for(var _=0,A=[],v=y.length;_<v;_++)(y[_].fn!==h||p&&!y[_].once||f&&y[_].context!==f)&&A.push(y[_]);A.length?this._events[g]=A.length===1?A[0]:A:o(this,g)}return this},a.prototype.removeAllListeners=function(c){var h;return c?(h=t?t+c:c,this._events[h]&&o(this,h)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(AP);var _4=AP.exports;const w4=uT(_4),Kr=new w4,$f=(n,e)=>{n&&(console.log("Im emitting this "+n),Kr.emit("loader",{message:e,id:n}))},Mh=n=>{if(n)return Kr.emit("hide-loader",n)};var zI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},E4=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[t++];e[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const r=n[t++],o=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},SP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,h=r>>2,f=(r&3)<<4|a>>4;let p=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(p=64)),i.push(t[h],t[f],t[p],t[g])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(TP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):E4(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,r==null||a==null||c==null||f==null)throw new A4;const p=r<<2|a>>4;if(i.push(p),c!==64){const g=a<<4&240|c>>2;if(i.push(g),f!==64){const y=c<<6&192|f;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class A4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const T4=function(n){const e=TP(n);return SP.encodeByteArray(e,!0)},uv=function(n){return T4(n).replace(/\./g,"")},bP=function(n){try{return SP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b4=()=>S4().__FIREBASE_DEFAULTS__,I4=()=>{if(typeof process>"u"||typeof zI>"u")return;const n=zI.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},C4=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&bP(n[1]);return e&&JSON.parse(e)},T_=()=>{try{return b4()||I4()||C4()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},IP=n=>{var e,t;return(t=(e=T_())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},CP=n=>{const e=IP(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},RP=()=>{var n;return(n=T_())===null||n===void 0?void 0:n.config},kP=n=>{var e;return(e=T_())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n);return[uv(JSON.stringify(t)),uv(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function k4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bn())}function x4(){var n;const e=(n=T_())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function P4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function N4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function L4(){const n=bn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function D4(){return!x4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function NP(){try{return typeof indexedDB=="object"}catch{return!1}}function LP(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var r;e(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}function M4(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4="FirebaseError";class Xi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=O4,Object.setPrototypeOf(this,Xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sc.prototype.create)}}class Sc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?F4(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Xi(s,a,i)}}function F4(n,e){return n.replace(V4,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const V4=/\{\$([^}]+)}/g;function U4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Oh(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const r=n[s],o=e[s];if(HI(r)&&HI(o)){if(!Oh(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function HI(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Md(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,r]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function Od(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function j4(n,e){const t=new B4(n,e);return t.subscribe.bind(t)}class B4{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");$4(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=aw),s.error===void 0&&(s.error=aw),s.complete===void 0&&(s.complete=aw);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $4(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function aw(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=1e3,H4=2,q4=4*60*60*1e3,W4=.5;function qI(n,e=z4,t=H4){const i=e*Math.pow(t,n),s=Math.round(W4*i*(Math.random()-.5)*2);return Math.min(q4,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){return n&&n._delegate?n._delegate:n}class Ki{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new R4;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(X4(e))try{this.getOrInitializeService({instanceIdentifier:Xa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(e=Xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xa){return this.instances.has(e)}getOptions(e=Xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),r=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:K4(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Xa){return this.component?this.component.multipleInstances?e:Xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K4(n){return n===Xa?void 0:n}function X4(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new G4(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(be||(be={}));const Y4={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},J4=be.INFO,Z4={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},ej=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=Z4[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class S_{constructor(e){this.name=e,this._logLevel=J4,this._logHandler=ej,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const tj=(n,e)=>e.some(t=>n instanceof t);let WI,GI;function nj(){return WI||(WI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ij(){return GI||(GI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DP=new WeakMap,SE=new WeakMap,MP=new WeakMap,lw=new WeakMap,dS=new WeakMap;function sj(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(va(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&DP.set(t,n)}).catch(()=>{}),dS.set(e,n),e}function rj(n){if(SE.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});SE.set(n,e)}let bE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return SE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||MP.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return va(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function oj(n){bE=n(bE)}function aj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(cw(this),e,...t);return MP.set(i,e.sort?e.sort():[e]),va(i)}:ij().includes(n)?function(...e){return n.apply(cw(this),e),va(DP.get(this))}:function(...e){return va(n.apply(cw(this),e))}}function lj(n){return typeof n=="function"?aj(n):(n instanceof IDBTransaction&&rj(n),tj(n,nj())?new Proxy(n,bE):n)}function va(n){if(n instanceof IDBRequest)return sj(n);if(lw.has(n))return lw.get(n);const e=lj(n);return e!==n&&(lw.set(n,e),dS.set(e,n)),e}const cw=n=>dS.get(n);function OP(n,e,{blocked:t,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,e),a=va(o);return i&&o.addEventListener("upgradeneeded",l=>{i(va(o.result),l.oldVersion,l.newVersion,va(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const cj=["get","getKey","getAll","getAllKeys","count"],uj=["put","add","delete","clear"],uw=new Map;function KI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(uw.get(e))return uw.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=uj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||cj.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return uw.set(e,r),r}oj(n=>({...n,get:(e,t,i)=>KI(e,t)||n.get(e,t,i),has:(e,t)=>!!KI(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dj(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function dj(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const IE="@firebase/app",XI="0.10.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co=new S_("@firebase/app"),fj="@firebase/app-compat",pj="@firebase/analytics-compat",gj="@firebase/analytics",mj="@firebase/app-check-compat",yj="@firebase/app-check",vj="@firebase/auth",_j="@firebase/auth-compat",wj="@firebase/database",Ej="@firebase/data-connect",Aj="@firebase/database-compat",Tj="@firebase/functions",Sj="@firebase/functions-compat",bj="@firebase/installations",Ij="@firebase/installations-compat",Cj="@firebase/messaging",Rj="@firebase/messaging-compat",kj="@firebase/performance",xj="@firebase/performance-compat",Pj="@firebase/remote-config",Nj="@firebase/remote-config-compat",Lj="@firebase/storage",Dj="@firebase/storage-compat",Mj="@firebase/firestore",Oj="@firebase/vertexai",Fj="@firebase/firestore-compat",Vj="firebase",Uj="11.0.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="[DEFAULT]",jj={[IE]:"fire-core",[fj]:"fire-core-compat",[gj]:"fire-analytics",[pj]:"fire-analytics-compat",[yj]:"fire-app-check",[mj]:"fire-app-check-compat",[vj]:"fire-auth",[_j]:"fire-auth-compat",[wj]:"fire-rtdb",[Ej]:"fire-data-connect",[Aj]:"fire-rtdb-compat",[Tj]:"fire-fn",[Sj]:"fire-fn-compat",[bj]:"fire-iid",[Ij]:"fire-iid-compat",[Cj]:"fire-fcm",[Rj]:"fire-fcm-compat",[kj]:"fire-perf",[xj]:"fire-perf-compat",[Pj]:"fire-rc",[Nj]:"fire-rc-compat",[Lj]:"fire-gcs",[Dj]:"fire-gcs-compat",[Mj]:"fire-fst",[Fj]:"fire-fst-compat",[Oj]:"fire-vertex","fire-js":"fire-js",[Vj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv=new Map,Bj=new Map,RE=new Map;function QI(n,e){try{n.container.addComponent(e)}catch(t){co.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ts(n){const e=n.name;if(RE.has(e))return co.debug(`There were multiple attempts to register component ${e}.`),!1;RE.set(e,n);for(const t of hv.values())QI(t,n);for(const t of Bj.values())QI(t,n);return!0}function Fa(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Js(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_a=new Sc("app","Firebase",$j);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ki("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _a.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=Uj;function FP(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:CE,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw _a.create("bad-app-name",{appName:String(s)});if(t||(t=RP()),!t)throw _a.create("no-options");const r=hv.get(s);if(r){if(Oh(t,r.options)&&Oh(i,r.config))return r;throw _a.create("duplicate-app",{appName:s})}const o=new Q4(s);for(const l of RE.values())o.addComponent(l);const a=new zj(t,i,o);return hv.set(s,a),a}function b_(n=CE){const e=hv.get(n);if(!e&&n===CE&&RP())return FP();if(!e)throw _a.create("no-app",{appName:n});return e}function ii(n,e,t){var i;let s=(i=jj[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),co.warn(a.join(" "));return}Ts(new Ki(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj="firebase-heartbeat-database",qj=1,zf="firebase-heartbeat-store";let hw=null;function VP(){return hw||(hw=OP(Hj,qj,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zf)}catch(t){console.warn(t)}}}}).catch(n=>{throw _a.create("idb-open",{originalErrorMessage:n.message})})),hw}async function Wj(n){try{const t=(await VP()).transaction(zf),i=await t.objectStore(zf).get(UP(n));return await t.done,i}catch(e){if(e instanceof Xi)co.warn(e.message);else{const t=_a.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});co.warn(t.message)}}}async function YI(n,e){try{const i=(await VP()).transaction(zf,"readwrite");await i.objectStore(zf).put(e,UP(n)),await i.done}catch(t){if(t instanceof Xi)co.warn(t.message);else{const i=_a.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});co.warn(i.message)}}}function UP(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj=1024,Kj=30*24*60*60*1e3;class Xj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Yj(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=JI();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Kj}),this._storage.overwrite(this._heartbeatsCache))}catch(i){co.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=JI(),{heartbeatsToSend:i,unsentEntries:s}=Qj(this._heartbeatsCache.heartbeats),r=uv(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return co.warn(t),""}}}function JI(){return new Date().toISOString().substring(0,10)}function Qj(n,e=Gj){const t=[];let i=n.slice();for(const s of n){const r=t.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),ZI(t)>e){r.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),ZI(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Yj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NP()?LP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Wj(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return YI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return YI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function ZI(n){return uv(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jj(n){Ts(new Ki("platform-logger",e=>new hj(e),"PRIVATE")),Ts(new Ki("heartbeat",e=>new Xj(e),"PRIVATE")),ii(IE,XI,n),ii(IE,XI,"esm2017"),ii("fire-js","")}Jj("");function fS(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function jP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Zj=jP,BP=new Sc("auth","Firebase",jP());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv=new S_("@firebase/auth");function e3(n,...e){dv.logLevel<=be.WARN&&dv.warn(`Auth (${bc}): ${n}`,...e)}function Zm(n,...e){dv.logLevel<=be.ERROR&&dv.error(`Auth (${bc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(n,...e){throw pS(n,...e)}function tr(n,...e){return pS(n,...e)}function $P(n,e,t){const i=Object.assign(Object.assign({},Zj()),{[e]:t});return new Sc("auth","Firebase",i).create(e,{appName:n.name})}function eo(n){return $P(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pS(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return BP.create(n,...e)}function ue(n,e,...t){if(!n)throw pS(e,...t)}function Xr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Zm(e),new Error(e)}function uo(n,e){n||Xr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function t3(){return eC()==="http:"||eC()==="https:"}function eC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(t3()||PP()||"connection"in navigator)?navigator.onLine:!0}function i3(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,t){this.shortDelay=e,this.longDelay=t,uo(t>e,"Short delay should be less than long delay!"),this.isMobile=k4()||N4()}get(){return n3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gS(n,e){uo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new Ig(3e4,6e4);function Va(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ua(n,e,t,i,s={}){return HP(n,s,async()=>{let r={},o={};i&&(e==="GET"?o=i:r={body:JSON.stringify(i)});const a=bg(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},r);return P4()||(c.referrerPolicy="no-referrer"),zP.fetch()(qP(n,n.config.apiHost,t,a),c)})}async function HP(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},s3),e);try{const s=new a3(n),r=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw bm(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw bm(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw bm(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw bm(n,"user-disabled",o);const h=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw $P(n,h,c);Ss(n,h)}}catch(s){if(s instanceof Xi)throw s;Ss(n,"network-request-failed",{message:String(s)})}}async function Cg(n,e,t,i,s={}){const r=await Ua(n,e,t,i,s);return"mfaPendingCredential"in r&&Ss(n,"multi-factor-auth-required",{_serverResponse:r}),r}function qP(n,e,t,i){const s=`${e}${t}?${i}`;return n.config.emulator?gS(n.config,s):`${n.config.apiScheme}://${s}`}function o3(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(tr(this.auth,"network-request-failed")),r3.get())})}}function bm(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=tr(n,e,i);return s.customData._tokenResponse=t,s}function tC(n){return n!==void 0&&n.enterprise!==void 0}class l3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return o3(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function c3(n,e){return Ua(n,"GET","/v2/recaptchaConfig",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u3(n,e){return Ua(n,"POST","/v1/accounts:delete",e)}async function WP(n,e){return Ua(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function h3(n,e=!1){const t=yt(n),i=await t.getIdToken(e),s=mS(i);ue(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:pf(dw(s.auth_time)),issuedAtTime:pf(dw(s.iat)),expirationTime:pf(dw(s.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function dw(n){return Number(n)*1e3}function mS(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Zm("JWT malformed, contained fewer than 3 sections"),null;try{const s=bP(t);return s?JSON.parse(s):(Zm("Failed to decode base64 JWT payload"),null)}catch(s){return Zm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function nC(n){const e=mS(n);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hf(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Xi&&d3(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function d3({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pf(this.lastLoginAt),this.creationTime=pf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fv(n){var e;const t=n.auth,i=await n.getIdToken(),s=await Hf(n,WP(t,{idToken:i}));ue(s==null?void 0:s.users.length,t,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?GP(r.providerUserInfo):[],a=g3(n.providerData,o),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new xE(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function p3(n){const e=yt(n);await fv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function g3(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function GP(n){return n.map(e=>{var{providerId:t}=e,i=fS(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m3(n,e){const t=await HP(n,{},async()=>{const i=bg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=qP(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",zP.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function y3(n,e){return Ua(n,"POST","/v2/accounts:revokeToken",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const t=nC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:r}=await m3(e,t);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:r}=t,o=new vu;return i&&(ue(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),s&&(ue(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(ue(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vu,this.toJSON())}_performRefresh(){return Xr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(n,e){ue(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Qr{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,r=fS(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new f3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new xE(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Hf(this,this.stsTokenManager.getToken(this.auth,e));return ue(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return h3(this,e)}reload(){return p3(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Qr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await fv(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Js(this.auth.app))return Promise.reject(eo(this.auth));const e=await this.getIdToken();return await Hf(this,u3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,r,o,a,l,c,h;const f=(i=t.displayName)!==null&&i!==void 0?i:void 0,p=(s=t.email)!==null&&s!==void 0?s:void 0,g=(r=t.phoneNumber)!==null&&r!==void 0?r:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,_=(a=t.tenantId)!==null&&a!==void 0?a:void 0,A=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=t.createdAt)!==null&&c!==void 0?c:void 0,E=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:P,isAnonymous:O,providerData:F,stsTokenManager:I}=t;ue(S&&I,e,"internal-error");const b=vu.fromJSON(this.name,I);ue(typeof S=="string",e,"internal-error"),Eo(f,e.name),Eo(p,e.name),ue(typeof P=="boolean",e,"internal-error"),ue(typeof O=="boolean",e,"internal-error"),Eo(g,e.name),Eo(y,e.name),Eo(_,e.name),Eo(A,e.name),Eo(v,e.name),Eo(E,e.name);const k=new Qr({uid:S,auth:e,email:p,emailVerified:P,displayName:f,isAnonymous:O,photoURL:y,phoneNumber:g,tenantId:_,stsTokenManager:b,createdAt:v,lastLoginAt:E});return F&&Array.isArray(F)&&(k.providerData=F.map(L=>Object.assign({},L))),A&&(k._redirectEventId=A),k}static async _fromIdTokenResponse(e,t,i=!1){const s=new vu;s.updateFromServerResponse(t);const r=new Qr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await fv(r),r}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];ue(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?GP(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(r!=null&&r.length),a=new vu;a.updateFromIdToken(i);const l=new Qr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new xE(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(r!=null&&r.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=new Map;function Yr(n){uo(n instanceof Function,"Expected a class definition");let e=iC.get(n);return e?(uo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,iC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}KP.type="NONE";const sC=KP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(n,e,t){return`firebase:${n}:${e}:${t}`}class _u{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=ey(this.userKey,s.apiKey,r),this.fullPersistenceKey=ey("persistence",s.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Qr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new _u(Yr(sC),e,i);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=s[0]||Yr(sC);const o=ey(i,e.config.apiKey,e.name);let a=null;for(const c of t)try{const h=await c._get(o);if(h){const f=Qr._fromJSON(e,h);c!==r&&(a=f),r=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new _u(r,e,i):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new _u(r,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(XP(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eN(e))return"Blackberry";if(tN(e))return"Webos";if(QP(e))return"Safari";if((e.includes("chrome/")||YP(e))&&!e.includes("edge/"))return"Chrome";if(ZP(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function XP(n=bn()){return/firefox\//i.test(n)}function QP(n=bn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function YP(n=bn()){return/crios\//i.test(n)}function JP(n=bn()){return/iemobile/i.test(n)}function ZP(n=bn()){return/android/i.test(n)}function eN(n=bn()){return/blackberry/i.test(n)}function tN(n=bn()){return/webos/i.test(n)}function yS(n=bn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function v3(n=bn()){var e;return yS(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _3(){return L4()&&document.documentMode===10}function nN(n=bn()){return yS(n)||ZP(n)||tN(n)||eN(n)||/windows phone/i.test(n)||JP(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(n,e=[]){let t;switch(n){case"Browser":t=rC(bn());break;case"Worker":t=`${rC(bn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bc}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E3(n,e={}){return Ua(n,"GET","/v2/passwordPolicy",Va(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=6;class T3{constructor(e){var t,i,s,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:A3,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,r,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsUppercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oC(this),this.idTokenSubscription=new oC(this),this.beforeStateQueue=new w3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yr(t)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await _u.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await WP(this,{idToken:e}),i=await Qr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Js(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fv(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=i3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Js(this.app))return Promise.reject(eo(this));const t=e?yt(e):null;return t&&ue(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Js(this.app)?Promise.reject(eo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Js(this.app)?Promise.reject(eo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await E3(this),t=new T3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Sc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await y3(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yr(e)||this._popupRedirectResolver;ue(t,this,"argument-error"),this.redirectPersistenceManager=await _u.create(this,[Yr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&e3(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Ic(n){return yt(n)}class oC{constructor(e){this.auth=e,this.observer=null,this.addObserver=j4(t=>this.observer=t)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function b3(n){I_=n}function sN(n){return I_.loadJS(n)}function I3(){return I_.recaptchaEnterpriseScript}function C3(){return I_.gapiScript}function R3(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class k3{constructor(){this.enterprise=new x3}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class x3{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const P3="recaptcha-enterprise",rN="NO_RECAPTCHA";class N3{constructor(e){this.type=P3,this.auth=Ic(e)}async verify(e="verify",t=!1){async function i(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{c3(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new l3(l);return r.tenantId==null?r._agentRecaptchaConfig=c:r._tenantRecaptchaConfigs[r.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(r,o,a){const l=window.grecaptcha;tC(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(c=>{o(c)}).catch(()=>{o(rN)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new k3().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{i(this.auth).then(a=>{if(!t&&tC(window.grecaptcha))s(a,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=I3();l.length!==0&&(l+=a),sN(l).then(()=>{s(a,r,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function aC(n,e,t,i=!1,s=!1){const r=new N3(n);let o;if(s)o=rN;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function PE(n,e,t,i,s){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await aC(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await aC(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(n,e){const t=Fa(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),r=t.getOptions();if(Oh(r,e??{}))return s;Ss(s,"already-initialized")}return t.initialize({options:e})}function D3(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Yr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function M3(n,e,t){const i=Ic(n);ue(i._canInitEmulator,i,"emulator-config-failed"),ue(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,r=oN(e),{host:o,port:a}=O3(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${r}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),F3()}function oN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function O3(n){const e=oN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:lC(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:lC(o)}}}function lC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function F3(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xr("not implemented")}_getIdTokenResponse(e){return Xr("not implemented")}_linkToIdToken(e,t){return Xr("not implemented")}_getReauthenticationResolver(e){return Xr("not implemented")}}async function V3(n,e){return Ua(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U3(n,e){return Cg(n,"POST","/v1/accounts:signInWithPassword",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j3(n,e){return Cg(n,"POST","/v1/accounts:signInWithEmailLink",Va(n,e))}async function B3(n,e){return Cg(n,"POST","/v1/accounts:signInWithEmailLink",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf extends vS{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new qf(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new qf(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return PE(e,t,"signInWithPassword",U3);case"emailLink":return j3(e,{email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return PE(e,i,"signUpPassword",V3);case"emailLink":return B3(e,{idToken:t,email:this._email,oobCode:this._password});default:Ss(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wu(n,e){return Cg(n,"POST","/v1/accounts:signInWithIdp",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="http://localhost";class hc extends vS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ss("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,r=fS(t,["providerId","signInMethod"]);if(!i||!s)return null;const o=new hc(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return wu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,wu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wu(e,t)}buildRequest(){const e={requestUri:$3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=bg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z3(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function H3(n){const e=Md(Od(n)).link,t=e?Md(Od(e)).deep_link_id:null,i=Md(Od(n)).deep_link_id;return(i?Md(Od(i)).link:null)||i||t||e||n}class _S{constructor(e){var t,i,s,r,o,a;const l=Md(Od(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(i=l.oobCode)!==null&&i!==void 0?i:null,f=z3((s=l.mode)!==null&&s!==void 0?s:null);ue(c&&h&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=h,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=H3(e);try{return new _S(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(){this.providerId=Jh.PROVIDER_ID}static credential(e,t){return qf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=_S.parseLink(t);return ue(i,"argument-error"),qf._fromEmailAndCode(e,i.code,i.tenantId)}}Jh.PROVIDER_ID="password";Jh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg extends aN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends Rg{constructor(){super("facebook.com")}static credential(e){return hc._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Co.credential(e.oauthAccessToken)}catch{return null}}}Co.FACEBOOK_SIGN_IN_METHOD="facebook.com";Co.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends Rg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hc._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ro.credentialFromTaggedObject(e)}static credentialFromError(e){return Ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ro.credential(t,i)}catch{return null}}}Ro.GOOGLE_SIGN_IN_METHOD="google.com";Ro.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends Rg{constructor(){super("github.com")}static credential(e){return hc._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ko.credential(e.oauthAccessToken)}catch{return null}}}ko.GITHUB_SIGN_IN_METHOD="github.com";ko.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends Rg{constructor(){super("twitter.com")}static credential(e,t){return hc._fromParams({providerId:xo.PROVIDER_ID,signInMethod:xo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xo.credentialFromTaggedObject(e)}static credentialFromError(e){return xo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return xo.credential(t,i)}catch{return null}}}xo.TWITTER_SIGN_IN_METHOD="twitter.com";xo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q3(n,e){return Cg(n,"POST","/v1/accounts:signUp",Va(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const r=await Qr._fromIdTokenResponse(e,i,s),o=cC(i);return new dc({user:r,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=cC(i);return new dc({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function cC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv extends Xi{constructor(e,t,i,s){var r;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,pv.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new pv(e,t,i,s)}}function lN(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?pv._fromErrorAndOperation(n,r,e,i):r})}async function W3(n,e,t=!1){const i=await Hf(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return dc._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G3(n,e,t=!1){const{auth:i}=n;if(Js(i.app))return Promise.reject(eo(i));const s="reauthenticate";try{const r=await Hf(n,lN(i,s,e,n),t);ue(r.idToken,i,"internal-error");const o=mS(r.idToken);ue(o,i,"internal-error");const{sub:a}=o;return ue(n.uid===a,i,"user-mismatch"),dc._forOperation(n,s,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Ss(i,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cN(n,e,t=!1){if(Js(n.app))return Promise.reject(eo(n));const i="signIn",s=await lN(n,i,e),r=await dc._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(r.user),r}async function K3(n,e){return cN(Ic(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uN(n){const e=Ic(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function X3(n,e,t){if(Js(n.app))return Promise.reject(eo(n));const i=Ic(n),o=await PE(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",q3).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&uN(n),l}),a=await dc._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function Q3(n,e,t){return Js(n.app)?Promise.reject(eo(n)):K3(yt(n),Jh.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&uN(n),i})}function Y3(n,e,t,i){return yt(n).onIdTokenChanged(e,t,i)}function J3(n,e,t){return yt(n).beforeAuthStateChanged(e,t)}function Z3(n,e,t,i){return yt(n).onAuthStateChanged(e,t,i)}function eB(n){return yt(n).signOut()}const gv="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gv,"1"),this.storage.removeItem(gv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=1e3,nB=10;class dN extends hN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);_3()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,nB):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},tB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dN.type="LOCAL";const iB=dN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN extends hN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}fN.type="SESSION";const pN=fN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new C_(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:r}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,r)),l=await sB(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}C_.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=wS("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(p.data.response);break;default:clearTimeout(h),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return window}function oB(n){nr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gN(){return typeof nr().WorkerGlobalScope<"u"&&typeof nr().importScripts=="function"}async function aB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function lB(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function cB(){return gN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN="firebaseLocalStorageDb",uB=1,mv="firebaseLocalStorage",yN="fbase_key";class kg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function R_(n,e){return n.transaction([mv],e?"readwrite":"readonly").objectStore(mv)}function hB(){const n=indexedDB.deleteDatabase(mN);return new kg(n).toPromise()}function NE(){const n=indexedDB.open(mN,uB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(mv,{keyPath:yN})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(mv)?e(i):(i.close(),await hB(),e(await NE()))})})}async function uC(n,e,t){const i=R_(n,!0).put({[yN]:e,value:t});return new kg(i).toPromise()}async function dB(n,e){const t=R_(n,!1).get(e),i=await new kg(t).toPromise();return i===void 0?null:i.value}function hC(n,e){const t=R_(n,!0).delete(e);return new kg(t).toPromise()}const fB=800,pB=3;class vN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await NE(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>pB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=C_._getInstance(cB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await aB(),!this.activeServiceWorker)return;this.sender=new rB(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||lB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await NE();return await uC(e,gv,"1"),await hC(e,gv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>uC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>dB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=R_(s,!1).getAll();return new kg(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:r}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vN.type="LOCAL";const gB=vN;new Ig(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(n,e){return e?Yr(e):(ue(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES extends vS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function yB(n){return cN(n.auth,new ES(n),n.bypassAuthState)}function vB(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),G3(t,new ES(n),n.bypassAuthState)}async function _B(n){const{auth:e,user:t}=n;return ue(t,e,"internal-error"),W3(t,new ES(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t,i,s,r=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yB;case"linkViaPopup":case"linkViaRedirect":return _B;case"reauthViaPopup":case"reauthViaRedirect":return vB;default:Ss(this.auth,"internal-error")}}resolve(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB=new Ig(2e3,1e4);class cu extends _N{constructor(e,t,i,s,r){super(e,t,s,r),this.provider=i,this.authWindow=null,this.pollId=null,cu.currentPopupAction&&cu.currentPopupAction.cancel(),cu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){uo(this.filter.length===1,"Popup operations only handle one event");const e=wS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,cu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,wB.get())};e()}}cu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EB="pendingRedirect",ty=new Map;class AB extends _N{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ty.get(this.auth._key());if(!e){try{const i=await TB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ty.set(this.auth._key(),e)}return this.bypassAuthState||ty.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TB(n,e){const t=IB(e),i=bB(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function SB(n,e){ty.set(n._key(),e)}function bB(n){return Yr(n._redirectPersistence)}function IB(n){return ey(EB,n.config.apiKey,n.name)}async function CB(n,e,t=!1){if(Js(n.app))return Promise.reject(eo(n));const i=Ic(n),s=mB(i,e),o=await new AB(i,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RB=10*60*1e3;class kB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!wN(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(tr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RB&&this.cachedEventUids.clear(),this.cachedEventUids.has(dC(e))}saveEventToCache(e){this.cachedEventUids.add(dC(e)),this.lastProcessedEventTime=Date.now()}}function dC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wN({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wN(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PB(n,e={}){return Ua(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,LB=/^https?/;async function DB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await PB(n);for(const t of e)try{if(MB(t))return}catch{}Ss(n,"unauthorized-domain")}function MB(n){const e=kE(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!LB.test(t))return!1;if(NB.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB=new Ig(3e4,6e4);function fC(){const n=nr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function FB(n){return new Promise((e,t)=>{var i,s,r;function o(){fC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fC(),t(tr(n,"network-request-failed"))},timeout:OB.get()})}if(!((s=(i=nr().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((r=nr().gapi)===null||r===void 0)&&r.load)o();else{const a=R3("iframefcb");return nr()[a]=()=>{gapi.load?o():t(tr(n,"network-request-failed"))},sN(`${C3()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw ny=null,e})}let ny=null;function VB(n){return ny=ny||FB(n),ny}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB=new Ig(5e3,15e3),jB="__/auth/iframe",BB="emulator/auth/iframe",$B={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function HB(n){const e=n.config;ue(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?gS(e,BB):`https://${n.config.authDomain}/${jB}`,i={apiKey:e.apiKey,appName:n.name,v:bc},s=zB.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${t}?${bg(i).slice(1)}`}async function qB(n){const e=await VB(n),t=nr().gapi;return ue(t,n,"internal-error"),e.open({where:document.body,url:HB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$B,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=tr(n,"network-request-failed"),a=nr().setTimeout(()=>{r(o)},UB.get());function l(){nr().clearTimeout(a),s(i)}i.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GB=500,KB=600,XB="_blank",QB="http://localhost";class pC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YB(n,e,t,i=GB,s=KB){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},WB),{width:i.toString(),height:s.toString(),top:r,left:o}),c=bn().toLowerCase();t&&(a=YP(c)?XB:t),XP(c)&&(e=e||QB,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(v3(c)&&a!=="_self")return JB(e||"",a),new pC(null);const f=window.open(e||"",a,h);ue(f,n,"popup-blocked");try{f.focus()}catch{}return new pC(f)}function JB(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZB="__/auth/handler",e$="emulator/auth/handler",t$=encodeURIComponent("fac");async function gC(n,e,t,i,s,r){ue(n.config.authDomain,n,"auth-domain-config-required"),ue(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:bc,eventId:s};if(e instanceof aN){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",U4(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Rg){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${t$}=${encodeURIComponent(l)}`:"";return`${n$(n)}?${bg(a).slice(1)}${c}`}function n$({config:n}){return n.emulator?gS(n,e$):`https://${n.authDomain}/${ZB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw="webStorageSupport";class i${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pN,this._completeRedirectFn=CB,this._overrideRedirectResult=SB}async _openPopup(e,t,i,s){var r;uo((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await gC(e,t,i,kE(),s);return YB(e,o,wS())}async _openRedirect(e,t,i,s){await this._originValidation(e);const r=await gC(e,t,i,kE(),s);return oB(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:r}=this.eventManagers[t];return s?Promise.resolve(s):(uo(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await qB(e),i=new kB(e);return t.register("authEvent",s=>(ue(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(fw,{type:fw},s=>{var r;const o=(r=s==null?void 0:s[0])===null||r===void 0?void 0:r[fw];o!==void 0&&t(!!o),Ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=DB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nN()||QP()||yS()}}const s$=i$;var mC="@firebase/auth",yC="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o$(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function a$(n){Ts(new Ki("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;ue(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iN(n)},c=new S3(i,s,r,l);return D3(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ts(new Ki("auth-internal",e=>{const t=Ic(e.getProvider("auth").getImmediate());return(i=>new r$(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ii(mC,yC,o$(n)),ii(mC,yC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l$=5*60,c$=kP("authIdTokenMaxAge")||l$;let vC=null;const u$=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>c$)return;const s=t==null?void 0:t.token;vC!==s&&(vC=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function h$(n=b_()){const e=Fa(n,"auth");if(e.isInitialized())return e.getImmediate();const t=L3(n,{popupRedirectResolver:s$,persistence:[gB,iB,pN]}),i=kP("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=u$(r.toString());J3(t,o,()=>o(t.currentUser)),Y3(t,a=>o(a))}}const s=IP("auth");return s&&M3(t,`http://${s}`),t}function d$(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}b3({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const r=tr("internal-error");r.customData=s,t(r)},i.type="text/javascript",i.charset="UTF-8",d$().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});a$("Browser");var f$="firebase",p$="11.0.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ii(f$,p$,"app");const EN="@firebase/installations",AS="0.6.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=1e4,TN=`w:${AS}`,SN="FIS_v2",g$="https://firebaseinstallations.googleapis.com/v1",m$=60*60*1e3,y$="installations",v$="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _$={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},fc=new Sc(y$,v$,_$);function bN(n){return n instanceof Xi&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN({projectId:n}){return`${g$}/projects/${n}/installations`}function CN(n){return{token:n.token,requestStatus:2,expiresIn:E$(n.expiresIn),creationTime:Date.now()}}async function RN(n,e){const i=(await e.json()).error;return fc.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function kN({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function w$(n,{refreshToken:e}){const t=kN(n);return t.append("Authorization",A$(e)),t}async function xN(n){const e=await n();return e.status>=500&&e.status<600?n():e}function E$(n){return Number(n.replace("s","000"))}function A$(n){return`${SN} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T$({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=IN(n),s=kN(n),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:t,authVersion:SN,appId:n.appId,sdkVersion:TN},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await xN(()=>fetch(i,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:CN(c.authToken)}}else throw await RN("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S$(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b$=/^[cdef][\w-]{21}$/,LE="";function I$(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=C$(n);return b$.test(t)?t:LE}catch{return LE}}function C$(n){return S$(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=new Map;function LN(n,e){const t=k_(n);DN(t,e),R$(t,e)}function DN(n,e){const t=NN.get(n);if(t)for(const i of t)i(e)}function R$(n,e){const t=k$();t&&t.postMessage({key:n,fid:e}),x$()}let sl=null;function k$(){return!sl&&"BroadcastChannel"in self&&(sl=new BroadcastChannel("[Firebase] FID Change"),sl.onmessage=n=>{DN(n.data.key,n.data.fid)}),sl}function x$(){NN.size===0&&sl&&(sl.close(),sl=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P$="firebase-installations-database",N$=1,pc="firebase-installations-store";let pw=null;function TS(){return pw||(pw=OP(P$,N$,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(pc)}}})),pw}async function yv(n,e){const t=k_(n),s=(await TS()).transaction(pc,"readwrite"),r=s.objectStore(pc),o=await r.get(t);return await r.put(e,t),await s.done,(!o||o.fid!==e.fid)&&LN(n,e.fid),e}async function MN(n){const e=k_(n),i=(await TS()).transaction(pc,"readwrite");await i.objectStore(pc).delete(e),await i.done}async function x_(n,e){const t=k_(n),s=(await TS()).transaction(pc,"readwrite"),r=s.objectStore(pc),o=await r.get(t),a=e(o);return a===void 0?await r.delete(t):await r.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&LN(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SS(n){let e;const t=await x_(n.appConfig,i=>{const s=L$(i),r=D$(n,s);return e=r.registrationPromise,r.installationEntry});return t.fid===LE?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function L$(n){const e=n||{fid:I$(),registrationStatus:0};return ON(e)}function D$(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(fc.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=M$(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:O$(n)}:{installationEntry:e}}async function M$(n,e){try{const t=await T$(n,e);return yv(n.appConfig,t)}catch(t){throw bN(t)&&t.customData.serverCode===409?await MN(n.appConfig):await yv(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function O$(n){let e=await _C(n.appConfig);for(;e.registrationStatus===1;)await PN(100),e=await _C(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await SS(n);return i||t}return e}function _C(n){return x_(n,e=>{if(!e)throw fc.create("installation-not-found");return ON(e)})}function ON(n){return F$(n)?{fid:n.fid,registrationStatus:0}:n}function F$(n){return n.registrationStatus===1&&n.registrationTime+AN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V$({appConfig:n,heartbeatServiceProvider:e},t){const i=U$(n,t),s=w$(n,t),r=e.getImmediate({optional:!0});if(r){const c=await r.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:TN,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await xN(()=>fetch(i,a));if(l.ok){const c=await l.json();return CN(c)}else throw await RN("Generate Auth Token",l)}function U$(n,{fid:e}){return`${IN(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bS(n,e=!1){let t;const i=await x_(n.appConfig,r=>{if(!FN(r))throw fc.create("not-registered");const o=r.authToken;if(!e&&$$(o))return r;if(o.requestStatus===1)return t=j$(n,e),r;{if(!navigator.onLine)throw fc.create("app-offline");const a=H$(r);return t=B$(n,a),a}});return t?await t:i.authToken}async function j$(n,e){let t=await wC(n.appConfig);for(;t.authToken.requestStatus===1;)await PN(100),t=await wC(n.appConfig);const i=t.authToken;return i.requestStatus===0?bS(n,e):i}function wC(n){return x_(n,e=>{if(!FN(e))throw fc.create("not-registered");const t=e.authToken;return q$(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function B$(n,e){try{const t=await V$(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await yv(n.appConfig,i),t}catch(t){if(bN(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await MN(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await yv(n.appConfig,i)}throw t}}function FN(n){return n!==void 0&&n.registrationStatus===2}function $$(n){return n.requestStatus===2&&!z$(n)}function z$(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+m$}function H$(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function q$(n){return n.requestStatus===1&&n.requestTime+AN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W$(n){const e=n,{installationEntry:t,registrationPromise:i}=await SS(e);return i?i.catch(console.error):bS(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G$(n,e=!1){const t=n;return await K$(t),(await bS(t,e)).token}async function K$(n){const{registrationPromise:e}=await SS(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X$(n){if(!n||!n.options)throw gw("App Configuration");if(!n.name)throw gw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw gw(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function gw(n){return fc.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN="installations",Q$="installations-internal",Y$=n=>{const e=n.getProvider("app").getImmediate(),t=X$(e),i=Fa(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},J$=n=>{const e=n.getProvider("app").getImmediate(),t=Fa(e,VN).getImmediate();return{getId:()=>W$(t),getToken:s=>G$(t,s)}};function Z$(){Ts(new Ki(VN,Y$,"PUBLIC")),Ts(new Ki(Q$,J$,"PRIVATE"))}Z$();ii(EN,AS);ii(EN,AS,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv="analytics",ez="firebase_id",tz="origin",nz=60*1e3,iz="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",IS="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new S_("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Si=new Sc("analytics","Analytics",sz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(n){if(!n.startsWith(IS)){const e=Si.create("invalid-gtag-resource",{gtagURL:n});return si.warn(e.message),""}return n}function UN(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function oz(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function az(n,e){const t=oz("firebase-js-sdk-policy",{createScriptURL:rz}),i=document.createElement("script"),s=`${IS}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function lz(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function cz(n,e,t,i,s,r){const o=i[s];try{if(o)await e[o];else{const l=(await UN(t)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){si.error(a)}n("config",s,r)}async function uz(n,e,t,i,s){try{let r=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await UN(t);for(const l of o){const c=a.find(f=>f.measurementId===l),h=c&&e[c.appId];if(h)r.push(h);else{r=[];break}}}r.length===0&&(r=Object.values(e)),await Promise.all(r),n("event",i,s||{})}catch(r){si.error(r)}}function hz(n,e,t,i){async function s(r,...o){try{if(r==="event"){const[a,l]=o;await uz(n,e,t,a,l)}else if(r==="config"){const[a,l]=o;await cz(n,e,t,i,a,l)}else if(r==="consent"){const[a,l]=o;n("consent",a,l)}else if(r==="get"){const[a,l,c]=o;n("get",a,l,c)}else if(r==="set"){const[a]=o;n("set",a)}else n(r,...o)}catch(a){si.error(a)}}return s}function dz(n,e,t,i,s){let r=function(...o){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(r=window[s]),window[s]=hz(r,n,e,t),{gtagCore:r,wrappedGtag:window[s]}}function fz(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(IS)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz=30,gz=1e3;class mz{constructor(e={},t=gz){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const jN=new mz;function yz(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function vz(n){var e;const{appId:t,apiKey:i}=n,s={method:"GET",headers:yz(i)},r=iz.replace("{app-id}",t),o=await fetch(r,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Si.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function _z(n,e=jN,t){const{appId:i,apiKey:s,measurementId:r}=n.options;if(!i)throw Si.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw Si.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Az;return setTimeout(async()=>{a.abort()},nz),BN({appId:i,apiKey:s,measurementId:r},o,a,e)}async function BN(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=jN){var r;const{appId:o,measurementId:a}=n;try{await wz(i,e)}catch(l){if(a)return si.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await vz(n);return s.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!Ez(c)){if(s.deleteThrottleMetadata(o),a)return si.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const h=Number((r=c==null?void 0:c.customData)===null||r===void 0?void 0:r.httpStatus)===503?qI(t,s.intervalMillis,pz):qI(t,s.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:t+1};return s.setThrottleMetadata(o,f),si.debug(`Calling attemptFetch again in ${h} millis`),BN(n,f,i,s)}}function wz(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(r),i(Si.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ez(n){if(!(n instanceof Xi)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Az{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Tz(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const r=await e,o=Object.assign(Object.assign({},i),{send_to:r});n("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sz(){if(NP())try{await LP()}catch(n){return si.warn(Si.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return si.warn(Si.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function bz(n,e,t,i,s,r,o){var a;const l=_z(n);l.then(g=>{t[g.measurementId]=g.appId,n.options.measurementId&&g.measurementId!==n.options.measurementId&&si.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${g.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(g=>si.error(g)),e.push(l);const c=Sz().then(g=>{if(g)return i.getId()}),[h,f]=await Promise.all([l,c]);fz(r)||az(r,h.measurementId),s("js",new Date);const p=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return p[tz]="firebase",p.update=!0,f!=null&&(p[ez]=f),s("config",h.measurementId,p),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(e){this.app=e}_delete(){return delete gf[this.app.options.appId],Promise.resolve()}}let gf={},EC=[];const AC={};let mw="dataLayer",Cz="gtag",TC,$N,SC=!1;function Rz(){const n=[];if(PP()&&n.push("This is a browser extension environment."),M4()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=Si.create("invalid-analytics-context",{errorInfo:e});si.warn(t.message)}}function kz(n,e,t){Rz();const i=n.options.appId;if(!i)throw Si.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)si.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Si.create("no-api-key");if(gf[i]!=null)throw Si.create("already-exists",{id:i});if(!SC){lz(mw);const{wrappedGtag:r,gtagCore:o}=dz(gf,EC,AC,mw,Cz);$N=r,TC=o,SC=!0}return gf[i]=bz(n,EC,AC,e,TC,mw,t),new Iz(n)}function xz(n=b_()){n=yt(n);const e=Fa(n,vv);return e.isInitialized()?e.getImmediate():Pz(n)}function Pz(n,e={}){const t=Fa(n,vv);if(t.isInitialized()){const s=t.getImmediate();if(Oh(e,t.getOptions()))return s;throw Si.create("already-initialized")}return t.initialize({options:e})}function Nz(n,e,t,i){n=yt(n),Tz($N,gf[n.app.options.appId],e,t,i).catch(s=>si.error(s))}const bC="@firebase/analytics",IC="0.10.10";function Lz(){Ts(new Ki(vv,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return kz(i,s,t)},"PUBLIC")),Ts(new Ki("analytics-internal",n,"PRIVATE")),ii(bC,IC),ii(bC,IC,"esm2017");function n(e){try{const t=e.getProvider(vv).getImmediate();return{logEvent:(i,s,r)=>Nz(t,i,s,r)}}catch(t){throw Si.create("interop-component-reg-failed",{reason:t})}}}Lz();var CC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sc,zN;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,b){function k(){}k.prototype=b.prototype,I.D=b.prototype,I.prototype=new k,I.prototype.constructor=I,I.C=function(L,M,V){for(var D=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)D[oe-2]=arguments[oe];return b.prototype[M].apply(L,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,b,k){k||(k=0);var L=Array(16);if(typeof b=="string")for(var M=0;16>M;++M)L[M]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;else for(M=0;16>M;++M)L[M]=b[k++]|b[k++]<<8|b[k++]<<16|b[k++]<<24;b=I.g[0],k=I.g[1],M=I.g[2];var V=I.g[3],D=b+(V^k&(M^V))+L[0]+3614090360&4294967295;b=k+(D<<7&4294967295|D>>>25),D=V+(M^b&(k^M))+L[1]+3905402710&4294967295,V=b+(D<<12&4294967295|D>>>20),D=M+(k^V&(b^k))+L[2]+606105819&4294967295,M=V+(D<<17&4294967295|D>>>15),D=k+(b^M&(V^b))+L[3]+3250441966&4294967295,k=M+(D<<22&4294967295|D>>>10),D=b+(V^k&(M^V))+L[4]+4118548399&4294967295,b=k+(D<<7&4294967295|D>>>25),D=V+(M^b&(k^M))+L[5]+1200080426&4294967295,V=b+(D<<12&4294967295|D>>>20),D=M+(k^V&(b^k))+L[6]+2821735955&4294967295,M=V+(D<<17&4294967295|D>>>15),D=k+(b^M&(V^b))+L[7]+4249261313&4294967295,k=M+(D<<22&4294967295|D>>>10),D=b+(V^k&(M^V))+L[8]+1770035416&4294967295,b=k+(D<<7&4294967295|D>>>25),D=V+(M^b&(k^M))+L[9]+2336552879&4294967295,V=b+(D<<12&4294967295|D>>>20),D=M+(k^V&(b^k))+L[10]+4294925233&4294967295,M=V+(D<<17&4294967295|D>>>15),D=k+(b^M&(V^b))+L[11]+2304563134&4294967295,k=M+(D<<22&4294967295|D>>>10),D=b+(V^k&(M^V))+L[12]+1804603682&4294967295,b=k+(D<<7&4294967295|D>>>25),D=V+(M^b&(k^M))+L[13]+4254626195&4294967295,V=b+(D<<12&4294967295|D>>>20),D=M+(k^V&(b^k))+L[14]+2792965006&4294967295,M=V+(D<<17&4294967295|D>>>15),D=k+(b^M&(V^b))+L[15]+1236535329&4294967295,k=M+(D<<22&4294967295|D>>>10),D=b+(M^V&(k^M))+L[1]+4129170786&4294967295,b=k+(D<<5&4294967295|D>>>27),D=V+(k^M&(b^k))+L[6]+3225465664&4294967295,V=b+(D<<9&4294967295|D>>>23),D=M+(b^k&(V^b))+L[11]+643717713&4294967295,M=V+(D<<14&4294967295|D>>>18),D=k+(V^b&(M^V))+L[0]+3921069994&4294967295,k=M+(D<<20&4294967295|D>>>12),D=b+(M^V&(k^M))+L[5]+3593408605&4294967295,b=k+(D<<5&4294967295|D>>>27),D=V+(k^M&(b^k))+L[10]+38016083&4294967295,V=b+(D<<9&4294967295|D>>>23),D=M+(b^k&(V^b))+L[15]+3634488961&4294967295,M=V+(D<<14&4294967295|D>>>18),D=k+(V^b&(M^V))+L[4]+3889429448&4294967295,k=M+(D<<20&4294967295|D>>>12),D=b+(M^V&(k^M))+L[9]+568446438&4294967295,b=k+(D<<5&4294967295|D>>>27),D=V+(k^M&(b^k))+L[14]+3275163606&4294967295,V=b+(D<<9&4294967295|D>>>23),D=M+(b^k&(V^b))+L[3]+4107603335&4294967295,M=V+(D<<14&4294967295|D>>>18),D=k+(V^b&(M^V))+L[8]+1163531501&4294967295,k=M+(D<<20&4294967295|D>>>12),D=b+(M^V&(k^M))+L[13]+2850285829&4294967295,b=k+(D<<5&4294967295|D>>>27),D=V+(k^M&(b^k))+L[2]+4243563512&4294967295,V=b+(D<<9&4294967295|D>>>23),D=M+(b^k&(V^b))+L[7]+1735328473&4294967295,M=V+(D<<14&4294967295|D>>>18),D=k+(V^b&(M^V))+L[12]+2368359562&4294967295,k=M+(D<<20&4294967295|D>>>12),D=b+(k^M^V)+L[5]+4294588738&4294967295,b=k+(D<<4&4294967295|D>>>28),D=V+(b^k^M)+L[8]+2272392833&4294967295,V=b+(D<<11&4294967295|D>>>21),D=M+(V^b^k)+L[11]+1839030562&4294967295,M=V+(D<<16&4294967295|D>>>16),D=k+(M^V^b)+L[14]+4259657740&4294967295,k=M+(D<<23&4294967295|D>>>9),D=b+(k^M^V)+L[1]+2763975236&4294967295,b=k+(D<<4&4294967295|D>>>28),D=V+(b^k^M)+L[4]+1272893353&4294967295,V=b+(D<<11&4294967295|D>>>21),D=M+(V^b^k)+L[7]+4139469664&4294967295,M=V+(D<<16&4294967295|D>>>16),D=k+(M^V^b)+L[10]+3200236656&4294967295,k=M+(D<<23&4294967295|D>>>9),D=b+(k^M^V)+L[13]+681279174&4294967295,b=k+(D<<4&4294967295|D>>>28),D=V+(b^k^M)+L[0]+3936430074&4294967295,V=b+(D<<11&4294967295|D>>>21),D=M+(V^b^k)+L[3]+3572445317&4294967295,M=V+(D<<16&4294967295|D>>>16),D=k+(M^V^b)+L[6]+76029189&4294967295,k=M+(D<<23&4294967295|D>>>9),D=b+(k^M^V)+L[9]+3654602809&4294967295,b=k+(D<<4&4294967295|D>>>28),D=V+(b^k^M)+L[12]+3873151461&4294967295,V=b+(D<<11&4294967295|D>>>21),D=M+(V^b^k)+L[15]+530742520&4294967295,M=V+(D<<16&4294967295|D>>>16),D=k+(M^V^b)+L[2]+3299628645&4294967295,k=M+(D<<23&4294967295|D>>>9),D=b+(M^(k|~V))+L[0]+4096336452&4294967295,b=k+(D<<6&4294967295|D>>>26),D=V+(k^(b|~M))+L[7]+1126891415&4294967295,V=b+(D<<10&4294967295|D>>>22),D=M+(b^(V|~k))+L[14]+2878612391&4294967295,M=V+(D<<15&4294967295|D>>>17),D=k+(V^(M|~b))+L[5]+4237533241&4294967295,k=M+(D<<21&4294967295|D>>>11),D=b+(M^(k|~V))+L[12]+1700485571&4294967295,b=k+(D<<6&4294967295|D>>>26),D=V+(k^(b|~M))+L[3]+2399980690&4294967295,V=b+(D<<10&4294967295|D>>>22),D=M+(b^(V|~k))+L[10]+4293915773&4294967295,M=V+(D<<15&4294967295|D>>>17),D=k+(V^(M|~b))+L[1]+2240044497&4294967295,k=M+(D<<21&4294967295|D>>>11),D=b+(M^(k|~V))+L[8]+1873313359&4294967295,b=k+(D<<6&4294967295|D>>>26),D=V+(k^(b|~M))+L[15]+4264355552&4294967295,V=b+(D<<10&4294967295|D>>>22),D=M+(b^(V|~k))+L[6]+2734768916&4294967295,M=V+(D<<15&4294967295|D>>>17),D=k+(V^(M|~b))+L[13]+1309151649&4294967295,k=M+(D<<21&4294967295|D>>>11),D=b+(M^(k|~V))+L[4]+4149444226&4294967295,b=k+(D<<6&4294967295|D>>>26),D=V+(k^(b|~M))+L[11]+3174756917&4294967295,V=b+(D<<10&4294967295|D>>>22),D=M+(b^(V|~k))+L[2]+718787259&4294967295,M=V+(D<<15&4294967295|D>>>17),D=k+(V^(M|~b))+L[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(M+(D<<21&4294967295|D>>>11))&4294967295,I.g[2]=I.g[2]+M&4294967295,I.g[3]=I.g[3]+V&4294967295}i.prototype.u=function(I,b){b===void 0&&(b=I.length);for(var k=b-this.blockSize,L=this.B,M=this.h,V=0;V<b;){if(M==0)for(;V<=k;)s(this,I,V),V+=this.blockSize;if(typeof I=="string"){for(;V<b;)if(L[M++]=I.charCodeAt(V++),M==this.blockSize){s(this,L),M=0;break}}else for(;V<b;)if(L[M++]=I[V++],M==this.blockSize){s(this,L),M=0;break}}this.h=M,this.o+=b},i.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;var k=8*this.o;for(b=I.length-8;b<I.length;++b)I[b]=k&255,k/=256;for(this.u(I),I=Array(16),b=k=0;4>b;++b)for(var L=0;32>L;L+=8)I[k++]=this.g[b]>>>L&255;return I};function r(I,b){var k=a;return Object.prototype.hasOwnProperty.call(k,I)?k[I]:k[I]=b(I)}function o(I,b){this.h=b;for(var k=[],L=!0,M=I.length-1;0<=M;M--){var V=I[M]|0;L&&V==b||(k[M]=V,L=!1)}this.g=k}var a={};function l(I){return-128<=I&&128>I?r(I,function(b){return new o([b|0],0>b?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return A(c(-I));for(var b=[],k=1,L=0;I>=k;L++)b[L]=I/k|0,k*=4294967296;return new o(b,0)}function h(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return A(h(I.substring(1),b));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(b,8)),L=f,M=0;M<I.length;M+=8){var V=Math.min(8,I.length-M),D=parseInt(I.substring(M,M+V),b);8>V?(V=c(Math.pow(b,V)),L=L.j(V).add(c(D))):(L=L.j(k),L=L.add(c(D)))}return L}var f=l(0),p=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(_(this))return-A(this).m();for(var I=0,b=1,k=0;k<this.g.length;k++){var L=this.i(k);I+=(0<=L?L:4294967296+L)*b,b*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(_(this))return"-"+A(this).toString(I);for(var b=c(Math.pow(I,6)),k=this,L="";;){var M=P(k,b).g;k=v(k,M.j(b));var V=((0<k.g.length?k.g[0]:k.h)>>>0).toString(I);if(k=M,y(k))return V+L;for(;6>V.length;)V="0"+V;L=V+L}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function _(I){return I.h==-1}n.l=function(I){return I=v(this,I),_(I)?-1:y(I)?0:1};function A(I){for(var b=I.g.length,k=[],L=0;L<b;L++)k[L]=~I.g[L];return new o(k,~I.h).add(p)}n.abs=function(){return _(this)?A(this):this},n.add=function(I){for(var b=Math.max(this.g.length,I.g.length),k=[],L=0,M=0;M<=b;M++){var V=L+(this.i(M)&65535)+(I.i(M)&65535),D=(V>>>16)+(this.i(M)>>>16)+(I.i(M)>>>16);L=D>>>16,V&=65535,D&=65535,k[M]=D<<16|V}return new o(k,k[k.length-1]&-2147483648?-1:0)};function v(I,b){return I.add(A(b))}n.j=function(I){if(y(this)||y(I))return f;if(_(this))return _(I)?A(this).j(A(I)):A(A(this).j(I));if(_(I))return A(this.j(A(I)));if(0>this.l(g)&&0>I.l(g))return c(this.m()*I.m());for(var b=this.g.length+I.g.length,k=[],L=0;L<2*b;L++)k[L]=0;for(L=0;L<this.g.length;L++)for(var M=0;M<I.g.length;M++){var V=this.i(L)>>>16,D=this.i(L)&65535,oe=I.i(M)>>>16,Pe=I.i(M)&65535;k[2*L+2*M]+=D*Pe,E(k,2*L+2*M),k[2*L+2*M+1]+=V*Pe,E(k,2*L+2*M+1),k[2*L+2*M+1]+=D*oe,E(k,2*L+2*M+1),k[2*L+2*M+2]+=V*oe,E(k,2*L+2*M+2)}for(L=0;L<b;L++)k[L]=k[2*L+1]<<16|k[2*L];for(L=b;L<2*b;L++)k[L]=0;return new o(k,0)};function E(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function S(I,b){this.g=I,this.h=b}function P(I,b){if(y(b))throw Error("division by zero");if(y(I))return new S(f,f);if(_(I))return b=P(A(I),b),new S(A(b.g),A(b.h));if(_(b))return b=P(I,A(b)),new S(A(b.g),b.h);if(30<I.g.length){if(_(I)||_(b))throw Error("slowDivide_ only works with positive integers.");for(var k=p,L=b;0>=L.l(I);)k=O(k),L=O(L);var M=F(k,1),V=F(L,1);for(L=F(L,2),k=F(k,2);!y(L);){var D=V.add(L);0>=D.l(I)&&(M=M.add(k),V=D),L=F(L,1),k=F(k,1)}return b=v(I,M.j(b)),new S(M,b)}for(M=f;0<=I.l(b);){for(k=Math.max(1,Math.floor(I.m()/b.m())),L=Math.ceil(Math.log(k)/Math.LN2),L=48>=L?1:Math.pow(2,L-48),V=c(k),D=V.j(b);_(D)||0<D.l(I);)k-=L,V=c(k),D=V.j(b);y(V)&&(V=p),M=M.add(V),I=v(I,D)}return new S(M,I)}n.A=function(I){return P(this,I).h},n.and=function(I){for(var b=Math.max(this.g.length,I.g.length),k=[],L=0;L<b;L++)k[L]=this.i(L)&I.i(L);return new o(k,this.h&I.h)},n.or=function(I){for(var b=Math.max(this.g.length,I.g.length),k=[],L=0;L<b;L++)k[L]=this.i(L)|I.i(L);return new o(k,this.h|I.h)},n.xor=function(I){for(var b=Math.max(this.g.length,I.g.length),k=[],L=0;L<b;L++)k[L]=this.i(L)^I.i(L);return new o(k,this.h^I.h)};function O(I){for(var b=I.g.length+1,k=[],L=0;L<b;L++)k[L]=I.i(L)<<1|I.i(L-1)>>>31;return new o(k,I.h)}function F(I,b){var k=b>>5;b%=32;for(var L=I.g.length-k,M=[],V=0;V<L;V++)M[V]=0<b?I.i(V+k)>>>b|I.i(V+k+1)<<32-b:I.i(V+k);return new o(M,I.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,zN=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,sc=o}).apply(typeof CC<"u"?CC:typeof self<"u"?self:typeof window<"u"?window:{});var Im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HN,Fd,qN,iy,DE,WN,GN,KN;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,m,w){return d==Array.prototype||d==Object.prototype||(d[m]=w.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Im=="object"&&Im];for(var m=0;m<d.length;++m){var w=d[m];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=t(this);function s(d,m){if(m)e:{var w=i;d=d.split(".");for(var x=0;x<d.length-1;x++){var j=d[x];if(!(j in w))break e;w=w[j]}d=d[d.length-1],x=w[d],m=m(x),m!=x&&m!=null&&e(w,d,{configurable:!0,writable:!0,value:m})}}function r(d,m){d instanceof String&&(d+="");var w=0,x=!1,j={next:function(){if(!x&&w<d.length){var $=w++;return{value:m($,d[$]),done:!1}}return x=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(d){return d||function(){return r(this,function(m,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var m=typeof d;return m=m!="object"?m:d?Array.isArray(d)?"array":m:"null",m=="array"||m=="object"&&typeof d.length=="number"}function c(d){var m=typeof d;return m=="object"&&d!=null||m=="function"}function h(d,m,w){return d.call.apply(d.bind,arguments)}function f(d,m,w){if(!d)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,x),d.apply(m,j)}}return function(){return d.apply(m,arguments)}}function p(d,m,w){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function g(d,m){var w=Array.prototype.slice.call(arguments,1);return function(){var x=w.slice();return x.push.apply(x,arguments),d.apply(this,x)}}function y(d,m){function w(){}w.prototype=m.prototype,d.aa=m.prototype,d.prototype=new w,d.prototype.constructor=d,d.Qb=function(x,j,$){for(var G=Array(arguments.length-2),We=2;We<arguments.length;We++)G[We-2]=arguments[We];return m.prototype[j].apply(x,G)}}function _(d){const m=d.length;if(0<m){const w=Array(m);for(let x=0;x<m;x++)w[x]=d[x];return w}return[]}function A(d,m){for(let w=1;w<arguments.length;w++){const x=arguments[w];if(l(x)){const j=d.length||0,$=x.length||0;d.length=j+$;for(let G=0;G<$;G++)d[j+G]=x[G]}else d.push(x)}}class v{constructor(m,w){this.i=m,this.j=w,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function E(d){return/^[\s\xa0]*$/.test(d)}function S(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function P(d){return P[" "](d),d}P[" "]=function(){};var O=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function F(d,m,w){for(const x in d)m.call(w,d[x],x,d)}function I(d,m){for(const w in d)m.call(void 0,d[w],w,d)}function b(d){const m={};for(const w in d)m[w]=d[w];return m}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(d,m){let w,x;for(let j=1;j<arguments.length;j++){x=arguments[j];for(w in x)d[w]=x[w];for(let $=0;$<k.length;$++)w=k[$],Object.prototype.hasOwnProperty.call(x,w)&&(d[w]=x[w])}}function M(d){var m=1;d=d.split(":");const w=[];for(;0<m&&d.length;)w.push(d.shift()),m--;return d.length&&w.push(d.join(":")),w}function V(d){a.setTimeout(()=>{throw d},0)}function D(){var d=Q;let m=null;return d.g&&(m=d.g,d.g=d.g.next,d.g||(d.h=null),m.next=null),m}class oe{constructor(){this.h=this.g=null}add(m,w){const x=Pe.get();x.set(m,w),this.h?this.h.next=x:this.g=x,this.h=x}}var Pe=new v(()=>new K,d=>d.reset());class K{constructor(){this.next=this.g=this.h=null}set(m,w){this.h=m,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let z,B=!1,Q=new oe,ie=()=>{const d=a.Promise.resolve(void 0);z=()=>{d.then(fe)}};var fe=()=>{for(var d;d=D();){try{d.h.call(d.g)}catch(w){V(w)}var m=Pe;m.j(d),100>m.h&&(m.h++,d.next=m.g,m.g=d)}B=!1};function ne(){this.s=this.s,this.C=this.C}ne.prototype.s=!1,ne.prototype.ma=function(){this.s||(this.s=!0,this.N())},ne.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(d,m){this.type=d,this.g=this.target=m,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var $e=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,m=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const w=()=>{};a.addEventListener("test",w,m),a.removeEventListener("test",w,m)}catch{}return d}();function Ke(d,m){if(ae.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var w=this.type=d.type,x=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=m,m=d.relatedTarget){if(O){e:{try{P(m.nodeName);var j=!0;break e}catch{}j=!1}j||(m=null)}}else w=="mouseover"?m=d.fromElement:w=="mouseout"&&(m=d.toElement);this.relatedTarget=m,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:De[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Ke.aa.h.call(this)}}y(Ke,ae);var De={2:"touch",3:"pen",4:"mouse"};Ke.prototype.h=function(){Ke.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var _e="closure_listenable_"+(1e6*Math.random()|0),Cs=0;function Bg(d,m,w,x,j){this.listener=d,this.proxy=null,this.src=m,this.type=w,this.capture=!!x,this.ha=j,this.key=++Cs,this.da=this.fa=!1}function Lc(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function $g(d){this.src=d,this.g={},this.h=0}$g.prototype.add=function(d,m,w,x,j){var $=d.toString();d=this.g[$],d||(d=this.g[$]=[],this.h++);var G=c0(d,m,x,j);return-1<G?(m=d[G],w||(m.fa=!1)):(m=new Bg(m,this.src,$,!!x,j),m.fa=w,d.push(m)),m};function l0(d,m){var w=m.type;if(w in d.g){var x=d.g[w],j=Array.prototype.indexOf.call(x,m,void 0),$;($=0<=j)&&Array.prototype.splice.call(x,j,1),$&&(Lc(m),d.g[w].length==0&&(delete d.g[w],d.h--))}}function c0(d,m,w,x){for(var j=0;j<d.length;++j){var $=d[j];if(!$.da&&$.listener==m&&$.capture==!!w&&$.ha==x)return j}return-1}var u0="closure_lm_"+(1e6*Math.random()|0),h0={};function bb(d,m,w,x,j){if(Array.isArray(m)){for(var $=0;$<m.length;$++)bb(d,m[$],w,x,j);return null}return w=Rb(w),d&&d[_e]?d.K(m,w,c(x)?!!x.capture:!!x,j):bM(d,m,w,!1,x,j)}function bM(d,m,w,x,j,$){if(!m)throw Error("Invalid event type");var G=c(j)?!!j.capture:!!j,We=f0(d);if(We||(d[u0]=We=new $g(d)),w=We.add(m,w,x,G,$),w.proxy)return w;if(x=IM(),w.proxy=x,x.src=d,x.listener=w,d.addEventListener)$e||(j=G),j===void 0&&(j=!1),d.addEventListener(m.toString(),x,j);else if(d.attachEvent)d.attachEvent(Cb(m.toString()),x);else if(d.addListener&&d.removeListener)d.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return w}function IM(){function d(w){return m.call(d.src,d.listener,w)}const m=CM;return d}function Ib(d,m,w,x,j){if(Array.isArray(m))for(var $=0;$<m.length;$++)Ib(d,m[$],w,x,j);else x=c(x)?!!x.capture:!!x,w=Rb(w),d&&d[_e]?(d=d.i,m=String(m).toString(),m in d.g&&($=d.g[m],w=c0($,w,x,j),-1<w&&(Lc($[w]),Array.prototype.splice.call($,w,1),$.length==0&&(delete d.g[m],d.h--)))):d&&(d=f0(d))&&(m=d.g[m.toString()],d=-1,m&&(d=c0(m,w,x,j)),(w=-1<d?m[d]:null)&&d0(w))}function d0(d){if(typeof d!="number"&&d&&!d.da){var m=d.src;if(m&&m[_e])l0(m.i,d);else{var w=d.type,x=d.proxy;m.removeEventListener?m.removeEventListener(w,x,d.capture):m.detachEvent?m.detachEvent(Cb(w),x):m.addListener&&m.removeListener&&m.removeListener(x),(w=f0(m))?(l0(w,d),w.h==0&&(w.src=null,m[u0]=null)):Lc(d)}}}function Cb(d){return d in h0?h0[d]:h0[d]="on"+d}function CM(d,m){if(d.da)d=!0;else{m=new Ke(m,this);var w=d.listener,x=d.ha||d.src;d.fa&&d0(d),d=w.call(x,m)}return d}function f0(d){return d=d[u0],d instanceof $g?d:null}var p0="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rb(d){return typeof d=="function"?d:(d[p0]||(d[p0]=function(m){return d.handleEvent(m)}),d[p0])}function on(){ne.call(this),this.i=new $g(this),this.M=this,this.F=null}y(on,ne),on.prototype[_e]=!0,on.prototype.removeEventListener=function(d,m,w,x){Ib(this,d,m,w,x)};function In(d,m){var w,x=d.F;if(x)for(w=[];x;x=x.F)w.push(x);if(d=d.M,x=m.type||m,typeof m=="string")m=new ae(m,d);else if(m instanceof ae)m.target=m.target||d;else{var j=m;m=new ae(x,d),L(m,j)}if(j=!0,w)for(var $=w.length-1;0<=$;$--){var G=m.g=w[$];j=zg(G,x,!0,m)&&j}if(G=m.g=d,j=zg(G,x,!0,m)&&j,j=zg(G,x,!1,m)&&j,w)for($=0;$<w.length;$++)G=m.g=w[$],j=zg(G,x,!1,m)&&j}on.prototype.N=function(){if(on.aa.N.call(this),this.i){var d=this.i,m;for(m in d.g){for(var w=d.g[m],x=0;x<w.length;x++)Lc(w[x]);delete d.g[m],d.h--}}this.F=null},on.prototype.K=function(d,m,w,x){return this.i.add(String(d),m,!1,w,x)},on.prototype.L=function(d,m,w,x){return this.i.add(String(d),m,!0,w,x)};function zg(d,m,w,x){if(m=d.i.g[String(m)],!m)return!0;m=m.concat();for(var j=!0,$=0;$<m.length;++$){var G=m[$];if(G&&!G.da&&G.capture==w){var We=G.listener,Wt=G.ha||G.src;G.fa&&l0(d.i,G),j=We.call(Wt,x)!==!1&&j}}return j&&!x.defaultPrevented}function kb(d,m,w){if(typeof d=="function")w&&(d=p(d,w));else if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:a.setTimeout(d,m||0)}function xb(d){d.g=kb(()=>{d.g=null,d.i&&(d.i=!1,xb(d))},d.l);const m=d.h;d.h=null,d.m.apply(null,m)}class RM extends ne{constructor(m,w){super(),this.m=m,this.l=w,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:xb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function od(d){ne.call(this),this.h=d,this.g={}}y(od,ne);var Pb=[];function Nb(d){F(d.g,function(m,w){this.g.hasOwnProperty(w)&&d0(m)},d),d.g={}}od.prototype.N=function(){od.aa.N.call(this),Nb(this)},od.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var g0=a.JSON.stringify,kM=a.JSON.parse,xM=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function m0(){}m0.prototype.h=null;function Lb(d){return d.h||(d.h=d.i())}function Db(){}var ad={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function y0(){ae.call(this,"d")}y(y0,ae);function v0(){ae.call(this,"c")}y(v0,ae);var za={},Mb=null;function Hg(){return Mb=Mb||new on}za.La="serverreachability";function Ob(d){ae.call(this,za.La,d)}y(Ob,ae);function ld(d){const m=Hg();In(m,new Ob(m))}za.STAT_EVENT="statevent";function Fb(d,m){ae.call(this,za.STAT_EVENT,d),this.stat=m}y(Fb,ae);function Cn(d){const m=Hg();In(m,new Fb(m,d))}za.Ma="timingevent";function Vb(d,m){ae.call(this,za.Ma,d),this.size=m}y(Vb,ae);function cd(d,m){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},m)}function ud(){this.g=!0}ud.prototype.xa=function(){this.g=!1};function PM(d,m,w,x,j,$){d.info(function(){if(d.g)if($)for(var G="",We=$.split("&"),Wt=0;Wt<We.length;Wt++){var Me=We[Wt].split("=");if(1<Me.length){var an=Me[0];Me=Me[1];var ln=an.split("_");G=2<=ln.length&&ln[1]=="type"?G+(an+"="+Me+"&"):G+(an+"=redacted&")}}else G=null;else G=$;return"XMLHTTP REQ ("+x+") [attempt "+j+"]: "+m+`
`+w+`
`+G})}function NM(d,m,w,x,j,$,G){d.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+j+"]: "+m+`
`+w+`
`+$+" "+G})}function Dc(d,m,w,x){d.info(function(){return"XMLHTTP TEXT ("+m+"): "+DM(d,w)+(x?" "+x:"")})}function LM(d,m){d.info(function(){return"TIMEOUT: "+m})}ud.prototype.info=function(){};function DM(d,m){if(!d.g)return m;if(!m)return null;try{var w=JSON.parse(m);if(w){for(d=0;d<w.length;d++)if(Array.isArray(w[d])){var x=w[d];if(!(2>x.length)){var j=x[1];if(Array.isArray(j)&&!(1>j.length)){var $=j[0];if($!="noop"&&$!="stop"&&$!="close")for(var G=1;G<j.length;G++)j[G]=""}}}}return g0(w)}catch{return m}}var qg={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ub={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_0;function Wg(){}y(Wg,m0),Wg.prototype.g=function(){return new XMLHttpRequest},Wg.prototype.i=function(){return{}},_0=new Wg;function yo(d,m,w,x){this.j=d,this.i=m,this.l=w,this.R=x||1,this.U=new od(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jb}function jb(){this.i=null,this.g="",this.h=!1}var Bb={},w0={};function E0(d,m,w){d.L=1,d.v=Qg(hr(m)),d.m=w,d.P=!0,$b(d,null)}function $b(d,m){d.F=Date.now(),Gg(d),d.A=hr(d.v);var w=d.A,x=d.R;Array.isArray(x)||(x=[String(x)]),n1(w.i,"t",x),d.C=0,w=d.j.J,d.h=new jb,d.g=w1(d.j,w?m:null,!d.m),0<d.O&&(d.M=new RM(p(d.Y,d,d.g),d.O)),m=d.U,w=d.g,x=d.ca;var j="readystatechange";Array.isArray(j)||(j&&(Pb[0]=j.toString()),j=Pb);for(var $=0;$<j.length;$++){var G=bb(w,j[$],x||m.handleEvent,!1,m.h||m);if(!G)break;m.g[G.key]=G}m=d.H?b(d.H):{},d.m?(d.u||(d.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,m)):(d.u="GET",d.g.ea(d.A,d.u,null,m)),ld(),PM(d.i,d.u,d.A,d.l,d.R,d.m)}yo.prototype.ca=function(d){d=d.target;const m=this.M;m&&dr(d)==3?m.j():this.Y(d)},yo.prototype.Y=function(d){try{if(d==this.g)e:{const ln=dr(this.g);var m=this.g.Ba();const Fc=this.g.Z();if(!(3>ln)&&(ln!=3||this.g&&(this.h.h||this.g.oa()||c1(this.g)))){this.J||ln!=4||m==7||(m==8||0>=Fc?ld(3):ld(2)),A0(this);var w=this.g.Z();this.X=w;t:if(zb(this)){var x=c1(this.g);d="";var j=x.length,$=dr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ha(this),hd(this);var G="";break t}this.h.i=new a.TextDecoder}for(m=0;m<j;m++)this.h.h=!0,d+=this.h.i.decode(x[m],{stream:!($&&m==j-1)});x.length=0,this.h.g+=d,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=w==200,NM(this.i,this.u,this.A,this.l,this.R,ln,w),this.o){if(this.T&&!this.K){t:{if(this.g){var We,Wt=this.g;if((We=Wt.g?Wt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(We)){var Me=We;break t}}Me=null}if(w=Me)Dc(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,T0(this,w);else{this.o=!1,this.s=3,Cn(12),Ha(this),hd(this);break e}}if(this.P){w=!0;let Qi;for(;!this.J&&this.C<G.length;)if(Qi=MM(this,G),Qi==w0){ln==4&&(this.s=4,Cn(14),w=!1),Dc(this.i,this.l,null,"[Incomplete Response]");break}else if(Qi==Bb){this.s=4,Cn(15),Dc(this.i,this.l,G,"[Invalid Chunk]"),w=!1;break}else Dc(this.i,this.l,Qi,null),T0(this,Qi);if(zb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||G.length!=0||this.h.h||(this.s=1,Cn(16),w=!1),this.o=this.o&&w,!w)Dc(this.i,this.l,G,"[Invalid Chunked Response]"),Ha(this),hd(this);else if(0<G.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),k0(an),an.M=!0,Cn(11))}}else Dc(this.i,this.l,G,null),T0(this,G);ln==4&&Ha(this),this.o&&!this.J&&(ln==4?m1(this.j,this):(this.o=!1,Gg(this)))}else JM(this.g),w==400&&0<G.indexOf("Unknown SID")?(this.s=3,Cn(12)):(this.s=0,Cn(13)),Ha(this),hd(this)}}}catch{}finally{}};function zb(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function MM(d,m){var w=d.C,x=m.indexOf(`
`,w);return x==-1?w0:(w=Number(m.substring(w,x)),isNaN(w)?Bb:(x+=1,x+w>m.length?w0:(m=m.slice(x,x+w),d.C=x+w,m)))}yo.prototype.cancel=function(){this.J=!0,Ha(this)};function Gg(d){d.S=Date.now()+d.I,Hb(d,d.I)}function Hb(d,m){if(d.B!=null)throw Error("WatchDog timer not null");d.B=cd(p(d.ba,d),m)}function A0(d){d.B&&(a.clearTimeout(d.B),d.B=null)}yo.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(LM(this.i,this.A),this.L!=2&&(ld(),Cn(17)),Ha(this),this.s=2,hd(this)):Hb(this,this.S-d)};function hd(d){d.j.G==0||d.J||m1(d.j,d)}function Ha(d){A0(d);var m=d.M;m&&typeof m.ma=="function"&&m.ma(),d.M=null,Nb(d.U),d.g&&(m=d.g,d.g=null,m.abort(),m.ma())}function T0(d,m){try{var w=d.j;if(w.G!=0&&(w.g==d||S0(w.h,d))){if(!d.K&&S0(w.h,d)&&w.G==3){try{var x=w.Da.g.parse(m)}catch{x=null}if(Array.isArray(x)&&x.length==3){var j=x;if(j[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<d.F)nm(w),em(w);else break e;R0(w),Cn(18)}}else w.za=j[1],0<w.za-w.T&&37500>j[2]&&w.F&&w.v==0&&!w.C&&(w.C=cd(p(w.Za,w),6e3));if(1>=Gb(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Wa(w,11)}else if((d.K||w.g==d)&&nm(w),!E(m))for(j=w.Da.g.parse(m),m=0;m<j.length;m++){let Me=j[m];if(w.T=Me[0],Me=Me[1],w.G==2)if(Me[0]=="c"){w.K=Me[1],w.ia=Me[2];const an=Me[3];an!=null&&(w.la=an,w.j.info("VER="+w.la));const ln=Me[4];ln!=null&&(w.Aa=ln,w.j.info("SVER="+w.Aa));const Fc=Me[5];Fc!=null&&typeof Fc=="number"&&0<Fc&&(x=1.5*Fc,w.L=x,w.j.info("backChannelRequestTimeoutMs_="+x)),x=w;const Qi=d.g;if(Qi){const sm=Qi.g?Qi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sm){var $=x.h;$.g||sm.indexOf("spdy")==-1&&sm.indexOf("quic")==-1&&sm.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(b0($,$.h),$.h=null))}if(x.D){const x0=Qi.g?Qi.g.getResponseHeader("X-HTTP-Session-Id"):null;x0&&(x.ya=x0,Ye(x.I,x.D,x0))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-d.F,w.j.info("Handshake RTT: "+w.R+"ms")),x=w;var G=d;if(x.qa=_1(x,x.J?x.ia:null,x.W),G.K){Kb(x.h,G);var We=G,Wt=x.L;Wt&&(We.I=Wt),We.B&&(A0(We),Gg(We)),x.g=G}else p1(x);0<w.i.length&&tm(w)}else Me[0]!="stop"&&Me[0]!="close"||Wa(w,7);else w.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?Wa(w,7):C0(w):Me[0]!="noop"&&w.l&&w.l.ta(Me),w.v=0)}}ld(4)}catch{}}var OM=class{constructor(d,m){this.g=d,this.map=m}};function qb(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wb(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Gb(d){return d.h?1:d.g?d.g.size:0}function S0(d,m){return d.h?d.h==m:d.g?d.g.has(m):!1}function b0(d,m){d.g?d.g.add(m):d.h=m}function Kb(d,m){d.h&&d.h==m?d.h=null:d.g&&d.g.has(m)&&d.g.delete(m)}qb.prototype.cancel=function(){if(this.i=Xb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Xb(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let m=d.i;for(const w of d.g.values())m=m.concat(w.D);return m}return _(d.i)}function FM(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var m=[],w=d.length,x=0;x<w;x++)m.push(d[x]);return m}m=[],w=0;for(x in d)m[w++]=d[x];return m}function VM(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var m=[];d=d.length;for(var w=0;w<d;w++)m.push(w);return m}m=[],w=0;for(const x in d)m[w++]=x;return m}}}function Qb(d,m){if(d.forEach&&typeof d.forEach=="function")d.forEach(m,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,m,void 0);else for(var w=VM(d),x=FM(d),j=x.length,$=0;$<j;$++)m.call(void 0,x[$],w&&w[$],d)}var Yb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function UM(d,m){if(d){d=d.split("&");for(var w=0;w<d.length;w++){var x=d[w].indexOf("="),j=null;if(0<=x){var $=d[w].substring(0,x);j=d[w].substring(x+1)}else $=d[w];m($,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function qa(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof qa){this.h=d.h,Kg(this,d.j),this.o=d.o,this.g=d.g,Xg(this,d.s),this.l=d.l;var m=d.i,w=new pd;w.i=m.i,m.g&&(w.g=new Map(m.g),w.h=m.h),Jb(this,w),this.m=d.m}else d&&(m=String(d).match(Yb))?(this.h=!1,Kg(this,m[1]||"",!0),this.o=dd(m[2]||""),this.g=dd(m[3]||"",!0),Xg(this,m[4]),this.l=dd(m[5]||"",!0),Jb(this,m[6]||"",!0),this.m=dd(m[7]||"")):(this.h=!1,this.i=new pd(null,this.h))}qa.prototype.toString=function(){var d=[],m=this.j;m&&d.push(fd(m,Zb,!0),":");var w=this.g;return(w||m=="file")&&(d.push("//"),(m=this.o)&&d.push(fd(m,Zb,!0),"@"),d.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&d.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&d.push("/"),d.push(fd(w,w.charAt(0)=="/"?$M:BM,!0))),(w=this.i.toString())&&d.push("?",w),(w=this.m)&&d.push("#",fd(w,HM)),d.join("")};function hr(d){return new qa(d)}function Kg(d,m,w){d.j=w?dd(m,!0):m,d.j&&(d.j=d.j.replace(/:$/,""))}function Xg(d,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);d.s=m}else d.s=null}function Jb(d,m,w){m instanceof pd?(d.i=m,qM(d.i,d.h)):(w||(m=fd(m,zM)),d.i=new pd(m,d.h))}function Ye(d,m,w){d.i.set(m,w)}function Qg(d){return Ye(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function dd(d,m){return d?m?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function fd(d,m,w){return typeof d=="string"?(d=encodeURI(d).replace(m,jM),w&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function jM(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Zb=/[#\/\?@]/g,BM=/[#\?:]/g,$M=/[#\?]/g,zM=/[#\?@]/g,HM=/#/g;function pd(d,m){this.h=this.g=null,this.i=d||null,this.j=!!m}function vo(d){d.g||(d.g=new Map,d.h=0,d.i&&UM(d.i,function(m,w){d.add(decodeURIComponent(m.replace(/\+/g," ")),w)}))}n=pd.prototype,n.add=function(d,m){vo(this),this.i=null,d=Mc(this,d);var w=this.g.get(d);return w||this.g.set(d,w=[]),w.push(m),this.h+=1,this};function e1(d,m){vo(d),m=Mc(d,m),d.g.has(m)&&(d.i=null,d.h-=d.g.get(m).length,d.g.delete(m))}function t1(d,m){return vo(d),m=Mc(d,m),d.g.has(m)}n.forEach=function(d,m){vo(this),this.g.forEach(function(w,x){w.forEach(function(j){d.call(m,j,x,this)},this)},this)},n.na=function(){vo(this);const d=Array.from(this.g.values()),m=Array.from(this.g.keys()),w=[];for(let x=0;x<m.length;x++){const j=d[x];for(let $=0;$<j.length;$++)w.push(m[x])}return w},n.V=function(d){vo(this);let m=[];if(typeof d=="string")t1(this,d)&&(m=m.concat(this.g.get(Mc(this,d))));else{d=Array.from(this.g.values());for(let w=0;w<d.length;w++)m=m.concat(d[w])}return m},n.set=function(d,m){return vo(this),this.i=null,d=Mc(this,d),t1(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[m]),this.h+=1,this},n.get=function(d,m){return d?(d=this.V(d),0<d.length?String(d[0]):m):m};function n1(d,m,w){e1(d,m),0<w.length&&(d.i=null,d.g.set(Mc(d,m),_(w)),d.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],m=Array.from(this.g.keys());for(var w=0;w<m.length;w++){var x=m[w];const $=encodeURIComponent(String(x)),G=this.V(x);for(x=0;x<G.length;x++){var j=$;G[x]!==""&&(j+="="+encodeURIComponent(String(G[x]))),d.push(j)}}return this.i=d.join("&")};function Mc(d,m){return m=String(m),d.j&&(m=m.toLowerCase()),m}function qM(d,m){m&&!d.j&&(vo(d),d.i=null,d.g.forEach(function(w,x){var j=x.toLowerCase();x!=j&&(e1(this,x),n1(this,j,w))},d)),d.j=m}function WM(d,m){const w=new ud;if(a.Image){const x=new Image;x.onload=g(_o,w,"TestLoadImage: loaded",!0,m,x),x.onerror=g(_o,w,"TestLoadImage: error",!1,m,x),x.onabort=g(_o,w,"TestLoadImage: abort",!1,m,x),x.ontimeout=g(_o,w,"TestLoadImage: timeout",!1,m,x),a.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=d}else m(!1)}function GM(d,m){const w=new ud,x=new AbortController,j=setTimeout(()=>{x.abort(),_o(w,"TestPingServer: timeout",!1,m)},1e4);fetch(d,{signal:x.signal}).then($=>{clearTimeout(j),$.ok?_o(w,"TestPingServer: ok",!0,m):_o(w,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(j),_o(w,"TestPingServer: error",!1,m)})}function _o(d,m,w,x,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),x(w)}catch{}}function KM(){this.g=new xM}function XM(d,m,w){const x=w||"";try{Qb(d,function(j,$){let G=j;c(j)&&(G=g0(j)),m.push(x+$+"="+encodeURIComponent(G))})}catch(j){throw m.push(x+"type="+encodeURIComponent("_badmap")),j}}function Yg(d){this.l=d.Ub||null,this.j=d.eb||!1}y(Yg,m0),Yg.prototype.g=function(){return new Jg(this.l,this.j)},Yg.prototype.i=function(d){return function(){return d}}({});function Jg(d,m){on.call(this),this.D=d,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Jg,on),n=Jg.prototype,n.open=function(d,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=m,this.readyState=1,md(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(m.body=d),(this.D||a).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gd(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,md(this)),this.g&&(this.readyState=3,md(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;i1(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function i1(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var m=d.value?d.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!d.done}))&&(this.response=this.responseText+=m)}d.done?gd(this):md(this),this.readyState==3&&i1(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,gd(this))},n.Qa=function(d){this.g&&(this.response=d,gd(this))},n.ga=function(){this.g&&gd(this)};function gd(d){d.readyState=4,d.l=null,d.j=null,d.v=null,md(d)}n.setRequestHeader=function(d,m){this.u.append(d,m)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],m=this.h.entries();for(var w=m.next();!w.done;)w=w.value,d.push(w[0]+": "+w[1]),w=m.next();return d.join(`\r
`)};function md(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Jg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function s1(d){let m="";return F(d,function(w,x){m+=x,m+=":",m+=w,m+=`\r
`}),m}function I0(d,m,w){e:{for(x in w){var x=!1;break e}x=!0}x||(w=s1(w),typeof d=="string"?w!=null&&encodeURIComponent(String(w)):Ye(d,m,w))}function pt(d){on.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(pt,on);var QM=/^https?$/i,YM=["POST","PUT"];n=pt.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,m,w,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);m=m?m.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_0.g(),this.v=this.o?Lb(this.o):Lb(_0),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(m,String(d),!0),this.B=!1}catch($){r1(this,$);return}if(d=w||"",w=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var j in x)w.set(j,x[j]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const $ of x.keys())w.set($,x.get($));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(w.keys()).find($=>$.toLowerCase()=="content-type"),j=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(YM,m,void 0))||x||j||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,G]of w)this.g.setRequestHeader($,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{l1(this),this.u=!0,this.g.send(d),this.u=!1}catch($){r1(this,$)}};function r1(d,m){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=m,d.m=5,o1(d),Zg(d)}function o1(d){d.A||(d.A=!0,In(d,"complete"),In(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,In(this,"complete"),In(this,"abort"),Zg(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zg(this,!0)),pt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?a1(this):this.bb())},n.bb=function(){a1(this)};function a1(d){if(d.h&&typeof o<"u"&&(!d.v[1]||dr(d)!=4||d.Z()!=2)){if(d.u&&dr(d)==4)kb(d.Ea,0,d);else if(In(d,"readystatechange"),dr(d)==4){d.h=!1;try{const G=d.Z();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var w;if(!(w=m)){var x;if(x=G===0){var j=String(d.D).match(Yb)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),x=!QM.test(j?j.toLowerCase():"")}w=x}if(w)In(d,"complete"),In(d,"success");else{d.m=6;try{var $=2<dr(d)?d.g.statusText:""}catch{$=""}d.l=$+" ["+d.Z()+"]",o1(d)}}finally{Zg(d)}}}}function Zg(d,m){if(d.g){l1(d);const w=d.g,x=d.v[0]?()=>{}:null;d.g=null,d.v=null,m||In(d,"ready");try{w.onreadystatechange=x}catch{}}}function l1(d){d.I&&(a.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function dr(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<dr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var m=this.g.responseText;return d&&m.indexOf(d)==0&&(m=m.substring(d.length)),kM(m)}};function c1(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function JM(d){const m={};d=(d.g&&2<=dr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<d.length;x++){if(E(d[x]))continue;var w=M(d[x]);const j=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const $=m[j]||[];m[j]=$,$.push(w)}I(m,function(x){return x.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yd(d,m,w){return w&&w.internalChannelParams&&w.internalChannelParams[d]||m}function u1(d){this.Aa=0,this.i=[],this.j=new ud,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yd("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yd("baseRetryDelayMs",5e3,d),this.cb=yd("retryDelaySeedMs",1e4,d),this.Wa=yd("forwardChannelMaxRetries",2,d),this.wa=yd("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new qb(d&&d.concurrentRequestLimit),this.Da=new KM,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=u1.prototype,n.la=8,n.G=1,n.connect=function(d,m,w,x){Cn(0),this.W=d,this.H=m||{},w&&x!==void 0&&(this.H.OSID=w,this.H.OAID=x),this.F=this.X,this.I=_1(this,null,this.W),tm(this)};function C0(d){if(h1(d),d.G==3){var m=d.U++,w=hr(d.I);if(Ye(w,"SID",d.K),Ye(w,"RID",m),Ye(w,"TYPE","terminate"),vd(d,w),m=new yo(d,d.j,m),m.L=2,m.v=Qg(hr(w)),w=!1,a.navigator&&a.navigator.sendBeacon)try{w=a.navigator.sendBeacon(m.v.toString(),"")}catch{}!w&&a.Image&&(new Image().src=m.v,w=!0),w||(m.g=w1(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Gg(m)}v1(d)}function em(d){d.g&&(k0(d),d.g.cancel(),d.g=null)}function h1(d){em(d),d.u&&(a.clearTimeout(d.u),d.u=null),nm(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function tm(d){if(!Wb(d.h)&&!d.s){d.s=!0;var m=d.Ga;z||ie(),B||(z(),B=!0),Q.add(m,d),d.B=0}}function ZM(d,m){return Gb(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=m.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=cd(p(d.Ga,d,m),y1(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const j=new yo(this,this.j,d);let $=this.o;if(this.S&&($?($=b($),L($,this.S)):$=this.S),this.m!==null||this.O||(j.H=$,$=null),this.P)e:{for(var m=0,w=0;w<this.i.length;w++){t:{var x=this.i[w];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(m+=x,4096<m){m=w;break e}if(m===4096||w===this.i.length-1){m=w+1;break e}}m=1e3}else m=1e3;m=f1(this,j,m),w=hr(this.I),Ye(w,"RID",d),Ye(w,"CVER",22),this.D&&Ye(w,"X-HTTP-Session-Id",this.D),vd(this,w),$&&(this.O?m="headers="+encodeURIComponent(String(s1($)))+"&"+m:this.m&&I0(w,this.m,$)),b0(this.h,j),this.Ua&&Ye(w,"TYPE","init"),this.P?(Ye(w,"$req",m),Ye(w,"SID","null"),j.T=!0,E0(j,w,null)):E0(j,w,m),this.G=2}}else this.G==3&&(d?d1(this,d):this.i.length==0||Wb(this.h)||d1(this))};function d1(d,m){var w;m?w=m.l:w=d.U++;const x=hr(d.I);Ye(x,"SID",d.K),Ye(x,"RID",w),Ye(x,"AID",d.T),vd(d,x),d.m&&d.o&&I0(x,d.m,d.o),w=new yo(d,d.j,w,d.B+1),d.m===null&&(w.H=d.o),m&&(d.i=m.D.concat(d.i)),m=f1(d,w,1e3),w.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),b0(d.h,w),E0(w,x,m)}function vd(d,m){d.H&&F(d.H,function(w,x){Ye(m,x,w)}),d.l&&Qb({},function(w,x){Ye(m,x,w)})}function f1(d,m,w){w=Math.min(d.i.length,w);var x=d.l?p(d.l.Na,d.l,d):null;e:{var j=d.i;let $=-1;for(;;){const G=["count="+w];$==-1?0<w?($=j[0].g,G.push("ofs="+$)):$=0:G.push("ofs="+$);let We=!0;for(let Wt=0;Wt<w;Wt++){let Me=j[Wt].g;const an=j[Wt].map;if(Me-=$,0>Me)$=Math.max(0,j[Wt].g-100),We=!1;else try{XM(an,G,"req"+Me+"_")}catch{x&&x(an)}}if(We){x=G.join("&");break e}}}return d=d.i.splice(0,w),m.D=d,x}function p1(d){if(!d.g&&!d.u){d.Y=1;var m=d.Fa;z||ie(),B||(z(),B=!0),Q.add(m,d),d.v=0}}function R0(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=cd(p(d.Fa,d),y1(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,g1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=cd(p(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Cn(10),em(this),g1(this))};function k0(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function g1(d){d.g=new yo(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var m=hr(d.qa);Ye(m,"RID","rpc"),Ye(m,"SID",d.K),Ye(m,"AID",d.T),Ye(m,"CI",d.F?"0":"1"),!d.F&&d.ja&&Ye(m,"TO",d.ja),Ye(m,"TYPE","xmlhttp"),vd(d,m),d.m&&d.o&&I0(m,d.m,d.o),d.L&&(d.g.I=d.L);var w=d.g;d=d.ia,w.L=1,w.v=Qg(hr(m)),w.m=null,w.P=!0,$b(w,d)}n.Za=function(){this.C!=null&&(this.C=null,em(this),R0(this),Cn(19))};function nm(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function m1(d,m){var w=null;if(d.g==m){nm(d),k0(d),d.g=null;var x=2}else if(S0(d.h,m))w=m.D,Kb(d.h,m),x=1;else return;if(d.G!=0){if(m.o)if(x==1){w=m.m?m.m.length:0,m=Date.now()-m.F;var j=d.B;x=Hg(),In(x,new Vb(x,w)),tm(d)}else p1(d);else if(j=m.s,j==3||j==0&&0<m.X||!(x==1&&ZM(d,m)||x==2&&R0(d)))switch(w&&0<w.length&&(m=d.h,m.i=m.i.concat(w)),j){case 1:Wa(d,5);break;case 4:Wa(d,10);break;case 3:Wa(d,6);break;default:Wa(d,2)}}}function y1(d,m){let w=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(w*=2),w*m}function Wa(d,m){if(d.j.info("Error code "+m),m==2){var w=p(d.fb,d),x=d.Xa;const j=!x;x=new qa(x||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kg(x,"https"),Qg(x),j?WM(x.toString(),w):GM(x.toString(),w)}else Cn(2);d.G=0,d.l&&d.l.sa(m),v1(d),h1(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Cn(2)):(this.j.info("Failed to ping google.com"),Cn(1))};function v1(d){if(d.G=0,d.ka=[],d.l){const m=Xb(d.h);(m.length!=0||d.i.length!=0)&&(A(d.ka,m),A(d.ka,d.i),d.h.i.length=0,_(d.i),d.i.length=0),d.l.ra()}}function _1(d,m,w){var x=w instanceof qa?hr(w):new qa(w);if(x.g!="")m&&(x.g=m+"."+x.g),Xg(x,x.s);else{var j=a.location;x=j.protocol,m=m?m+"."+j.hostname:j.hostname,j=+j.port;var $=new qa(null);x&&Kg($,x),m&&($.g=m),j&&Xg($,j),w&&($.l=w),x=$}return w=d.D,m=d.ya,w&&m&&Ye(x,w,m),Ye(x,"VER",d.la),vd(d,x),x}function w1(d,m,w){if(m&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=d.Ca&&!d.pa?new pt(new Yg({eb:w})):new pt(d.pa),m.Ha(d.J),m}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function E1(){}n=E1.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function im(){}im.prototype.g=function(d,m){return new ri(d,m)};function ri(d,m){on.call(this),this.g=new u1(m),this.l=d,this.h=m&&m.messageUrlParams||null,d=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(d?d["X-WebChannel-Content-Type"]=m.messageContentType:d={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(d?d["X-WebChannel-Client-Profile"]=m.va:d={"X-WebChannel-Client-Profile":m.va}),this.g.S=d,(d=m&&m.Sb)&&!E(d)&&(this.g.m=d),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!E(m)&&(this.g.D=m,d=this.h,d!==null&&m in d&&(d=this.h,m in d&&delete d[m])),this.j=new Oc(this)}y(ri,on),ri.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ri.prototype.close=function(){C0(this.g)},ri.prototype.o=function(d){var m=this.g;if(typeof d=="string"){var w={};w.__data__=d,d=w}else this.u&&(w={},w.__data__=g0(d),d=w);m.i.push(new OM(m.Ya++,d)),m.G==3&&tm(m)},ri.prototype.N=function(){this.g.l=null,delete this.j,C0(this.g),delete this.g,ri.aa.N.call(this)};function A1(d){y0.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var m=d.__sm__;if(m){e:{for(const w in m){d=w;break e}d=void 0}(this.i=d)&&(d=this.i,m=m!==null&&d in m?m[d]:void 0),this.data=m}else this.data=d}y(A1,y0);function T1(){v0.call(this),this.status=1}y(T1,v0);function Oc(d){this.g=d}y(Oc,E1),Oc.prototype.ua=function(){In(this.g,"a")},Oc.prototype.ta=function(d){In(this.g,new A1(d))},Oc.prototype.sa=function(d){In(this.g,new T1)},Oc.prototype.ra=function(){In(this.g,"b")},im.prototype.createWebChannel=im.prototype.g,ri.prototype.send=ri.prototype.o,ri.prototype.open=ri.prototype.m,ri.prototype.close=ri.prototype.close,KN=function(){return new im},GN=function(){return Hg()},WN=za,DE={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qg.NO_ERROR=0,qg.TIMEOUT=8,qg.HTTP_ERROR=6,iy=qg,Ub.COMPLETE="complete",qN=Ub,Db.EventType=ad,ad.OPEN="a",ad.CLOSE="b",ad.ERROR="c",ad.MESSAGE="d",on.prototype.listen=on.prototype.K,Fd=Db,pt.prototype.listenOnce=pt.prototype.L,pt.prototype.getLastError=pt.prototype.Ka,pt.prototype.getLastErrorCode=pt.prototype.Ba,pt.prototype.getStatus=pt.prototype.Z,pt.prototype.getResponseJson=pt.prototype.Oa,pt.prototype.getResponseText=pt.prototype.oa,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Ha,HN=pt}).apply(typeof Im<"u"?Im:typeof self<"u"?self:typeof window<"u"?window:{});const RC="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_n.UNAUTHENTICATED=new _n(null),_n.GOOGLE_CREDENTIALS=new _n("google-credentials-uid"),_n.FIRST_PARTY=new _n("first-party-uid"),_n.MOCK_USER=new _n("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zh="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=new S_("@firebase/firestore");function jc(){return gc.logLevel}function Y(n,...e){if(gc.logLevel<=be.DEBUG){const t=e.map(CS);gc.debug(`Firestore (${Zh}): ${n}`,...t)}}function ho(n,...e){if(gc.logLevel<=be.ERROR){const t=e.map(CS);gc.error(`Firestore (${Zh}): ${n}`,...t)}}function Fh(n,...e){if(gc.logLevel<=be.WARN){const t=e.map(CS);gc.warn(`Firestore (${Zh}): ${n}`,...t)}}function CS(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(n="Unexpected state"){const e=`FIRESTORE (${Zh}) INTERNAL ASSERTION FAILED: `+n;throw ho(e),new Error(e)}function Ve(n,e){n||de()}function me(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends Xi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Dz{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(_n.UNAUTHENTICATED))}shutdown(){}}class Mz{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Oz{constructor(e){this.t=e,this.currentUser=_n.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ve(this.o===void 0);let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let r=new to;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new to,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new to)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ve(typeof i.accessToken=="string"),new XN(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ve(e===null||typeof e=="string"),new _n(e)}}class Fz{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=_n.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Vz{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Fz(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(_n.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Uz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class jz{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ve(this.o===void 0);const i=r=>{r.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>i(r))};const s=r=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?s(r):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ve(typeof t.token=="string"),this.R=t.token,new Uz(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bz(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const s=Bz(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<t&&(i+=e.charAt(s[r]%e.length))}return i}}function ke(n,e){return n<e?-1:n>e?1:0}function Vh(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ot(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ee(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ee(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ee(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ke(this.nanoseconds,e.nanoseconds):ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new Ot(0,0))}static max(){return new pe(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,t,i){t===void 0?t=0:t>e.length&&de(),i===void 0?i=e.length-t:i>e.length-t&&de(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Wf.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Wf?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const r=e.get(s),o=t.get(s);if(r<o)return-1;if(r>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ze extends Wf{construct(e,t,i){return new Ze(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ee(q.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new Ze(t)}static emptyPath(){return new Ze([])}}const $z=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Wf{construct(e,t,i){return new tn(e,t,i)}static isValidIdentifier(e){return $z.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tn(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const r=()=>{if(i.length===0)throw new ee(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ee(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ee(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new ee(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(t)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(Ze.fromString(e))}static fromName(e){return new le(Ze.fromString(e).popFirst(5))}static empty(){return new le(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new Ze(e.slice()))}}function zz(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(i===1e9?new Ot(t+1,0):new Ot(t,i));return new Sa(s,le.empty(),e)}function Hz(n){return new Sa(n.readTime,n.key,-1)}class Sa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Sa(pe.min(),le.empty(),-1)}static max(){return new Sa(pe.max(),le.empty(),-1)}}function qz(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:ke(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gz{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ed(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==Wz)throw n;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&de(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new H((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof H?t:H.resolve(t)}catch(t){return H.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):H.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):H.reject(t)}static resolve(e){return new H((t,i)=>{t(e)})}static reject(e){return new H((t,i)=>{i(e)})}static waitFor(e){return new H((t,i)=>{let s=0,r=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&t()},l=>i(l))}),o=!0,r===s&&t()})}static or(e){let t=H.resolve(!1);for(const i of e)t=t.next(s=>s?H.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,r)=>{i.push(t.call(this,s,r))}),this.waitFor(i)}static mapArray(e,t){return new H((i,s)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===r&&i(o)},h=>s(h))}})}static doWhile(e,t){return new H((i,s)=>{const r=()=>{e()===!0?t().next(()=>{r()},s):i()};r()})}}function Kz(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function td(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}P_.oe=-1;function N_(n){return n==null}function _v(n){return n===0&&1/n==-1/0}function Xz(n){return typeof n=="number"&&Number.isInteger(n)&&!_v(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kC(e)),e=Yz(n.get(t),e);return kC(e)}function Yz(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":t+="";break;case"":t+="";break;default:t+=r}}return t}function kC(n){return n+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ja(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,t){this.comparator=e,this.root=t||Zt.EMPTY}insert(e,t){return new ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cm(this.root,e,this.comparator,!0)}}class Cm{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?i(e.key,t):1,t&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zt{constructor(e,t,i,s,r){this.key=e,this.value=t,this.color=i??Zt.RED,this.left=s??Zt.EMPTY,this.right=r??Zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,r){return new Zt(e??this.key,t??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const r=i(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,i),null):r===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Zt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw de();const e=this.left.check();if(e!==this.right.check())throw de();return e+(this.isRed()?0:1)}}Zt.EMPTY=null,Zt.RED=!0,Zt.BLACK=!1;Zt.EMPTY=new class{constructor(){this.size=0}get key(){throw de()}get value(){throw de()}get color(){throw de()}get left(){throw de()}get right(){throw de()}copy(e,t,i,s,r){return this}insert(e,t,i){return new Zt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new PC(this.data.getIterator())}getIteratorFrom(e){return new PC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ft(this.comparator);return t.data=e,t}}class PC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new Ai([])}unionWith(e){let t=new Ft(tn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ai(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Vh(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new JN("Invalid base64 string: "+r):r}}(e);return new rn(t)}static fromUint8Array(e){const t=function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r}(e);return new rn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rn.EMPTY_BYTE_STRING=new rn("");const Jz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ba(n){if(Ve(!!n),typeof n=="string"){let e=0;const t=Jz.exec(n);if(Ve(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:wt(n.seconds),nanos:wt(n.nanos)}}function wt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ia(n){return typeof n=="string"?rn.fromBase64String(n):rn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function L_(n){const e=n.mapValue.fields.__previous_value__;return RS(e)?L_(e):e}function Gf(n){const e=ba(n.mapValue.fields.__local_write_time__.timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,t,i,s,r,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Kf{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Kf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Kf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ca(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?RS(n)?4:t5(n)?9007199254740991:e5(n)?10:11:de()}function rr(n,e){if(n===e)return!0;const t=Ca(n);if(t!==Ca(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gf(n).isEqual(Gf(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=ba(s.timestampValue),a=ba(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,r){return Ia(s.bytesValue).isEqual(Ia(r.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,r){return wt(s.geoPointValue.latitude)===wt(r.geoPointValue.latitude)&&wt(s.geoPointValue.longitude)===wt(r.geoPointValue.longitude)}(n,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return wt(s.integerValue)===wt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=wt(s.doubleValue),a=wt(r.doubleValue);return o===a?_v(o)===_v(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Vh(n.arrayValue.values||[],e.arrayValue.values||[],rr);case 10:case 11:return function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(xC(o)!==xC(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!rr(o[l],a[l])))return!1;return!0}(n,e);default:return de()}}function Xf(n,e){return(n.values||[]).find(t=>rr(t,e))!==void 0}function Uh(n,e){if(n===e)return 0;const t=Ca(n),i=Ca(e);if(t!==i)return ke(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ke(n.booleanValue,e.booleanValue);case 2:return function(r,o){const a=wt(r.integerValue||r.doubleValue),l=wt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return NC(n.timestampValue,e.timestampValue);case 4:return NC(Gf(n),Gf(e));case 5:return ke(n.stringValue,e.stringValue);case 6:return function(r,o){const a=Ia(r),l=Ia(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=ke(a[c],l[c]);if(h!==0)return h}return ke(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,o){const a=ke(wt(r.latitude),wt(o.latitude));return a!==0?a:ke(wt(r.longitude),wt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return LC(n.arrayValue,e.arrayValue);case 10:return function(r,o){var a,l,c,h;const f=r.fields||{},p=o.fields||{},g=(a=f.value)===null||a===void 0?void 0:a.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,_=ke(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((h=y==null?void 0:y.values)===null||h===void 0?void 0:h.length)||0);return _!==0?_:LC(g,y)}(n.mapValue,e.mapValue);case 11:return function(r,o){if(r===Rm.mapValue&&o===Rm.mapValue)return 0;if(r===Rm.mapValue)return 1;if(o===Rm.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const p=ke(l[f],h[f]);if(p!==0)return p;const g=Uh(a[l[f]],c[h[f]]);if(g!==0)return g}return ke(l.length,h.length)}(n.mapValue,e.mapValue);default:throw de()}}function NC(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ke(n,e);const t=ba(n),i=ba(e),s=ke(t.seconds,i.seconds);return s!==0?s:ke(t.nanos,i.nanos)}function LC(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const r=Uh(t[s],i[s]);if(r)return r}return ke(t.length,i.length)}function jh(n){return ME(n)}function ME(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=ba(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ia(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return le.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",s=!0;for(const r of t.values||[])s?s=!1:i+=",",i+=ME(r);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${ME(t.fields[o])}`;return s+"}"}(n.mapValue):de()}function sy(n){switch(Ca(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=L_(n);return e?16+sy(e):16;case 5:return 2*n.stringValue.length;case 6:return Ia(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,r)=>s+sy(r),0)}(n.arrayValue);case 10:case 11:return function(i){let s=0;return ja(i.fields,(r,o)=>{s+=r.length+sy(o)}),s}(n.mapValue);default:throw de()}}function DC(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function OE(n){return!!n&&"integerValue"in n}function kS(n){return!!n&&"arrayValue"in n}function MC(n){return!!n&&"nullValue"in n}function OC(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ry(n){return!!n&&"mapValue"in n}function e5(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function mf(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ja(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=mf(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mf(n.arrayValue.values[t]);return e}return Object.assign({},n)}function t5(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.value=e}static empty(){return new Jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ry(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mf(t)}setAll(e){let t=tn.emptyPath(),i={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,s),i={},s=[],t=a.popLast()}o?i[a.lastSegment()]=mf(o):s.push(a.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,i,s)}delete(e){const t=this.field(e.popLast());ry(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];ry(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){ja(t,(s,r)=>e[s]=r);for(const s of i)delete e[s]}clone(){return new Jn(mf(this.value))}}function ZN(n){const e=[];return ja(n.fields,(t,i)=>{const s=new tn([t]);if(ry(i)){const r=ZN(i.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)}),new Ai(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,t,i,s,r,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new An(e,0,pe.min(),pe.min(),pe.min(),Jn.empty(),0)}static newFoundDocument(e,t,i,s){return new An(e,1,t,pe.min(),i,s,0)}static newNoDocument(e,t){return new An(e,2,t,pe.min(),pe.min(),Jn.empty(),0)}static newUnknownDocument(e,t){return new An(e,3,t,pe.min(),pe.min(),Jn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof An&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new An(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,t){this.position=e,this.inclusive=t}}function FC(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const r=e[s],o=n.position[s];if(r.field.isKeyField()?i=le.comparator(le.fromName(o.referenceValue),t.key):i=Uh(o,t.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function VC(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!rr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t="asc"){this.field=e,this.dir=t}}function n5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{}class It extends eL{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new s5(e,t,i):t==="array-contains"?new a5(e,i):t==="in"?new l5(e,i):t==="not-in"?new c5(e,i):t==="array-contains-any"?new u5(e,i):new It(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new r5(e,i):new o5(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Uh(t,this.value)):t!==null&&Ca(this.value)===Ca(t)&&this.matchesComparison(Uh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bs extends eL{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new bs(e,t)}matches(e){return tL(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function tL(n){return n.op==="and"}function nL(n){return i5(n)&&tL(n)}function i5(n){for(const e of n.filters)if(e instanceof bs)return!1;return!0}function FE(n){if(n instanceof It)return n.field.canonicalString()+n.op.toString()+jh(n.value);if(nL(n))return n.filters.map(e=>FE(e)).join(",");{const e=n.filters.map(t=>FE(t)).join(",");return`${n.op}(${e})`}}function iL(n,e){return n instanceof It?function(i,s){return s instanceof It&&i.op===s.op&&i.field.isEqual(s.field)&&rr(i.value,s.value)}(n,e):n instanceof bs?function(i,s){return s instanceof bs&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((r,o,a)=>r&&iL(o,s.filters[a]),!0):!1}(n,e):void de()}function sL(n){return n instanceof It?function(t){return`${t.field.canonicalString()} ${t.op} ${jh(t.value)}`}(n):n instanceof bs?function(t){return t.op.toString()+" {"+t.getFilters().map(sL).join(" ,")+"}"}(n):"Filter"}class s5 extends It{constructor(e,t,i){super(e,t,i),this.key=le.fromName(i.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class r5 extends It{constructor(e,t){super(e,"in",t),this.keys=rL("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class o5 extends It{constructor(e,t){super(e,"not-in",t),this.keys=rL("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function rL(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>le.fromName(i.referenceValue))}class a5 extends It{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kS(t)&&Xf(t.arrayValue,this.value)}}class l5 extends It{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xf(this.value.arrayValue,t)}}class c5 extends It{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Xf(this.value.arrayValue,t)}}class u5 extends It{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kS(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Xf(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t=null,i=[],s=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.ue=null}}function UC(n,e=null,t=[],i=[],s=null,r=null,o=null){return new h5(n,e,t,i,s,r,o)}function xS(n){const e=me(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>FE(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),N_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>jh(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>jh(i)).join(",")),e.ue=t}return e.ue}function PS(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!n5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iL(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!VC(n.startAt,e.startAt)&&VC(n.endAt,e.endAt)}function VE(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,t=null,i=[],s=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function d5(n,e,t,i,s,r,o,a){return new xg(n,e,t,i,s,r,o,a)}function D_(n){return new xg(n)}function jC(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function oL(n){return n.collectionGroup!==null}function yf(n){const e=me(n);if(e.ce===null){e.ce=[];const t=new Set;for(const r of e.explicitOrderBy)e.ce.push(r),t.add(r.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ft(tn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.ce.push(new Ev(r,i))}),t.has(tn.keyField().canonicalString())||e.ce.push(new Ev(tn.keyField(),i))}return e.ce}function ir(n){const e=me(n);return e.le||(e.le=f5(e,yf(n))),e.le}function f5(n,e){if(n.limitType==="F")return UC(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const r=s.dir==="desc"?"asc":"desc";return new Ev(s.field,r)});const t=n.endAt?new wv(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new wv(n.startAt.position,n.startAt.inclusive):null;return UC(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function UE(n,e){const t=n.filters.concat([e]);return new xg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jE(n,e,t){return new xg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function M_(n,e){return PS(ir(n),ir(e))&&n.limitType===e.limitType}function aL(n){return`${xS(ir(n))}|lt:${n.limitType}`}function Bc(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(s=>sL(s)).join(", ")}]`),N_(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(s=>jh(s)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(s=>jh(s)).join(",")),`Target(${i})`}(ir(n))}; limitType=${n.limitType})`}function O_(n,e){return e.isFoundDocument()&&function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):le.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(n,e)&&function(i,s){for(const r of yf(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(n,e)&&function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0}(n,e)&&function(i,s){return!(i.startAt&&!function(o,a,l){const c=FC(o,a,l);return o.inclusive?c<=0:c<0}(i.startAt,yf(i),s)||i.endAt&&!function(o,a,l){const c=FC(o,a,l);return o.inclusive?c>=0:c>0}(i.endAt,yf(i),s))}(n,e)}function p5(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function lL(n){return(e,t)=>{let i=!1;for(const s of yf(n)){const r=g5(s,e,t);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function g5(n,e,t){const i=n.field.isKeyField()?le.comparator(e.key,t.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?Uh(l,c):de()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return de()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ja(this.inner,(t,i)=>{for(const[s,r]of i)e(s,r)})}isEmpty(){return YN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=new ft(le.comparator);function fo(){return m5}const cL=new ft(le.comparator);function Vd(...n){let e=cL;for(const t of n)e=e.insert(t.key,t);return e}function uL(n){let e=cL;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function rl(){return vf()}function hL(){return vf()}function vf(){return new Cc(n=>n.toString(),(n,e)=>n.isEqual(e))}const y5=new ft(le.comparator),v5=new Ft(le.comparator);function Ie(...n){let e=v5;for(const t of n)e=e.add(t);return e}const _5=new Ft(ke);function w5(){return _5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_v(e)?"-0":e}}function dL(n){return{integerValue:""+n}}function E5(n,e){return Xz(e)?dL(e):NS(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(){this._=void 0}}function A5(n,e,t){return n instanceof Av?function(s,r){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&RS(r)&&(r=L_(r)),r&&(o.fields.__previous_value__=r),{mapValue:o}}(t,e):n instanceof Bh?pL(n,e):n instanceof Qf?gL(n,e):function(s,r){const o=fL(s,r),a=BC(o)+BC(s.Pe);return OE(o)&&OE(s.Pe)?dL(a):NS(s.serializer,a)}(n,e)}function T5(n,e,t){return n instanceof Bh?pL(n,e):n instanceof Qf?gL(n,e):t}function fL(n,e){return n instanceof Tv?function(i){return OE(i)||function(r){return!!r&&"doubleValue"in r}(i)}(e)?e:{integerValue:0}:null}class Av extends F_{}class Bh extends F_{constructor(e){super(),this.elements=e}}function pL(n,e){const t=mL(e);for(const i of n.elements)t.some(s=>rr(s,i))||t.push(i);return{arrayValue:{values:t}}}class Qf extends F_{constructor(e){super(),this.elements=e}}function gL(n,e){let t=mL(e);for(const i of n.elements)t=t.filter(s=>!rr(s,i));return{arrayValue:{values:t}}}class Tv extends F_{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function BC(n){return wt(n.integerValue||n.doubleValue)}function mL(n){return kS(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,t){this.field=e,this.transform=t}}function b5(n,e){return n.field.isEqual(e.field)&&function(i,s){return i instanceof Bh&&s instanceof Bh||i instanceof Qf&&s instanceof Qf?Vh(i.elements,s.elements,rr):i instanceof Tv&&s instanceof Tv?rr(i.Pe,s.Pe):i instanceof Av&&s instanceof Av}(n.transform,e.transform)}class I5{constructor(e,t){this.version=e,this.transformResults=t}}class Es{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Es}static exists(e){return new Es(void 0,e)}static updateTime(e){return new Es(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function oy(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class V_{}function yL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _L(n.key,Es.none()):new Pg(n.key,n.data,Es.none());{const t=n.data,i=Jn.empty();let s=new Ft(tn.comparator);for(let r of e.fields)if(!s.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new Ba(n.key,i,new Ai(s.toArray()),Es.none())}}function C5(n,e,t){n instanceof Pg?function(s,r,o){const a=s.value.clone(),l=zC(s.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Ba?function(s,r,o){if(!oy(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=zC(s.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(vL(s)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function _f(n,e,t,i){return n instanceof Pg?function(r,o,a,l){if(!oy(r.precondition,o))return a;const c=r.value.clone(),h=HC(r.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,i):n instanceof Ba?function(r,o,a,l){if(!oy(r.precondition,o))return a;const c=HC(r.fieldTransforms,l,o),h=o.data;return h.setAll(vL(r)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(n,e,t,i):function(r,o,a){return oy(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function R5(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),r=fL(i.transform,s||null);r!=null&&(t===null&&(t=Jn.empty()),t.set(i.field,r))}return t||null}function $C(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Vh(i,s,(r,o)=>b5(r,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Pg extends V_{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ba extends V_{constructor(e,t,i,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function vL(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function zC(n,e,t){const i=new Map;Ve(n.length===t.length);for(let s=0;s<t.length;s++){const r=n[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,T5(o,a,t[s]))}return i}function HC(n,e,t){const i=new Map;for(const s of n){const r=s.transform,o=t.data.field(s.field);i.set(s.field,A5(r,o,e))}return i}class _L extends V_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class k5 extends V_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&C5(r,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_f(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_f(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=hL();return this.mutations.forEach(s=>{const r=e.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=t.has(s.key)?null:a;const l=yL(o,a);l!==null&&i.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ie())}isEqual(e){return this.batchId===e.batchId&&Vh(this.mutations,e.mutations,(t,i)=>$C(t,i))&&Vh(this.baseMutations,e.baseMutations,(t,i)=>$C(t,i))}}class LS{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Ve(e.mutations.length===i.length);let s=function(){return y5}();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new LS(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,xe;function L5(n){switch(n){default:return de();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0}}function wL(n){if(n===void 0)return ho("GRPC error has no .code"),q.UNKNOWN;switch(n){case St.OK:return q.OK;case St.CANCELLED:return q.CANCELLED;case St.UNKNOWN:return q.UNKNOWN;case St.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case St.INTERNAL:return q.INTERNAL;case St.UNAVAILABLE:return q.UNAVAILABLE;case St.UNAUTHENTICATED:return q.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case St.NOT_FOUND:return q.NOT_FOUND;case St.ALREADY_EXISTS:return q.ALREADY_EXISTS;case St.PERMISSION_DENIED:return q.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case St.ABORTED:return q.ABORTED;case St.OUT_OF_RANGE:return q.OUT_OF_RANGE;case St.UNIMPLEMENTED:return q.UNIMPLEMENTED;case St.DATA_LOSS:return q.DATA_LOSS;default:return de()}}(xe=St||(St={}))[xe.OK=0]="OK",xe[xe.CANCELLED=1]="CANCELLED",xe[xe.UNKNOWN=2]="UNKNOWN",xe[xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xe[xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xe[xe.NOT_FOUND=5]="NOT_FOUND",xe[xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",xe[xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",xe[xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",xe[xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xe[xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xe[xe.ABORTED=10]="ABORTED",xe[xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",xe[xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",xe[xe.INTERNAL=13]="INTERNAL",xe[xe.UNAVAILABLE=14]="UNAVAILABLE",xe[xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5=new sc([4294967295,4294967295],0);function qC(n){const e=D5().encode(n),t=new zN;return t.update(e),new Uint8Array(t.digest())}function WC(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new sc([t,i],0),new sc([s,r],0)]}class DS{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ud(`Invalid padding: ${t}`);if(i<0)throw new Ud(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ud(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ud(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=sc.fromNumber(this.Te)}Ee(e,t,i){let s=e.add(t.multiply(sc.fromNumber(i)));return s.compare(M5)===1&&(s=new sc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const t=qC(e),[i,s]=WC(t);for(let r=0;r<this.hashCount;r++){const o=this.Ee(i,s,r);if(!this.de(o))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new DS(r,s,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;const t=qC(e),[i,s]=WC(t);for(let r=0;r<this.hashCount;r++){const o=this.Ee(i,s,r);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Ud extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,t,i,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ng.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new U_(pe.min(),s,new ft(ke),fo(),Ie())}}class Ng{constructor(e,t,i,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ng(i,t,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,t,i,s){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=s}}class EL{constructor(e,t){this.targetId=e,this.me=t}}class AL{constructor(e,t,i=rn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class GC{constructor(){this.fe=0,this.ge=KC(),this.pe=rn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ie(),t=Ie(),i=Ie();return this.ge.forEach((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:de()}}),new Ng(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=KC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ve(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class O5{constructor(e){this.Le=e,this.Be=new Map,this.ke=fo(),this.qe=km(),this.Qe=km(),this.Ke=new ft(ke)}$e(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{const i=this.ze(t);switch(e.state){case 0:this.je(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.je(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),i.De(e.resumeToken));break;default:de()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,s)=>{this.je(s)&&t(s)})}Je(e){const t=e.targetId,i=e.me.count,s=this.Ye(t);if(s){const r=s.target;if(VE(r))if(i===0){const o=new le(r.path);this.We(t,o,An.newNoDocument(o,pe.min()))}else Ve(i===1);else{const o=this.Ze(t);if(o!==i){const a=this.Xe(e),l=a?this.et(a,e,o):1;if(l!==0){this.He(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}}}}}Xe(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=t;let o,a;try{o=Ia(i).toUint8Array()}catch(l){if(l instanceof JN)return Fh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new DS(o,s,r)}catch(l){return Fh(l instanceof Ud?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Te===0?null:a}et(e,t,i){return t.me.count===i-this.rt(e,t.targetId)?0:2}rt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let s=0;return i.forEach(r=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(a)||(this.We(t,r,null),s++)}),s}it(e){const t=new Map;this.Be.forEach((r,o)=>{const a=this.Ye(o);if(a){if(r.current&&VE(a.target)){const l=new le(a.target.path);this.st(l).has(o)||this.ot(o,l)||this.We(o,l,An.newNoDocument(l,e))}r.be&&(t.set(o,r.ve()),r.Ce())}});let i=Ie();this.Qe.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(r))}),this.ke.forEach((r,o)=>o.setReadTime(e));const s=new U_(e,t,this.Ke,this.ke,i);return this.ke=fo(),this.qe=km(),this.Qe=km(),this.Ke=new ft(ke),s}Ue(e,t){if(!this.je(e))return;const i=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,i){if(!this.je(e))return;const s=this.ze(e);this.ot(e,t)?s.Fe(t,1):s.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Be.get(e);return t||(t=new GC,this.Be.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new Ft(ke),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ft(ke),this.qe=this.qe.insert(e,t)),t}je(e){const t=this.Ye(e)!==null;return t||Y("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new GC),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function km(){return new ft(le.comparator)}function KC(){return new ft(le.comparator)}const F5={asc:"ASCENDING",desc:"DESCENDING"},V5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},U5={and:"AND",or:"OR"};class j5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function BE(n,e){return n.useProto3Json||N_(e)?e:{value:e}}function Sv(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function B5(n,e){return Sv(n,e.toTimestamp())}function sr(n){return Ve(!!n),pe.fromTimestamp(function(t){const i=ba(t);return new Ot(i.seconds,i.nanos)}(n))}function MS(n,e){return $E(n,e).canonicalString()}function $E(n,e){const t=function(s){return new Ze(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function SL(n){const e=Ze.fromString(n);return Ve(kL(e)),e}function zE(n,e){return MS(n.databaseId,e.path)}function yw(n,e){const t=SL(e);if(t.get(1)!==n.databaseId.projectId)throw new ee(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ee(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(IL(t))}function bL(n,e){return MS(n.databaseId,e)}function $5(n){const e=SL(n);return e.length===4?Ze.emptyPath():IL(e)}function HE(n){return new Ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function IL(n){return Ve(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function XC(n,e,t){return{name:zE(n,e),fields:t.value.mapValue.fields}}function z5(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:de()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=function(c,h){return c.useProto3Json?(Ve(h===void 0||typeof h=="string"),rn.fromBase64String(h||"")):(Ve(h===void 0||h instanceof Buffer||h instanceof Uint8Array),rn.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?q.UNKNOWN:wL(c.code);return new ee(h,c.message||"")}(o);t=new AL(i,s,r,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=yw(n,i.document.name),r=sr(i.document.updateTime),o=i.document.createTime?sr(i.document.createTime):pe.min(),a=new Jn({mapValue:{fields:i.document.fields}}),l=An.newFoundDocument(s,r,o,a),c=i.targetIds||[],h=i.removedTargetIds||[];t=new ay(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=yw(n,i.document),r=i.readTime?sr(i.readTime):pe.min(),o=An.newNoDocument(s,r),a=i.removedTargetIds||[];t=new ay([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=yw(n,i.document),r=i.removedTargetIds||[];t=new ay([],r,s,null)}else{if(!("filter"in e))return de();{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new N5(s,r),a=i.targetId;t=new EL(a,o)}}return t}function H5(n,e){let t;if(e instanceof Pg)t={update:XC(n,e.key,e.value)};else if(e instanceof _L)t={delete:zE(n,e.key)};else if(e instanceof Ba)t={update:XC(n,e.key,e.data),updateMask:Z5(e.fieldMask)};else{if(!(e instanceof k5))return de();t={verify:zE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(r,o){const a=o.transform;if(a instanceof Av)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Bh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Qf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Tv)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw de()}(0,i))),e.precondition.isNone||(t.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:B5(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:de()}(n,e.precondition)),t}function q5(n,e){return n&&n.length>0?(Ve(e!==void 0),n.map(t=>function(s,r){let o=s.updateTime?sr(s.updateTime):sr(r);return o.isEqual(pe.min())&&(o=sr(r)),new I5(o,s.transformResults||[])}(t,e))):[]}function W5(n,e){return{documents:[bL(n,e.path)]}}function G5(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=bL(n,s);const r=function(c){if(c.length!==0)return RL(bs.create(c,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(h=>function(p){return{field:$c(p.field),direction:Q5(p.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=BE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ct:t,parent:s}}function K5(n){let e=$5(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Ve(i===1);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let r=[];t.where&&(r=function(f){const p=CL(f);return p instanceof bs&&nL(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(y){return new Ev(zc(y.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,N_(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new wv(g,p)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const p=!f.before,g=f.values||[];return new wv(g,p)}(t.endAt)),d5(e,s,o,r,a,"F",l,c)}function X5(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function CL(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=zc(t.unaryFilter.field);return It.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=zc(t.unaryFilter.field);return It.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=zc(t.unaryFilter.field);return It.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=zc(t.unaryFilter.field);return It.create(o,"!=",{nullValue:"NULL_VALUE"});default:return de()}}(n):n.fieldFilter!==void 0?function(t){return It.create(zc(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return de()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return bs.create(t.compositeFilter.filters.map(i=>CL(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return de()}}(t.compositeFilter.op))}(n):de()}function Q5(n){return F5[n]}function Y5(n){return V5[n]}function J5(n){return U5[n]}function $c(n){return{fieldPath:n.canonicalString()}}function zc(n){return tn.fromServerFormat(n.fieldPath)}function RL(n){return n instanceof It?function(t){if(t.op==="=="){if(OC(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NAN"}};if(MC(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(OC(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NOT_NAN"}};if(MC(t.value))return{unaryFilter:{field:$c(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$c(t.field),op:Y5(t.op),value:t.value}}}(n):n instanceof bs?function(t){const i=t.getFilters().map(s=>RL(s));return i.length===1?i[0]:{compositeFilter:{op:J5(t.op),filters:i}}}(n):de()}function Z5(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function kL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t,i,s,r=pe.min(),o=pe.min(),a=rn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ca(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.ht=e}}function t6(n){const e=K5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jE(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(){this.ln=new i6}addToCollectionParentIndex(e,t){return this.ln.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(Sa.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(Sa.min())}updateCollectionGroup(e,t,i){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}}class i6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new Ft(Ze.comparator),r=!s.has(i);return this.index[t]=s.add(i),r}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new Ft(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Xn{static withCacheSize(e){return new Xn(e,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xn.DEFAULT_COLLECTION_PERCENTILE=10,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xn.DEFAULT=new Xn(41943040,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xn.DISABLED=new Xn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new $h(0)}static Qn(){return new $h(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YC([n,e],[t,i]){const s=ke(n,t);return s===0?ke(e,i):s}class s6{constructor(e){this.Gn=e,this.buffer=new Ft(YC),this.zn=0}jn(){return++this.zn}Hn(e){const t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();YC(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class r6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){Y("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){td(t)?Y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ed(t)}await this.Yn(3e5)})}}class o6{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return H.resolve(P_.oe);const i=new s6(t);return this.Zn.forEachTarget(e,s=>i.Hn(s.sequenceNumber)).next(()=>this.Zn.er(e,s=>i.Hn(s))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Zn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(QC)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QC):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let i,s,r,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(i=f,a=Date.now(),this.removeTargets(e,i,t))).next(f=>(r=f,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(f=>(c=Date.now(),jc()<=be.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:f})))}}function a6(n,e){return new o6(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(){this.changes=new Cc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,An.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?H.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(i!==null&&_f(i.mutation,s,Ai.empty(),Ot.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ie()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ie()){const s=rl();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(r=>{let o=Vd();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=rl();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ie()))}populateOverlays(e,t,i){const s=[];return i.forEach(r=>{t.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(e,s).next(r=>{r.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,s){let r=fo();const o=vf(),a=function(){return vf()}();return t.forEach((l,c)=>{const h=i.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof Ba)?r=r.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),_f(h.mutation,c,h.mutation.getFieldMask(),Ot.now())):o.set(c.key,Ai.empty())}),this.recalculateAndSaveOverlays(e,r).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var f;return a.set(c,new c6(h,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const i=vf();let s=new ft((o,a)=>o-a),r=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=i.get(l)||Ai.empty();h=a.applyToLocalView(c,h),i.set(l,h);const f=(s.get(a.batchId)||Ie()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,f=hL();h.forEach(p=>{if(!r.has(p)){const g=yL(t.get(p),i.get(p));g!==null&&f.set(p,g),r=r.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return H.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,s){return function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-r.size):H.resolve(rl());let a=-1,l=r;return o.next(c=>H.forEach(c,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),r.get(h)?H.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,c,r)).next(()=>this.computeViews(e,l,c,Ie())).next(h=>({batchId:a,changes:uL(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next(i=>{let s=Vd();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const r=t.collectionGroup;let o=Vd();return this.indexManager.getCollectionParents(e,r).next(a=>H.forEach(a,l=>{const c=function(f,p){return new xg(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,i,s).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,r,s))).next(o=>{r.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,An.newInvalidDocument(h)))});let a=Vd();return o.forEach((l,c)=>{const h=r.get(l);h!==void 0&&_f(h.mutation,c,Ai.empty(),Ot.now()),O_(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return H.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:sr(s.createTime)}}(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(s){return{name:s.name,query:t6(s.bundledQuery),readTime:sr(s.readTime)}}(t)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.overlays=new ft(le.comparator),this.Er=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){const i=rl();return H.forEach(t,s=>this.getOverlay(e,s).next(r=>{r!==null&&i.set(s,r)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,r)=>{this.Tt(e,t,r)}),H.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Er.get(i);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.Er.delete(i)),H.resolve()}getOverlaysForCollection(e,t,i){const s=rl(),r=t.length+1,o=new le(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>i&&s.set(l.getKey(),l)}return H.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let r=new ft((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>i){let h=r.get(c.largestBatchId);h===null&&(h=rl(),r=r.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=rl(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return H.resolve(a)}Tt(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.Er.get(s.largestBatchId).delete(i.key);this.Er.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new P5(t,i));let r=this.Er.get(t);r===void 0&&(r=Ie(),this.Er.set(t,r)),this.Er.set(t,r.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(){this.dr=new Ft(zt.Ar),this.Rr=new Ft(zt.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,t){const i=new zt(e,t);this.dr=this.dr.add(i),this.Rr=this.Rr.add(i)}mr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.gr(new zt(e,t))}pr(e,t){e.forEach(i=>this.removeReference(i,t))}yr(e){const t=new le(new Ze([])),i=new zt(t,e),s=new zt(t,e+1),r=[];return this.Rr.forEachInRange([i,s],o=>{this.gr(o),r.push(o.key)}),r}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const t=new le(new Ze([])),i=new zt(t,e),s=new zt(t,e+1);let r=Ie();return this.Rr.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new zt(e,0),i=this.dr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class zt{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return le.comparator(e.key,t.key)||ke(e.br,t.br)}static Vr(e,t){return ke(e.br,t.br)||le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new Ft(zt.Ar)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const r=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new x5(r,t,i,s);this.mutationQueue.push(o);for(const a of s)this.vr=this.vr.add(new zt(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,t){return H.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.Fr(i),r=s<0?0:s;return H.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new zt(t,0),s=new zt(t,Number.POSITIVE_INFINITY),r=[];return this.vr.forEachInRange([i,s],o=>{const a=this.Cr(o.br);r.push(a)}),H.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ft(ke);return t.forEach(s=>{const r=new zt(s,0),o=new zt(s,Number.POSITIVE_INFINITY);this.vr.forEachInRange([r,o],a=>{i=i.add(a.br)})}),H.resolve(this.Mr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let r=i;le.isDocumentKey(r)||(r=r.child(""));const o=new zt(new le(r),0);let a=new Ft(ke);return this.vr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.br)),!0)},o),H.resolve(this.Mr(a))}Mr(e){const t=[];return e.forEach(i=>{const s=this.Cr(i);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ve(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.vr;return H.forEach(t.mutations,s=>{const r=new zt(s.key,t.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.vr=i})}Ln(e){}containsKey(e,t){const i=new zt(t,0),s=this.vr.firstAfterOrEqual(i);return H.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.Nr=e,this.docs=function(){return new ft(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),r=s?s.size:0,o=this.Nr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return H.resolve(i?i.document.mutableCopy():An.newInvalidDocument(t))}getEntries(e,t){let i=fo();return t.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():An.newInvalidDocument(s))}),H.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let r=fo();const o=t.path,a=new le(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||qz(Hz(h),i)<=0||(s.has(h.key)||O_(t,h))&&(r=r.insert(h.key,h.mutableCopy()))}return H.resolve(r)}getAllFromCollectionGroup(e,t,i,s){de()}Lr(e,t){return H.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new m6(this)}getSize(e){return H.resolve(this.size)}}class m6 extends l6{constructor(e){super(),this.hr=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.hr.addEntry(e,s)):this.hr.removeEntry(i)}),H.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.persistence=e,this.Br=new Cc(t=>xS(t),PS),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.kr=0,this.qr=new OS,this.targetCount=0,this.Qr=$h.qn()}forEachTarget(e,t){return this.Br.forEach((i,s)=>t(s)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.kr&&(this.kr=t),H.resolve()}Un(e){this.Br.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Qr=new $h(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.Un(t),H.resolve()}removeTargetData(e,t){return this.Br.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,t,i){let s=0;const r=[];return this.Br.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.Br.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),H.waitFor(r).next(()=>s)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){const i=this.Br.get(t)||null;return H.resolve(i)}addMatchingKeys(e,t,i){return this.qr.mr(t,i),H.resolve()}removeMatchingKeys(e,t,i){this.qr.pr(t,i);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach(o=>{r.push(s.markPotentiallyOrphaned(e,o))}),H.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),H.resolve()}getMatchingKeysForTargetId(e,t){const i=this.qr.Sr(t);return H.resolve(i)}containsKey(e,t){return H.resolve(this.qr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,t){this.Kr={},this.overlays={},this.$r=new P_(0),this.Ur=!1,this.Ur=!0,this.Wr=new f6,this.referenceDelegate=e(this),this.Gr=new y6(this),this.indexManager=new n6,this.remoteDocumentCache=function(s){return new g6(s)}(i=>this.referenceDelegate.zr(i)),this.serializer=new e6(t),this.jr=new h6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new d6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Kr[e.toKey()];return i||(i=new p6(t,this.referenceDelegate),this.Kr[e.toKey()]=i),i}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,i){Y("MemoryPersistence","Starting transaction:",e);const s=new v6(this.$r.next());return this.referenceDelegate.Hr(),i(s).next(r=>this.referenceDelegate.Jr(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}Yr(e,t){return H.or(Object.values(this.Kr).map(i=>()=>i.containsKey(e,t)))}}class v6 extends Gz{constructor(e){super(),this.currentSequenceNumber=e}}class FS{constructor(e){this.persistence=e,this.Zr=new OS,this.Xr=null}static ei(e){return new FS(e)}get ti(){if(this.Xr)return this.Xr;throw de()}addReference(e,t,i){return this.Zr.addReference(i,t),this.ti.delete(i.toString()),H.resolve()}removeReference(e,t,i){return this.Zr.removeReference(i,t),this.ti.add(i.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),H.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(s=>this.ti.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(r=>this.ti.add(r.toString()))}).next(()=>i.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.ti,i=>{const s=le.fromPath(i);return this.ni(e,s).next(r=>{r||t.removeEntry(s,pe.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(i=>{i?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return H.or([()=>H.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}}class bv{constructor(e,t){this.persistence=e,this.ri=new Cc(i=>Qz(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=a6(this,t)}static ei(e,t){return new bv(e,t)}Hr(){}Jr(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){const t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}nr(e){let t=0;return this.er(e,i=>{t++}).next(()=>t)}er(e,t){return H.forEach(this.ri,(i,s)=>this.ir(e,i,s).next(r=>r?H.resolve():t(s)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.Lr(e,o=>this.ir(e,o,t).next(a=>{a||(i++,r.removeEntry(o,pe.min()))})).next(()=>r.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),H.resolve()}removeReference(e,t,i){return this.ri.set(i,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),H.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sy(e.data.value)),t}ir(e,t,i){return H.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.ri.get(t);return H.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Wi=i,this.Gi=s}static zi(e,t){let i=Ie(),s=Ie();for(const r of t.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new VS(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return D4()?8:Kz(bn())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,i,s){const r={result:null};return this.Xi(e,t).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.es(e,t,s,i).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new _6;return this.ts(e,t,o).next(a=>{if(r.result=a,this.Hi)return this.ns(e,t,o,a.size)})}).next(()=>r.result)}ns(e,t,i,s){return i.documentReadCount<this.Ji?(jc()<=be.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",Bc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),H.resolve()):(jc()<=be.DEBUG&&Y("QueryEngine","Query:",Bc(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Yi*s?(jc()<=be.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",Bc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ir(t))):H.resolve())}Xi(e,t){if(jC(t))return H.resolve(null);let i=ir(t);return this.indexManager.getIndexType(e,i).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=jE(t,null,"F"),i=ir(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(r=>{const o=Ie(...r);return this.Zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const c=this.rs(t,a);return this.ss(t,c,o,l.readTime)?this.Xi(e,jE(t,null,"F")):this.os(e,c,t,l)}))})))}es(e,t,i,s){return jC(t)||s.isEqual(pe.min())?H.resolve(null):this.Zi.getDocuments(e,i).next(r=>{const o=this.rs(t,r);return this.ss(t,o,i,s)?H.resolve(null):(jc()<=be.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Bc(t)),this.os(e,o,t,zz(s,-1)).next(a=>a))})}rs(e,t){let i=new Ft(lL(e));return t.forEach((s,r)=>{O_(e,r)&&(i=i.add(r))}),i}ss(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}ts(e,t,i){return jc()<=be.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",Bc(t)),this.Zi.getDocumentsMatchingQuery(e,t,Sa.min(),i)}os(e,t,i,s){return this.Zi.getDocumentsMatchingQuery(e,i,s).next(r=>(t.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,t,i,s){this.persistence=e,this._s=t,this.serializer=s,this.us=new ft(ke),this.cs=new Cc(r=>xS(r),PS),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(i)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new u6(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}}function A6(n,e,t,i){return new E6(n,e,t,i)}async function PL(n,e){const t=me(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(r=>(s=r,t.Ps(e),t.mutationQueue.getAllMutationBatches(i))).next(r=>{const o=[],a=[];let l=Ie();for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(c=>({Ts:c,removedBatchIds:o,addedBatchIds:a}))})})}function T6(n,e){const t=me(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),r=t.hs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const f=c.batch,p=f.keys();let g=H.resolve();return p.forEach(y=>{g=g.next(()=>h.getEntry(l,y)).next(_=>{const A=c.docVersions.get(y);Ve(A!==null),_.version.compareTo(A)<0&&(f.applyToRemoteDocument(_,c),_.isValidDocument()&&(_.setReadTime(c.commitVersion),h.addEntry(_)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,i,e,r).next(()=>r.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=Ie();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}function NL(n){const e=me(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function S6(n,e){const t=me(n),i=e.snapshotVersion;let s=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.hs.newChangeBuffer({trackRemovals:!0});s=t.us;const a=[];e.targetChanges.forEach((h,f)=>{const p=s.get(f);if(!p)return;a.push(t.Gr.removeMatchingKeys(r,h.removedDocuments,f).next(()=>t.Gr.addMatchingKeys(r,h.addedDocuments,f)));let g=p.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(rn.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,i)),s=s.insert(f,g),function(_,A,v){return _.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,g,h)&&a.push(t.Gr.updateTargetData(r,g))});let l=fo(),c=Ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(b6(r,o,e.documentUpdates).next(h=>{l=h.Is,c=h.Es})),!i.isEqual(pe.min())){const h=t.Gr.getLastRemoteSnapshotVersion(r).next(f=>t.Gr.setTargetsMetadata(r,r.currentSequenceNumber,i));a.push(h)}return H.waitFor(a).next(()=>o.apply(r)).next(()=>t.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(t.us=s,r))}function b6(n,e,t){let i=Ie(),s=Ie();return t.forEach(r=>i=i.add(r)),e.getEntries(n,i).next(r=>{let o=fo();return t.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Is:o,Es:s}})}function I6(n,e){const t=me(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function C6(n,e){const t=me(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.Gr.getTargetData(i,e).next(r=>r?(s=r,H.resolve(s)):t.Gr.allocateTargetId(i).next(o=>(s=new ca(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Gr.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.us.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.us=t.us.insert(i.targetId,i),t.cs.set(e,i.targetId)),i})}async function qE(n,e,t){const i=me(n),s=i.us.get(e),r=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!td(o))throw o;Y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.us=i.us.remove(e),i.cs.delete(s.target)}function JC(n,e,t){const i=me(n);let s=pe.min(),r=Ie();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const f=me(l),p=f.cs.get(h);return p!==void 0?H.resolve(f.us.get(p)):f.Gr.getTargetData(c,h)}(i,o,ir(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Gr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>i._s.getDocumentsMatchingQuery(o,e,t?s:pe.min(),t?r:Ie())).next(a=>(R6(i,p5(e),a),{documents:a,ds:r})))}function R6(n,e,t){let i=n.ls.get(e)||pe.min();t.forEach((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)}),n.ls.set(e,i)}class ZC{constructor(){this.activeTargetIds=w5()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class k6{constructor(){this._o=new ZC,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,i){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new ZC,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){Y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){Y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xm=null;function vw(){return xm===null?xm=function(){return 268435456+Math.round(2147483648*Math.random())}():xm++,"0x"+xm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class L6 extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Fo=i+"://"+t.host,this.Mo=`projects/${s}/databases/${r}`,this.xo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Oo(t,i,s,r,o){const a=vw(),l=this.No(t,i.toUriEncodedString());Y("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(c,r,o),this.Bo(t,l,c,s).then(h=>(Y("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Fh("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",s),h})}ko(t,i,s,r,o,a){return this.Oo(t,i,s,r,o)}Lo(t,i,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zh}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((r,o)=>t[o]=r),s&&s.headers.forEach((r,o)=>t[o]=r)}No(t,i){const s=P6[t];return`${this.Fo}/v1/${i}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,t,i,s){const r=vw();return new Promise((o,a)=>{const l=new HN;l.setWithCredentials(!0),l.listenOnce(qN.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case iy.NO_ERROR:const h=l.getResponseJson();Y(hn,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(h)),o(h);break;case iy.TIMEOUT:Y(hn,`RPC '${e}' ${r} timed out`),a(new ee(q.DEADLINE_EXCEEDED,"Request time out"));break;case iy.HTTP_ERROR:const f=l.getStatus();if(Y(hn,`RPC '${e}' ${r} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(A){const v=A.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(v)>=0?v:q.UNKNOWN}(g.status);a(new ee(y,g.message))}else a(new ee(q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ee(q.UNAVAILABLE,"Connection failed."));break;default:de()}}finally{Y(hn,`RPC '${e}' ${r} completed.`)}});const c=JSON.stringify(s);Y(hn,`RPC '${e}' ${r} sending request:`,s),l.send(t,"POST",c,i,15)})}qo(e,t,i){const s=vw(),r=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=KN(),a=GN(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const h=r.join("");Y(hn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=o.createWebChannel(h,l);let p=!1,g=!1;const y=new N6({Eo:A=>{g?Y(hn,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(p||(Y(hn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),Y(hn,`RPC '${e}' stream ${s} sending:`,A),f.send(A))},Ao:()=>f.close()}),_=(A,v,E)=>{A.listen(v,S=>{try{E(S)}catch(P){setTimeout(()=>{throw P},0)}})};return _(f,Fd.EventType.OPEN,()=>{g||(Y(hn,`RPC '${e}' stream ${s} transport opened.`),y.So())}),_(f,Fd.EventType.CLOSE,()=>{g||(g=!0,Y(hn,`RPC '${e}' stream ${s} transport closed`),y.Do())}),_(f,Fd.EventType.ERROR,A=>{g||(g=!0,Fh(hn,`RPC '${e}' stream ${s} transport errored:`,A),y.Do(new ee(q.UNAVAILABLE,"The operation could not be completed")))}),_(f,Fd.EventType.MESSAGE,A=>{var v;if(!g){const E=A.data[0];Ve(!!E);const S=E,P=(S==null?void 0:S.error)||((v=S[0])===null||v===void 0?void 0:v.error);if(P){Y(hn,`RPC '${e}' stream ${s} received error:`,P);const O=P.status;let F=function(k){const L=St[k];if(L!==void 0)return wL(L)}(O),I=P.message;F===void 0&&(F=q.INTERNAL,I="Unknown error status: "+O+" with message "+P.message),g=!0,y.Do(new ee(F,I)),f.close()}else Y(hn,`RPC '${e}' stream ${s} received:`,E),y.vo(E)}}),_(a,WN.STAT_EVENT,A=>{A.stat===DE.PROXY?Y(hn,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===DE.NOPROXY&&Y(hn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.bo()},0),y}}function _w(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(n){return new j5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,t,i=1e3,s=1.5,r=6e4){this.li=e,this.timerId=t,this.Qo=i,this.Ko=s,this.$o=r,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const t=Math.floor(this.Uo+this.Ho()),i=Math.max(0,Date.now()-this.Go),s=Math.max(0,t-i);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,s,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e,t,i,s,r,o,a,l){this.li=e,this.Yo=i,this.Zo=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new LL(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,t){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(ho(t.toString()),ho("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(t)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.Xo===t&&this.I_(i,s)},i=>{e(()=>{const s=new ee(q.UNKNOWN,"Fetching auth token failed: "+i.message);return this.E_(s)})})}I_(e,t){const i=this.T_(this.Xo);this.stream=this.d_(e,t),this.stream.Ro(()=>{i(()=>this.listener.Ro())}),this.stream.mo(()=>{i(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(s=>{i(()=>this.E_(s))}),this.stream.onMessage(s=>{i(()=>++this.n_==1?this.A_(s):this.onNext(s))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return Y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(Y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class D6 extends DL{constructor(e,t,i,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,o),this.serializer=r}d_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const t=z5(this.serializer,e),i=function(r){if(!("targetChange"in r))return pe.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?sr(o.readTime):pe.min()}(e);return this.listener.R_(t,i)}V_(e){const t={};t.database=HE(this.serializer),t.addTarget=function(r,o){let a;const l=o.target;if(a=VE(l)?{documents:W5(r,l)}:{query:G5(r,l).ct},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=TL(r,o.resumeToken);const c=BE(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=Sv(r,o.snapshotVersion.toTimestamp());const c=BE(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const i=X5(this.serializer,e);i&&(t.labels=i),this.c_(t)}m_(e){const t={};t.database=HE(this.serializer),t.removeTarget=e,this.c_(t)}}class M6 extends DL{constructor(e,t,i,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,o),this.serializer=r}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,t){return this.connection.qo("Write",e,t)}A_(e){return Ve(!!e.streamToken),this.lastStreamToken=e.streamToken,Ve(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){Ve(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const t=q5(e.writeResults,e.commitTime),i=sr(e.commitTime);return this.listener.y_(i,t)}w_(){const e={};e.database=HE(this.serializer),this.c_(e)}g_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>H5(this.serializer,i))};this.c_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6 extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.S_=!1}b_(){if(this.S_)throw new ee(q.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,i,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Oo(e,$E(t,i),s,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new ee(q.UNKNOWN,r.toString())})}ko(e,t,i,s,r){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.ko(e,$E(t,i),s,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ee(q.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class F6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(ho(t),this.C_=!1):Y("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e,t,i,s,r){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=r,this.Q_.uo(o=>{i.enqueueAndForget(async()=>{Rc(this)&&(Y("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=me(l);c.k_.add(4),await Lg(c),c.K_.set("Unknown"),c.k_.delete(4),await B_(c)}(this))})}),this.K_=new F6(i,s)}}async function B_(n){if(Rc(n))for(const e of n.q_)await e(!0)}async function Lg(n){for(const e of n.q_)await e(!1)}function ML(n,e){const t=me(n);t.B_.has(e.targetId)||(t.B_.set(e.targetId,e),$S(t)?BS(t):nd(t).s_()&&jS(t,e))}function US(n,e){const t=me(n),i=nd(t);t.B_.delete(e),i.s_()&&OL(t,e),t.B_.size===0&&(i.s_()?i.a_():Rc(t)&&t.K_.set("Unknown"))}function jS(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nd(n).V_(e)}function OL(n,e){n.U_.xe(e),nd(n).m_(e)}function BS(n){n.U_=new O5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.B_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),nd(n).start(),n.K_.F_()}function $S(n){return Rc(n)&&!nd(n).i_()&&n.B_.size>0}function Rc(n){return me(n).k_.size===0}function FL(n){n.U_=void 0}async function U6(n){n.K_.set("Online")}async function j6(n){n.B_.forEach((e,t)=>{jS(n,e)})}async function B6(n,e){FL(n),$S(n)?(n.K_.O_(e),BS(n)):n.K_.set("Unknown")}async function $6(n,e,t){if(n.K_.set("Online"),e instanceof AL&&e.state===2&&e.cause)try{await async function(s,r){const o=r.cause;for(const a of r.targetIds)s.B_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.B_.delete(a),s.U_.removeTarget(a))}(n,e)}catch(i){Y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Iv(n,i)}else if(e instanceof ay?n.U_.$e(e):e instanceof EL?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(pe.min()))try{const i=await NL(n.localStore);t.compareTo(i)>=0&&await function(r,o){const a=r.U_.it(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=r.B_.get(c);h&&r.B_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=r.B_.get(l);if(!h)return;r.B_.set(l,h.withResumeToken(rn.EMPTY_BYTE_STRING,h.snapshotVersion)),OL(r,l);const f=new ca(h.target,l,c,h.sequenceNumber);jS(r,f)}),r.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(i){Y("RemoteStore","Failed to raise snapshot:",i),await Iv(n,i)}}async function Iv(n,e,t){if(!td(e))throw e;n.k_.add(1),await Lg(n),n.K_.set("Offline"),t||(t=()=>NL(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Y("RemoteStore","Retrying IndexedDB access"),await t(),n.k_.delete(1),await B_(n)})}function VL(n,e){return e().catch(t=>Iv(n,t,e))}async function $_(n){const e=me(n),t=Ra(e);let i=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;z6(e);)try{const s=await I6(e.localStore,i);if(s===null){e.L_.length===0&&t.a_();break}i=s.batchId,H6(e,s)}catch(s){await Iv(e,s)}UL(e)&&jL(e)}function z6(n){return Rc(n)&&n.L_.length<10}function H6(n,e){n.L_.push(e);const t=Ra(n);t.s_()&&t.f_&&t.g_(e.mutations)}function UL(n){return Rc(n)&&!Ra(n).i_()&&n.L_.length>0}function jL(n){Ra(n).start()}async function q6(n){Ra(n).w_()}async function W6(n){const e=Ra(n);for(const t of n.L_)e.g_(t.mutations)}async function G6(n,e,t){const i=n.L_.shift(),s=LS.from(i,e,t);await VL(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await $_(n)}async function K6(n,e){e&&Ra(n).f_&&await async function(i,s){if(function(o){return L5(o)&&o!==q.ABORTED}(s.code)){const r=i.L_.shift();Ra(i).__(),await VL(i,()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s)),await $_(i)}}(n,e),UL(n)&&jL(n)}async function tR(n,e){const t=me(n);t.asyncQueue.verifyOperationInProgress(),Y("RemoteStore","RemoteStore received new credentials");const i=Rc(t);t.k_.add(3),await Lg(t),i&&t.K_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),await B_(t)}async function X6(n,e){const t=me(n);e?(t.k_.delete(2),await B_(t)):e||(t.k_.add(2),await Lg(t),t.K_.set("Unknown"))}function nd(n){return n.W_||(n.W_=function(t,i,s){const r=me(t);return r.b_(),new D6(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(n.datastore,n.asyncQueue,{Ro:U6.bind(null,n),mo:j6.bind(null,n),po:B6.bind(null,n),R_:$6.bind(null,n)}),n.q_.push(async e=>{e?(n.W_.__(),$S(n)?BS(n):n.K_.set("Unknown")):(await n.W_.stop(),FL(n))})),n.W_}function Ra(n){return n.G_||(n.G_=function(t,i,s){const r=me(t);return r.b_(),new M6(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:q6.bind(null,n),po:K6.bind(null,n),p_:W6.bind(null,n),y_:G6.bind(null,n)}),n.q_.push(async e=>{e?(n.G_.__(),await $_(n)):(await n.G_.stop(),n.L_.length>0&&(Y("RemoteStore",`Stopping write stream with ${n.L_.length} pending writes`),n.L_=[]))})),n.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,t,i,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new to,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,r){const o=Date.now()+i,a=new zS(e,t,o,s,r);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ee(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function HS(n,e){if(ho("AsyncQueue",`${e}: ${n}`),td(n))return new ee(q.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{static emptySet(e){return new Eu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||le.comparator(t.key,i.key):(t,i)=>le.comparator(t.key,i.key),this.keyedMap=Vd(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Eu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Eu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(){this.z_=new ft(le.comparator)}track(e){const t=e.doc.key,i=this.z_.get(t);i?e.type!==0&&i.type===3?this.z_=this.z_.insert(t,e):e.type===3&&i.type!==1?this.z_=this.z_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.z_=this.z_.remove(t):e.type===1&&i.type===2?this.z_=this.z_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):de():this.z_=this.z_.insert(t,e)}j_(){const e=[];return this.z_.inorderTraversal((t,i)=>{e.push(i)}),e}}class zh{constructor(e,t,i,s,r,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,i,s,r){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new zh(e,t,Eu.emptySet(t),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&M_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class Y6{constructor(){this.queries=iR(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,i){const s=me(t),r=s.queries;s.queries=iR(),r.forEach((o,a)=>{for(const l of a.J_)l.onError(i)})})(this,new ee(q.ABORTED,"Firestore shutting down"))}}function iR(){return new Cc(n=>aL(n),M_)}async function qS(n,e){const t=me(n);let i=3;const s=e.query;let r=t.queries.get(s);r?!r.Y_()&&e.Z_()&&(i=2):(r=new Q6,i=e.Z_()?0:1);try{switch(i){case 0:r.H_=await t.onListen(s,!0);break;case 1:r.H_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=HS(o,`Initialization of query '${Bc(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,r),r.J_.push(e),e.ea(t.onlineState),r.H_&&e.ta(r.H_)&&GS(t)}async function WS(n,e){const t=me(n),i=e.query;let s=3;const r=t.queries.get(i);if(r){const o=r.J_.indexOf(e);o>=0&&(r.J_.splice(o,1),r.J_.length===0?s=e.Z_()?0:1:!r.Y_()&&e.Z_()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function J6(n,e){const t=me(n);let i=!1;for(const s of e){const r=s.query,o=t.queries.get(r);if(o){for(const a of o.J_)a.ta(s)&&(i=!0);o.H_=s}}i&&GS(t)}function Z6(n,e,t){const i=me(n),s=i.queries.get(e);if(s)for(const r of s.J_)r.onError(t);i.queries.delete(e)}function GS(n){n.X_.forEach(e=>{e.next()})}var WE,sR;(sR=WE||(WE={})).na="default",sR.Cache="cache";class KS{constructor(e,t,i){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=i||{}}ta(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new zh(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;const i=t!=="Offline";return(!this.options.ua||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=zh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==WE.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e){this.key=e}}class $L{constructor(e){this.key=e}}class eH{constructor(e,t){this.query=e,this.da=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=Ie(),this.mutatedKeys=Ie(),this.Va=lL(e),this.ma=new Eu(this.Va)}get fa(){return this.da}ga(e,t){const i=t?t.pa:new nR,s=t?t.ma:this.ma;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const p=s.get(h),g=O_(this.query,f)?f:null,y=!!p&&this.mutatedKeys.has(p.key),_=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let A=!1;p&&g?p.data.isEqual(g.data)?y!==_&&(i.track({type:3,doc:g}),A=!0):this.ya(p,g)||(i.track({type:2,doc:g}),A=!0,(l&&this.Va(g,l)>0||c&&this.Va(g,c)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),A=!0):p&&!g&&(i.track({type:1,doc:p}),A=!0,(l||c)&&(a=!0)),A&&(g?(o=o.add(g),r=_?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),i.track({type:1,doc:h})}return{ma:o,pa:i,ss:a,mutatedKeys:r}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const r=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((h,f)=>function(g,y){const _=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de()}};return _(g)-_(y)}(h.type,f.type)||this.Va(h.doc,f.doc)),this.wa(i),s=s!=null&&s;const a=t&&!s?this.Sa():[],l=this.Ra.size===0&&this.current&&!s?1:0,c=l!==this.Aa;return this.Aa=l,o.length!==0||c?{snapshot:new zh(this.query,e.ma,r,o,e.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),ba:a}:{ba:a}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new nR,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.da=this.da.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.da=this.da.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=Ie(),this.ma.forEach(i=>{this.Da(i.key)&&(this.Ra=this.Ra.add(i.key))});const t=[];return e.forEach(i=>{this.Ra.has(i)||t.push(new $L(i))}),this.Ra.forEach(i=>{e.has(i)||t.push(new BL(i))}),t}va(e){this.da=e.ds,this.Ra=Ie();const t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return zh.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class tH{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class nH{constructor(e){this.key=e,this.Fa=!1}}class iH{constructor(e,t,i,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new Cc(a=>aL(a),M_),this.Oa=new Map,this.Na=new Set,this.La=new ft(le.comparator),this.Ba=new Map,this.ka=new OS,this.qa={},this.Qa=new Map,this.Ka=$h.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function sH(n,e,t=!0){const i=KL(n);let s;const r=i.xa.get(e);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.Ca()):s=await zL(i,e,t,!0),s}async function rH(n,e){const t=KL(n);await zL(t,e,!0,!1)}async function zL(n,e,t,i){const s=await C6(n.localStore,ir(e)),r=s.targetId,o=n.sharedClientState.addLocalQueryTarget(r,t);let a;return i&&(a=await oH(n,e,r,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&ML(n.remoteStore,s),a}async function oH(n,e,t,i,s){n.Ua=(f,p,g)=>async function(_,A,v,E){let S=A.view.ga(v);S.ss&&(S=await JC(_.localStore,A.query,!1).then(({documents:I})=>A.view.ga(I,S)));const P=E&&E.targetChanges.get(A.targetId),O=E&&E.targetMismatches.get(A.targetId)!=null,F=A.view.applyChanges(S,_.isPrimaryClient,P,O);return oR(_,A.targetId,F.ba),F.snapshot}(n,f,p,g);const r=await JC(n.localStore,e,!0),o=new eH(e,r.ds),a=o.ga(r.documents),l=Ng.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);oR(n,t,c.ba);const h=new tH(e,t,o);return n.xa.set(e,h),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),c.snapshot}async function aH(n,e,t){const i=me(n),s=i.xa.get(e),r=i.Oa.get(s.targetId);if(r.length>1)return i.Oa.set(s.targetId,r.filter(o=>!M_(o,e))),void i.xa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await qE(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),t&&US(i.remoteStore,s.targetId),GE(i,s.targetId)}).catch(ed)):(GE(i,s.targetId),await qE(i.localStore,s.targetId,!0))}async function lH(n,e){const t=me(n),i=t.xa.get(e),s=t.Oa.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),US(t.remoteStore,i.targetId))}async function cH(n,e,t){const i=mH(n);try{const s=await function(o,a){const l=me(o),c=Ot.now(),h=a.reduce((g,y)=>g.add(y.key),Ie());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=fo(),_=Ie();return l.hs.getEntries(g,h).next(A=>{y=A,y.forEach((v,E)=>{E.isValidDocument()||(_=_.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(A=>{f=A;const v=[];for(const E of a){const S=R5(E,f.get(E.key).overlayedDocument);S!=null&&v.push(new Ba(E.key,S,ZN(S.value.mapValue),Es.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,v,a)}).next(A=>{p=A;const v=A.applyToLocalDocumentSet(f,_);return l.documentOverlayCache.saveOverlays(g,A.batchId,v)})}).then(()=>({batchId:p.batchId,changes:uL(f)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.qa[o.currentUser.toKey()];c||(c=new ft(ke)),c=c.insert(a,l),o.qa[o.currentUser.toKey()]=c}(i,s.batchId,t),await Dg(i,s.changes),await $_(i.remoteStore)}catch(s){const r=HS(s,"Failed to persist write");t.reject(r)}}async function HL(n,e){const t=me(n);try{const i=await S6(t.localStore,e);e.targetChanges.forEach((s,r)=>{const o=t.Ba.get(r);o&&(Ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Fa=!0:s.modifiedDocuments.size>0?Ve(o.Fa):s.removedDocuments.size>0&&(Ve(o.Fa),o.Fa=!1))}),await Dg(t,i,e)}catch(i){await ed(i)}}function rR(n,e,t){const i=me(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.xa.forEach((r,o)=>{const a=o.view.ea(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=me(o);l.onlineState=a;let c=!1;l.queries.forEach((h,f)=>{for(const p of f.J_)p.ea(a)&&(c=!0)}),c&&GS(l)}(i.eventManager,e),s.length&&i.Ma.R_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function uH(n,e,t){const i=me(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Ba.get(e),r=s&&s.key;if(r){let o=new ft(le.comparator);o=o.insert(r,An.newNoDocument(r,pe.min()));const a=Ie().add(r),l=new U_(pe.min(),new Map,new ft(ke),o,a);await HL(i,l),i.La=i.La.remove(r),i.Ba.delete(e),XS(i)}else await qE(i.localStore,e,!1).then(()=>GE(i,e,t)).catch(ed)}async function hH(n,e){const t=me(n),i=e.batch.batchId;try{const s=await T6(t.localStore,e);WL(t,i,null),qL(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Dg(t,s)}catch(s){await ed(s)}}async function dH(n,e,t){const i=me(n);try{const s=await function(o,a){const l=me(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Ve(f!==null),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(i.localStore,e);WL(i,e,t),qL(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Dg(i,s)}catch(s){await ed(s)}}function qL(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function WL(n,e,t){const i=me(n);let s=i.qa[i.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),i.qa[i.currentUser.toKey()]=s}}function GE(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Oa.get(e))n.xa.delete(i),t&&n.Ma.Wa(i,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(i=>{n.ka.containsKey(i)||GL(n,i)})}function GL(n,e){n.Na.delete(e.path.canonicalString());const t=n.La.get(e);t!==null&&(US(n.remoteStore,t),n.La=n.La.remove(e),n.Ba.delete(t),XS(n))}function oR(n,e,t){for(const i of t)i instanceof BL?(n.ka.addReference(i.key,e),fH(n,i)):i instanceof $L?(Y("SyncEngine","Document no longer in limbo: "+i.key),n.ka.removeReference(i.key,e),n.ka.containsKey(i.key)||GL(n,i.key)):de()}function fH(n,e){const t=e.key,i=t.path.canonicalString();n.La.get(t)||n.Na.has(i)||(Y("SyncEngine","New document in limbo: "+t),n.Na.add(i),XS(n))}function XS(n){for(;n.Na.size>0&&n.La.size<n.maxConcurrentLimboResolutions;){const e=n.Na.values().next().value;n.Na.delete(e);const t=new le(Ze.fromString(e)),i=n.Ka.next();n.Ba.set(i,new nH(t)),n.La=n.La.insert(t,i),ML(n.remoteStore,new ca(ir(D_(t.path)),i,"TargetPurposeLimboResolution",P_.oe))}}async function Dg(n,e,t){const i=me(n),s=[],r=[],o=[];i.xa.isEmpty()||(i.xa.forEach((a,l)=>{o.push(i.Ua(l,e,t).then(c=>{var h;if((c||t)&&i.isPrimaryClient){const f=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;i.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=VS.zi(l.targetId,c);r.push(f)}}))}),await Promise.all(o),i.Ma.R_(s),await async function(l,c){const h=me(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>H.forEach(c,p=>H.forEach(p.Wi,g=>h.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>H.forEach(p.Gi,g=>h.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!td(f))throw f;Y("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const p=f.targetId;if(!f.fromCache){const g=h.us.get(p),y=g.snapshotVersion,_=g.withLastLimboFreeSnapshotVersion(y);h.us=h.us.insert(p,_)}}}(i.localStore,r))}async function pH(n,e){const t=me(n);if(!t.currentUser.isEqual(e)){Y("SyncEngine","User change. New user:",e.toKey());const i=await PL(t.localStore,e);t.currentUser=e,function(r,o){r.Qa.forEach(a=>{a.forEach(l=>{l.reject(new ee(q.CANCELLED,o))})}),r.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Dg(t,i.Ts)}}function gH(n,e){const t=me(n),i=t.Ba.get(e);if(i&&i.Fa)return Ie().add(i.key);{let s=Ie();const r=t.Oa.get(e);if(!r)return s;for(const o of r){const a=t.xa.get(o);s=s.unionWith(a.view.fa)}return s}}function KL(n){const e=me(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=HL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uH.bind(null,e),e.Ma.R_=J6.bind(null,e.eventManager),e.Ma.Wa=Z6.bind(null,e.eventManager),e}function mH(n){const e=me(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dH.bind(null,e),e}class Cv{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=j_(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,t){return null}Ya(e,t){return null}Ha(e){return A6(this.persistence,new w6,e.initialUser,this.serializer)}ja(e){return new xL(FS.ei,this.serializer)}za(e){return new k6}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Cv.provider={build:()=>new Cv};class yH extends Cv{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){Ve(this.persistence.referenceDelegate instanceof bv);const i=this.persistence.referenceDelegate.garbageCollector;return new r6(i,e.asyncQueue,t)}ja(e){const t=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new xL(i=>bv.ei(i,t),this.serializer)}}class KE{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>rR(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=pH.bind(null,this.syncEngine),await X6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Y6}()}createDatastore(e){const t=j_(e.databaseInfo.databaseId),i=function(r){return new L6(r)}(e.databaseInfo);return function(r,o,a,l){return new O6(r,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,s,r,o,a){return new V6(i,s,r,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>rR(this.syncEngine,t,0),function(){return eR.p()?new eR:new x6}())}createSyncEngine(e,t){return function(s,r,o,a,l,c,h){const f=new iH(s,r,o,a,l,c);return h&&(f.$a=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const r=me(s);Y("RemoteStore","RemoteStore shutting down."),r.k_.add(5),await Lg(r),r.Q_.shutdown(),r.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}KE.provider={build:()=>new KE};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):ho("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vH{constructor(e,t,i,s,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=_n.UNAUTHENTICATED,this.clientId=QN.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,async o=>{Y("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(Y("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new to;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=HS(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function ww(n,e){n.asyncQueue.verifyOperationInProgress(),Y("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async s=>{i.isEqual(s)||(await PL(e.localStore,s),i=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function aR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _H(n);Y("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>tR(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>tR(e.remoteStore,s)),n._onlineComponents=e}async function _H(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Y("FirestoreClient","Using user provided OfflineComponentProvider");try{await ww(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===q.FAILED_PRECONDITION||s.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Fh("Error using user provided cache. Falling back to memory cache: "+t),await ww(n,new Cv)}}else Y("FirestoreClient","Using default OfflineComponentProvider"),await ww(n,new yH(void 0));return n._offlineComponents}async function XL(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Y("FirestoreClient","Using user provided OnlineComponentProvider"),await aR(n,n._uninitializedComponentsProvider._online)):(Y("FirestoreClient","Using default OnlineComponentProvider"),await aR(n,new KE))),n._onlineComponents}function wH(n){return XL(n).then(e=>e.syncEngine)}async function Rv(n){const e=await XL(n),t=e.eventManager;return t.onListen=sH.bind(null,e.syncEngine),t.onUnlisten=aH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=rH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=lH.bind(null,e.syncEngine),t}function EH(n,e,t={}){const i=new to;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new QS({next:p=>{h.eu(),o.enqueueAndForget(()=>WS(r,f));const g=p.docs.has(a);!g&&p.fromCache?c.reject(new ee(q.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?c.reject(new ee(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new KS(D_(a.path),h,{includeMetadataChanges:!0,ua:!0});return qS(r,f)}(await Rv(n),n.asyncQueue,e,t,i)),i.promise}function AH(n,e,t={}){const i=new to;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,c){const h=new QS({next:p=>{h.eu(),o.enqueueAndForget(()=>WS(r,f)),p.fromCache&&l.source==="server"?c.reject(new ee(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new KS(a,h,{includeMetadataChanges:!0,ua:!0});return qS(r,f)}(await Rv(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QL(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(n,e,t){if(!t)throw new ee(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function TH(n,e,t,i){if(e===!0&&i===!0)throw new ee(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function cR(n){if(!le.isDocumentKey(n))throw new ee(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function uR(n){if(le.isDocumentKey(n))throw new ee(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function z_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":de()}function bi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ee(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=z_(n);throw new ee(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new ee(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ee(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QL((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ee(q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ee(q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ee(q.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class H_{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hR({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ee(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ee(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hR(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Dz;switch(i.type){case"firstParty":return new Vz(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ee(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=lR.get(t);i&&(Y("ComponentProvider","Removing Datastore"),lR.delete(t),i.terminate())}(this),Promise.resolve()}}function SH(n,e,t,i={}){var s;const r=(n=bi(n,H_))._getSettings(),o=`${e}:${t}`;if(r.host!=="firestore.googleapis.com"&&r.host!==o&&Fh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=_n.MOCK_USER;else{a=xP(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new ee(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new _n(c)}n._authCredentials=new Mz(new XN(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new kc(this.firestore,e,this._query)}}class Tn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}}class wa extends kc{constructor(e,t,i){super(e,t,D_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new le(e))}withConverter(e){return new wa(this.firestore,e,this._path)}}function JL(n,e,...t){if(n=yt(n),YL("collection","path",e),n instanceof H_){const i=Ze.fromString(e,...t);return uR(i),new wa(n,null,i)}{if(!(n instanceof Tn||n instanceof wa))throw new ee(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ze.fromString(e,...t));return uR(i),new wa(n.firestore,null,i)}}function id(n,e,...t){if(n=yt(n),arguments.length===1&&(e=QN.newId()),YL("doc","path",e),n instanceof H_){const i=Ze.fromString(e,...t);return cR(i),new Tn(n,null,new le(i))}{if(!(n instanceof Tn||n instanceof wa))throw new ee(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ze.fromString(e,...t));return cR(i),new Tn(n.firestore,n instanceof wa?n.converter:null,new le(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new LL(this,"async_queue_retry"),this.fu=()=>{const i=_w();i&&Y("AsyncQueue","Visibility state changed to "+i.visibilityState),this.r_.Jo()},this.gu=e;const t=_w();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const t=_w();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const t=new to;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!td(e))throw e;Y("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const t=this.gu.then(()=>(this.Ru=!0,e().catch(i=>{this.Au=i,this.Ru=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw ho("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.Ru=!1,i))));return this.gu=t,t}enqueueAfterDelay(e,t,i){this.pu(),this.mu.indexOf(e)>-1&&(t=0);const s=zS.createAndSchedule(this,e,t,i,r=>this.Su(r));return this.du.push(s),s}pu(){this.Au&&de()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.du)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const t=this.du.indexOf(e);this.du.splice(t,1)}}function fR(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const r of i)if(r in s&&typeof s[r]=="function")return!0;return!1}(n,["next","error","complete"])}class ka extends H_{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new dR,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dR(e),this._firestoreClient=void 0,await e}}}function bH(n,e){const t=typeof n=="object"?n:b_(),i=typeof n=="string"?n:"(default)",s=Fa(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=CP("firestore");r&&SH(s,...r)}return s}function q_(n){if(n._terminated)throw new ee(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||IH(n),n._firestoreClient}function IH(n){var e,t,i;const s=n._freezeSettings(),r=function(a,l,c,h){return new Zz(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,QL(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new vH(n._authCredentials,n._appCheckCredentials,n._queue,r,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hh(rn.fromBase64String(e))}catch(t){throw new ee(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Hh(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ee(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ee(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ee(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ke(this._lat,e._lat)||ke(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CH=/^__.*__$/;class RH{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ba(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pg(e,this.data,t,this.fieldTransforms)}}class ZL{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ba(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function e2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de()}}class K_{constructor(e,t,i,s,r,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Fu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new K_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.xu({path:i,Nu:!1});return s.Lu(e),s}Bu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.xu({path:i,Nu:!1});return s.Fu(),s}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return kv(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(e2(this.Mu)&&CH.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class kH{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||j_(e)}$u(e,t,i,s=!1){return new K_({Mu:e,methodName:t,Ku:i,path:tn.emptyPath(),Nu:!1,Qu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function X_(n){const e=n._freezeSettings(),t=j_(n._databaseId);return new kH(n._databaseId,!!e.ignoreUndefinedProperties,t)}function t2(n,e,t,i,s,r={}){const o=n.$u(r.merge||r.mergeFields?2:0,e,t,s);eb("Data must be an object, but it was:",o,i);const a=n2(i,o);let l,c;if(r.merge)l=new Ai(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const f of r.mergeFields){const p=XE(e,f,t);if(!o.contains(p))throw new ee(q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);s2(h,p)||h.push(p)}l=new Ai(h),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new RH(new Jn(a),l,c)}class Q_ extends G_{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Q_}}function xH(n,e,t){return new K_({Mu:3,Ku:e.settings.Ku,methodName:n._methodName,Nu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ZS extends G_{constructor(e,t){super(e),this.Uu=t}_toFieldTransform(e){const t=xH(this,e,!0),i=this.Uu.map(r=>sd(r,t)),s=new Bh(i);return new S5(e.path,s)}isEqual(e){return e instanceof ZS&&Oh(this.Uu,e.Uu)}}function PH(n,e,t,i){const s=n.$u(1,e,t);eb("Data must be an object, but it was:",s,i);const r=[],o=Jn.empty();ja(i,(l,c)=>{const h=tb(e,l,t);c=yt(c);const f=s.Bu(h);if(c instanceof Q_)r.push(h);else{const p=sd(c,f);p!=null&&(r.push(h),o.set(h,p))}});const a=new Ai(r);return new ZL(o,a,s.fieldTransforms)}function NH(n,e,t,i,s,r){const o=n.$u(1,e,t),a=[XE(e,i,t)],l=[s];if(r.length%2!=0)throw new ee(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<r.length;p+=2)a.push(XE(e,r[p])),l.push(r[p+1]);const c=[],h=Jn.empty();for(let p=a.length-1;p>=0;--p)if(!s2(c,a[p])){const g=a[p];let y=l[p];y=yt(y);const _=o.Bu(g);if(y instanceof Q_)c.push(g);else{const A=sd(y,_);A!=null&&(c.push(g),h.set(g,A))}}const f=new Ai(c);return new ZL(h,f,o.fieldTransforms)}function LH(n,e,t,i=!1){return sd(t,n.$u(i?4:3,e))}function sd(n,e){if(i2(n=yt(n)))return eb("Unsupported field value:",e,n),n2(n,e);if(n instanceof G_)return function(i,s){if(!e2(s.Mu))throw s.qu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.qu(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(i,s){const r=[];let o=0;for(const a of i){let l=sd(a,s.ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(n,e)}return function(i,s){if((i=yt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return E5(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=Ot.fromDate(i);return{timestampValue:Sv(s.serializer,r)}}if(i instanceof Ot){const r=new Ot(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Sv(s.serializer,r)}}if(i instanceof YS)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Hh)return{bytesValue:TL(s.serializer,i._byteString)};if(i instanceof Tn){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:MS(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof JS)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.qu("VectorValues must only contain numeric values.");return NS(a.serializer,l)})}}}}}}(i,s);throw s.qu(`Unsupported field value: ${z_(i)}`)}(n,e)}function n2(n,e){const t={};return YN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ja(n,(i,s)=>{const r=sd(s,e.Ou(i));r!=null&&(t[i]=r)}),{mapValue:{fields:t}}}function i2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ot||n instanceof YS||n instanceof Hh||n instanceof Tn||n instanceof G_||n instanceof JS)}function eb(n,e,t){if(!i2(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const i=z_(t);throw i==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+i)}}function XE(n,e,t){if((e=yt(e))instanceof W_)return e._internalPath;if(typeof e=="string")return tb(n,e);throw kv("Field path arguments must be of type string or ",n,!1,void 0,t)}const DH=new RegExp("[~\\*/\\[\\]]");function tb(n,e,t){if(e.search(DH)>=0)throw kv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new W_(...e.split("."))._internalPath}catch{throw kv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function kv(n,e,t,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${i}`),o&&(l+=` in document ${s}`),l+=")"),new ee(q.INVALID_ARGUMENT,a+n+l)}function s2(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,t,i,s,r){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(nb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class MH extends r2{data(){return super.data()}}function nb(n,e){return typeof e=="string"?tb(n,e):e instanceof W_?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ee(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ib{}class OH extends ib{}function FH(n,e,...t){let i=[];e instanceof ib&&i.push(e),i=i.concat(t),function(r){const o=r.filter(l=>l instanceof sb).length,a=r.filter(l=>l instanceof Y_).length;if(o>1||o>0&&a>0)throw new ee(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)n=s._apply(n);return n}class Y_ extends OH{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Y_(e,t,i)}_apply(e){const t=this._parse(e);return a2(e._query,t),new kc(e.firestore,e.converter,UE(e._query,t))}_parse(e){const t=X_(e.firestore);return function(r,o,a,l,c,h,f){let p;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ee(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){gR(f,h);const g=[];for(const y of f)g.push(pR(l,r,y));p={arrayValue:{values:g}}}else p=pR(l,r,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||gR(f,h),p=LH(a,o,f,h==="in"||h==="not-in");return It.create(c,h,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function VH(n,e,t){const i=e,s=nb("where",n);return Y_._create(s,i,t)}class sb extends ib{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sb(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:bs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,r){let o=s;const a=r.getFlattenedFilters();for(const l of a)a2(o,l),o=UE(o,l)}(e._query,t),new kc(e.firestore,e.converter,UE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function pR(n,e,t){if(typeof(t=yt(t))=="string"){if(t==="")throw new ee(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oL(e)&&t.indexOf("/")!==-1)throw new ee(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ze.fromString(t));if(!le.isDocumentKey(i))throw new ee(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return DC(n,new le(i))}if(t instanceof Tn)return DC(n,t._key);throw new ee(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${z_(t)}.`)}function gR(n,e){if(!Array.isArray(n)||n.length===0)throw new ee(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function a2(n,e){const t=function(s,r){for(const o of s)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ee(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ee(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class UH{convertValue(e,t="none"){switch(Ca(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ia(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw de()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ja(e,(s,r)=>{i[s]=this.convertValue(r,t)}),i}convertVectorValue(e){var t,i,s;const r=(s=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(o=>wt(o.doubleValue));return new JS(r)}convertGeoPoint(e){return new YS(wt(e.latitude),wt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=L_(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Gf(e));default:return null}}convertTimestamp(e){const t=ba(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ze.fromString(e);Ve(kL(i));const s=new Kf(i.get(1),i.get(3)),r=new le(i.popFirst(5));return s.isEqual(t)||ho(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l2(n,e,t){let i;return i=n?n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class c2 extends r2{constructor(e,t,i,s,r,o){super(e,t,i,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ly(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(nb("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class ly extends c2{data(e={}){return super.data(e)}}class u2{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new jd(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new ly(this._firestore,this._userDataWriter,i.key,i,new jd(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ee(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new ly(s._firestore,s._userDataWriter,a.doc.key,a.doc,new jd(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new ly(s._firestore,s._userDataWriter,a.doc.key,a.doc,new jd(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:jH(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function jH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(n){n=bi(n,Tn);const e=bi(n.firestore,ka);return EH(q_(e),n._key).then(t=>d2(e,n,t))}class rb extends UH{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,t)}}function BH(n){n=bi(n,kc);const e=bi(n.firestore,ka),t=q_(e),i=new rb(e);return o2(n._query),AH(t,n._query).then(s=>new u2(e,i,n,s))}function $H(n,e,t){n=bi(n,Tn);const i=bi(n.firestore,ka),s=l2(n.converter,e);return ob(i,[t2(X_(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Es.none())])}function zH(n,e,t,...i){n=bi(n,Tn);const s=bi(n.firestore,ka),r=X_(s);let o;return o=typeof(e=yt(e))=="string"||e instanceof W_?NH(r,"updateDoc",n._key,e,t,i):PH(r,"updateDoc",n._key,e),ob(s,[o.toMutation(n._key,Es.exists(!0))])}function HH(n,e){const t=bi(n.firestore,ka),i=id(n),s=l2(n.converter,e);return ob(t,[t2(X_(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Es.exists(!1))]).then(()=>i)}function qH(n,...e){var t,i,s;n=yt(n);let r={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||fR(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(fR(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(i=f.error)===null||i===void 0?void 0:i.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,h;if(n instanceof Tn)c=bi(n.firestore,ka),h=D_(n._key.path),l={next:f=>{e[o]&&e[o](d2(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=bi(n,kc);c=bi(f.firestore,ka),h=f._query;const p=new rb(c);l={next:g=>{e[o]&&e[o](new u2(c,p,f,g))},error:e[o+1],complete:e[o+2]},o2(n._query)}return function(p,g,y,_){const A=new QS(_),v=new KS(g,A,y);return p.asyncQueue.enqueueAndForget(async()=>qS(await Rv(p),v)),()=>{A.eu(),p.asyncQueue.enqueueAndForget(async()=>WS(await Rv(p),v))}}(q_(c),h,a,l)}function ob(n,e){return function(i,s){const r=new to;return i.asyncQueue.enqueueAndForget(async()=>cH(await wH(i),s,r)),r.promise}(q_(n),e)}function d2(n,e,t){const i=t.docs.get(e._key),s=new rb(n);return new c2(n,s,e._key,i,new jd(t.hasPendingWrites,t.fromCache),e.converter)}function WH(...n){return new ZS("arrayUnion",n)}(function(e,t=!0){(function(s){Zh=s})(bc),Ts(new Ki("firestore",(i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new ka(new Oz(i.getProvider("auth-internal")),new jz(i.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ee(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kf(c.options.projectId,h)}(o,s),o);return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),ii(RC,"4.7.5",e),ii(RC,"4.7.5","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2="firebasestorage.googleapis.com",GH="storageBucket",KH=2*60*1e3,XH=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends Xi{constructor(e,t,i=0){super(Ew(e),`Firebase Storage: ${t} (${Ew(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ur.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ew(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var or;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(or||(or={}));function Ew(n){return"storage/"+n}function QH(){const n="An unknown error occurred, please check the error payload for server response.";return new ur(or.UNKNOWN,n)}function YH(){return new ur(or.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function JH(){return new ur(or.CANCELED,"User canceled the upload/download.")}function ZH(n){return new ur(or.INVALID_URL,"Invalid URL '"+n+"'.")}function e9(n){return new ur(or.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function mR(n){return new ur(or.INVALID_ARGUMENT,n)}function p2(){return new ur(or.APP_DELETED,"The Firebase app was deleted.")}function t9(n){return new ur(or.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ys.makeFromUrl(e,t)}catch{return new ys(e,"")}if(i.path==="")return i;throw e9(e)}static makeFromUrl(e,t){let i=null;const s="([A-Za-z0-9.\\-_]+)";function r(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${s}/o${p}`,"i"),y={bucket:1,path:3},_=t===f2?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",v=new RegExp(`^https?://${_}/${s}/${A}`,"i"),S=[{regex:a,indices:l,postModify:r},{regex:g,indices:y,postModify:c},{regex:v,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<S.length;P++){const O=S[P],F=O.regex.exec(e);if(F){const I=F[O.indices.bucket];let b=F[O.indices.path];b||(b=""),i=new ys(I,b),O.postModify(i);break}}if(i==null)throw ZH(e);return i}}class n9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i9(n,e,t){let i=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function h(...A){c||(c=!0,e.apply(null,A))}function f(A){s=setTimeout(()=>{s=null,n(g,l())},A)}function p(){r&&clearTimeout(r)}function g(A,...v){if(c){p();return}if(A){p(),h.call(null,A,...v);return}if(l()||o){p(),h.call(null,A,...v);return}i<64&&(i*=2);let S;a===1?(a=2,S=0):S=(i+Math.random())*1e3,f(S)}let y=!1;function _(A){y||(y=!0,p(),!c&&(s!==null?(A||(a=2),clearTimeout(s),f(0)):A||(a=1)))}return f(0),r=setTimeout(()=>{o=!0,_(!0)},t),_}function s9(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r9(n){return n!==void 0}function yR(n,e,t,i){if(i<e)throw mR(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw mR(`Invalid value for '${n}'. Expected ${t} or less.`)}function o9(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const s=e(i)+"="+e(n[i]);t=t+s+"&"}return t=t.slice(0,-1),t}var xv;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(xv||(xv={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,r=e.indexOf(n)!==-1;return t||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,t,i,s,r,o,a,l,c,h,f,p=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,y)=>{this.resolve_=g,this.reject_=y,this.start_()})}start_(){const e=(i,s)=>{if(s){i(!1,new Pm(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===xv.NO_ERROR,l=r.getStatus();if(!a||a9(l,this.additionalRetryCodes_)&&this.retry){const h=r.getErrorCode()===xv.ABORT;i(!1,new Pm(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new Pm(c,r))})},t=(i,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());r9(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=QH();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?p2():JH();o(l)}else{const l=YH();o(l)}};this.canceled_?t(!1,new Pm(!1,null,!0)):this.backoffId_=i9(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&s9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Pm{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function c9(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function u9(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function h9(n,e){e&&(n["X-Firebase-GMPID"]=e)}function d9(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function f9(n,e,t,i,s,r,o=!0){const a=o9(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return h9(c,e),c9(c,t),u9(c,r),d9(c,i),new l9(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p9(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function g9(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,t){this._service=e,t instanceof ys?this._location=t:this._location=ys.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Pv(e,t)}get root(){const e=new ys(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return g9(this._location.path)}get storage(){return this._service}get parent(){const e=p9(this._location.path);if(e===null)return null;const t=new ys(this._location.bucket,e);return new Pv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw t9(e)}}function vR(n,e){const t=e==null?void 0:e[GH];return t==null?null:ys.makeFromBucketSpec(t,n)}function m9(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:xP(s,n.app.options.projectId))}class y9{constructor(e,t,i,s,r){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=s,this._firebaseVersion=r,this._bucket=null,this._host=f2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=KH,this._maxUploadRetryTime=XH,this._requests=new Set,s!=null?this._bucket=ys.makeFromBucketSpec(s,this._host):this._bucket=vR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ys.makeFromBucketSpec(this._url,e):this._bucket=vR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Pv(this,e)}_makeRequest(e,t,i,s,r=!0){if(this._deleted)return new n9(p2());{const o=f9(e,this._appId,i,s,t,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,s).getPromise()}}const _R="@firebase/storage",wR="0.13.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="storage";function v9(n=b_(),e){n=yt(n);const i=Fa(n,g2).getImmediate({identifier:e}),s=CP("storage");return s&&_9(i,...s),i}function _9(n,e,t,i={}){m9(n,e,t,i)}function w9(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new y9(t,i,s,e,bc)}function E9(){Ts(new Ki(g2,w9,"PUBLIC").setMultipleInstances(!0)),ii(_R,wR,""),ii(_R,wR,"esm2017")}E9();const A9={apiKey:"AIzaSyCVZB-8IqigB4p4xlH3Y6YKsRq6H6xBYaU",authDomain:"learn-in-comfort.firebaseapp.com",projectId:"learn-in-comfort",storageBucket:"learn-in-comfort.firebasestorage.app",messagingSenderId:"840297023552",appId:"1:840297023552:web:dd561495ae5b928adef7a5",measurementId:"G-GMYJ7M1JNQ"},J_=FP(A9);xz(J_);const Nm=h$(J_),xc=bH(J_);v9(J_);const T9=n=>n.exists(),S9=(n,e)=>new Promise(async(t,i)=>{try{const s=id(xc,n,e),r=await h2(s);t(T9(r))}catch(s){console.error(s),i(s)}}),m2=n=>({...n.data(),docId:n.id}),b9=n=>{const e=[];return n.forEach(t=>{e.push({...t.data(),docId:t.id})}),e},ab=(n,e)=>new Promise(async(t,i)=>{try{const s=id(xc,n,e),r=await h2(s);t(m2(r))}catch(s){console.error(s),i(s)}}),lb=(n,e)=>new Promise(async(t,i)=>{try{const s=JL(xc,n),r=await HH(s,e);t(r.id)}catch(s){console.error(s),i(s)}}),I9=(n,e,t)=>new Promise(async(i,s)=>{try{const r=id(xc,n,e),o=await $H(r,t);i(o)}catch(r){console.error(r),s(r)}}),Mg=(n,e,t)=>new Promise(async(i,s)=>{try{const r=id(xc,n,e),o=await zH(r,t);i(o)}catch(r){console.error(r),s(r)}}),C9=(n,e,t)=>new Promise(async(i,s)=>{try{const r=JL(xc,n),o=FH(r,VH(e,"==",t)),a=await BH(o);i(b9(a))}catch(r){console.error(r),s(r)}}),R9=async(n,e,t)=>{const i=id(xc,n,e);qH(i,s=>{t(m2(s))})},k9=(n,e,t,i)=>new Promise(async(s,r)=>{try{if(!i)throw new Error("No UID supplied");await I9("Account",i,{firstname:n,lastname:e,email:t,photoURL:"https://th.bing.com/th/id/R.7837ddb38ea25f397aa93039c9591124?rik=t75EwMa7SryjBQ&pid=ImgRaw&r=0",createdAt:new Date}),s()}catch(o){console.error(o),r(o)}}),x9=(n,e)=>new Promise(async(t,i)=>{try{await Mg("Account",n,e),t()}catch(s){console.error(s),i(s)}}),P9=n=>new Promise(async(e,t)=>{try{const i=await ab("Account",n);e(i)}catch(i){console.error(i),t(i)}}),N9=(n,e)=>{R9("Account",n,e)};let qh=!1,zr=0,rc=[],L9="UK English Male",Hr=null;const cy=(n,e)=>{(!rc.length||n!==rc.join(" "))&&(rc=n.split(" "),zr=0),qh?cb(e):y2(0,e)},y2=(n,e)=>{zr=n;const t=rc.slice(zr).join(" ");console.log("Speaking"),console.log(t),Hr&&clearInterval(Hr),responsiveVoice.speak(t,L9,{onstart:()=>{Hr=setInterval(()=>{zr<rc.length-1&&zr++},500)},onend:()=>{clearInterval(Hr),Hr=null,zr=0,qh=!1,rc=[],e&&e()}})},D9=()=>{responsiveVoice.isPlaying()&&(responsiveVoice.cancel(),qh=!0,clearInterval(Hr),Hr=null)},cb=n=>{console.log(zr),console.log("jgjgj"),y2(zr,n),qh=!1},Nv=()=>{(responsiveVoice.isPlaying()||qh)&&(responsiveVoice.cancel(),qh=!1,zr=0,rc=[],clearInterval(Hr),Hr=null)},v2=U.createContext(),M9=({children:n})=>{const e=mo(),t=Tc(),[i,s]=U.useState(void 0),[r,o]=U.useState(null);U.useEffect(()=>{if(e.pathname!==Yn.authPage.baseUrl)switch(console.log(i),i){case null:Mh("auth-loader"),t(Yn.authPage.baseUrl);break;case void 0:$f("auth-loader");break;default:Mh("auth-loader")}},[i,e]),U.useEffect(()=>{Z3(Nm,h=>{s(h)})},[]),U.useEffect(()=>{i&&N9(i.uid,h=>o(h))},[i]),U.useEffect(()=>{e.pathname!==Yn.lecturePage.baseUrl&&Nv()},[e]);const a=({email:h,password:f,firstname:p,lastname:g},y)=>new Promise(async(_,A)=>{try{y(!0);const v=await X3(Nm,h,f);await k9(p,g,h,v.user.uid),s(v.user),_()}catch(v){console.error(v),A(v)}finally{y(!1)}}),l=({email:h,password:f},p)=>new Promise(async(g,y)=>{try{p(!0);const _=await Q3(Nm,h,f);s(_.user),g()}catch(_){console.error(_),y(_)}finally{p(!1)}}),c=()=>{eB(Nm)};return N.jsx(v2.Provider,{value:{userCredential:i,userLiveData:r,signup:a,login:l,signout:c},children:n})},Og=()=>U.useContext(v2),_2="/assets/loading-nfpo5gY-.gif",O9=({type:n,isLoading:e,text:t,loadingText:i,onClick:s,className:r})=>e?N.jsxs("button",{className:`loading-btn ${r}`,children:[N.jsx("img",{src:_2,alt:""}),i]}):N.jsx("button",{type:n,onClick:s,className:`Button ${r}`,children:t}),F9=()=>{const n=Tc(),{signup:e,login:t}=Og(),[i,s]=U.useState(!0),[r,o]=U.useState(!1),[a,l]=U.useState({firstname:"",lastname:"",email:"",password:""}),[c,h]=U.useState({email:"",password:""}),f=async g=>{try{g.preventDefault();const{firstname:y,lastname:_,email:A,password:v}=a;if(!y||!_||!A||!v)return he.error("Supply all information");await e(a,o),he("Accont Successfully created"),he(`Welcome, ${_} ${y}`),n(Yn.dashboardPage.baseUrla)}catch(y){if(console.error(y),y.message.includes("auth/email-already-in-use"))return he.error("Your account already exists");he.error("Couldn't create an account")}},p=async g=>{try{g.preventDefault();const{email:y,password:_}=c;if(console.log(c),!y||!_)return he.error("Supply all information");await t(c,o),he("Account successfully validated"),n(Yn.dashboardPage.baseUrl)}catch(y){if(console.error(y),y.message.includes("auth/invalid-credential"))return he.error("Wrong credentials");he.error("Couldn't verify your information")}};return N.jsx("div",{className:"AuthenticationPage drop-animation",children:N.jsxs("div",{className:"auth-container",children:[N.jsx("img",{src:hS,alt:"Logo",className:"auth-logo"}),N.jsx("h2",{className:"auth-text",children:i?"Login to your account":"Create an Account"}),N.jsxs("div",{className:"auth-action",children:[N.jsx("div",{className:`auth-login ${i?"auth-active":""}`,onClick:!r&&(()=>s(!0)),children:N.jsx("p",{children:"Login"})}),N.jsx("span",{children:"|"}),N.jsx("div",{className:`auth-sign-up ${i?"":"auth-active"}`,onClick:!r&&(()=>s(!1)),children:N.jsx("p",{children:"Signup"})})]}),N.jsxs("form",{className:"auth-form auth-form-login",children:[N.jsxs("div",{className:"form-block",children:[!i&&N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"name-block w-full",children:[N.jsx("input",{type:"text",placeholder:"Firstname",className:"auth-fname",value:a.firstname,onChange:g=>l({...a,firstname:g.target.value})}),N.jsx("input",{type:"text",placeholder:"Lastname",className:"auth-lname",value:a.lastname,onChange:g=>l({...a,lastname:g.target.value})})]}),N.jsx("input",{type:"email",placeholder:"Email",className:"auth-email shrink-0",value:a.email,onChange:g=>l({...a,email:g.target.value})}),N.jsx("input",{type:"password",placeholder:"Password",className:"auth-password  shrink-0",value:a.password,onChange:g=>l({...a,password:g.target.value})})]}),i&&N.jsxs(N.Fragment,{children:[N.jsx("input",{type:"email",placeholder:"Email",className:"auth-email  shrink-0",value:c.email,onChange:g=>h({...c,email:g.target.value})}),N.jsx("input",{type:"password",placeholder:"Password",className:"auth-password  shrink-0",value:c.password,onChange:g=>h({...c,password:g.target.value})})]})]}),N.jsx("div",{className:"btn-block",children:N.jsx(O9,{isLoading:r,loadingText:"Verifying Account",className:"auth-btn-submit",onClick:i?p:f,text:i?"Login":"Create an account"})})]})]})})},mc=()=>N.jsx("div",{className:"LoadingComponent",children:N.jsx("img",{src:_2,alt:""})}),V9=({lecture:n,onSelectLectureIndex:e,selectedLectureIndex:t})=>n?N.jsxs("div",{className:"CourseOutline fade-right",children:[N.jsxs("div",{className:"heading flex justify-between items-center",children:[N.jsx("p",{children:"Course outline"}),N.jsx("i",{className:"fa-regular fa-face-shush",onClick:()=>Nv()})]}),N.jsx("div",{className:"outline-list",children:n.outline.map((i,s)=>N.jsxs("div",{className:"outline-item "+(i.covered&&"covered-item ")+(t===s&&"selected-item"),onClick:()=>e(s),children:[N.jsx("i",{className:"fa-solid fa-caret-right"}),N.jsx("p",{children:i==null?void 0:i.title})]}))})]}):N.jsx(mc,{}),U9=({onShowQuestionBox:n,lectureData:e,currentIndex:t,onNextOutline:i,onAddPoint:s})=>{const r=U.useRef(null),[o,a]=U.useState([]);return U.useEffect(()=>{var l,c,h;return a([]),(l=r==null?void 0:r.current)==null||l.forEach(clearTimeout),r.current=[],(h=(c=e==null?void 0:e.outline[t])==null?void 0:c.powerPoint)==null||h.forEach(f=>{const p=setTimeout(()=>{a(g=>[...g,f.data])},f.time);r.current.push(p)}),()=>{r.current.forEach(clearTimeout)}},[e]),e?N.jsxs("div",{className:"PresentationPreview flex flex-col",children:[N.jsxs("div",{className:"heading w-full flex items-center justify-between",children:[N.jsxs("div",{className:"left-box flex items-center",children:[N.jsx("i",{className:"fa-solid fa-brain"}),N.jsxs("p",{children:[(e==null?void 0:e.assimilation)||0,"%"]})]}),N.jsxs("div",{className:"right-box flex gap-4",children:[N.jsxs("button",{className:"btn-2 rest",onClick:()=>{var l;cy((l=e==null?void 0:e.outline[t])==null?void 0:l.explanation)},children:["Restart Lecture ",N.jsx("i",{className:"fa-solid fa-rotate"})]}),N.jsxs("button",{className:"btn-2 quest",onClick:n,children:["Ask a question ",N.jsx("i",{className:"fa-solid fa-question"})]}),N.jsxs("button",{className:"btn-2 understand",onClick:i,children:["I understand",N.jsx("i",{className:"fa-solid fa-check ml-2"})]})]})]}),N.jsxs("div",{className:"body flex flex-col gap-1",children:[N.jsx("p",{className:"title mb-1",children:e==null?void 0:e.outline[t||0].title}),N.jsx("div",{className:"flex flex-col gap-3 power-point-wrapper",children:o.length>0?N.jsx(N.Fragment,{children:o.map(l=>N.jsx(j9,{point:l,onClick:()=>{he.success("Successfully added"),s(l)}}))}):N.jsx(mc,{})})]})]}):N.jsx(mc,{})},j9=({point:n,onClick:e})=>N.jsxs("div",{className:"PowerPoint fade-up",children:[N.jsxs("div",{className:"left",children:[N.jsx("i",{className:"fa-solid fa-diamond"}),N.jsx("p",{children:n||"--Empty--"})]}),N.jsx("div",{className:"right",children:N.jsx("i",{className:"fa-solid fa-download",onClick:e,title:"Add point to notepad"})})]}),B9=({notepad:n,onAddPoint:e,onMaxNotes:t,maxNotepad:i,setMaxNotepad:s,notepadRef:r,onDeletePoint:o})=>{const[a,l]=U.useState(""),c=U.useRef(null);return U.useEffect(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[n]),n?N.jsxs("div",{className:"NotepadPreview",children:[N.jsxs("div",{className:"heading flex items-center justify-between",children:[N.jsx("p",{children:"Notes"}),i?N.jsx("i",{className:"fa-light fa-chevron-down",onClick:()=>s(!1)}):N.jsx("i",{className:"fa-light fa-chevron-up",onClick:()=>s(!0)})]}),N.jsx("div",{className:"body mt-2",ref:c,children:n==null?void 0:n.map((h,f)=>N.jsx($9,{point:h,onDeletePoint:()=>o(f),onEditPoint:()=>{l(h),o(f)}}))}),N.jsxs("div",{className:"input",children:[N.jsx("textarea",{name:"",id:"",placeholder:"Enter note here",value:a,onChange:h=>l(h.target.value),onKeyDown:h=>{console.log(h),h.ctrlKey&&h.key==="Enter"&&(console.log(c),e(a),l(""),c.current?setTimeout(()=>{c.current.scrollTop=c.current.scrollHeight},100):console.warn("divRef is not attached to a DOM element"))}}),N.jsx("i",{className:"fa-solid fa-circle-arrow-up",onClick:()=>{console.log(c),e(a),l(""),c.current?setTimeout(()=>{c.current.scrollTop=c.current.scrollHeight},100):console.warn("divRef is not attached to a DOM element")}})]})]}):N.jsx(mc,{})},$9=({point:n,onDeletePoint:e,onEditPoint:t})=>N.jsxs("div",{className:"NotepadPoint",children:[N.jsxs("div",{className:"left",children:[N.jsx("i",{className:"fa-solid fa-diamond"}),N.jsx("div",{className:"text-block",children:N.jsx("p",{children:n})})]}),N.jsxs("div",{className:"right",children:[N.jsx("i",{className:"fa-solid fa-pen",onClick:t}),N.jsx("i",{className:"fa-solid fa-trash",onClick:e})]})]}),rd=(n,e)=>new Promise(async(t,i)=>{try{console.log("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");const o={model:"gpt-4o-mini",messages:[{role:"system",content:n},...[{role:"user",content:e}]]};setTimeout(async()=>{const h=(await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify(o)})).json()).choices[0].message.content;t(h)},20)}catch(s){console.error(s),i(s)}}),z9=(n,e)=>new Promise(async(t,i)=>{try{const s=`
      Generate me a comprehensive but yet brief explanation on "${n}", using relevant information from ${JSON.stringify(e)}. Neglect all information that does not involve the topic .write up to 200 words explanation
      `;console.log("Generating explantion"),console.log(s);const r=await rd("generate response like a lecturer. Do not use mark down formatting. Write in paragraphs",s);console.log(r),t(r)}catch(s){console.error(s),i(s)}}),H9=n=>new Promise(async(e,t)=>{try{console.log("generatePowerpoint");const i=`
      Generate me an array of major points that looks like this:
      [
          {
            data: 'A system is a set of interconnected components that work together to achieve a specific goal.',
            time: 1000,
          },
          {
            data: 'Systems are found in various fields, including technology, biology, and management, to coordinate and organize elements.',
            time: 2000,
          },
          {
            data: 'In computing, a system combines hardware, software, and processes to perform tasks or provide services.',
            time: 3000,
          },
          {
            data: 'Key elements of a system include inputs, processes, and outputs, ensuring structured and efficient operation.',
            time: 4000,
          },
          {
            data: 'Well-designed systems are efficient, scalable, and reliable, adapting to changing requirements and demands.',
            time: 5000,
          },
        ]

        from the following explanation:"${n}"
      `;console.log(i);const s=await rd("Generate a javascript array. Do not include heading or markdown formatting. Make your response suitable for JSON parsing.",i),r=JSON.parse(s);console.log(r),e(r)}catch(i){console.error(i),t(i)}}),q9=(n,e)=>new Promise(async(t,i)=>{try{console.log("generating quiz");const s=`
      for an outline from a pdf generate me quiz like this:

      [
          {
            question:"question here",
            options: ["wrong option", "wrong option","wrong option"],
            answer: 'right answer',
            response: null,
          },
           {
            question:"question here",
            options: ["wrong option", "wrong option","wrong option"],
            answer: 'right answer',
            response: null,
          },
           {
            question:"question here",
            options: ["wrong option", "wrong option","wrong option"],
            answer: 'right answer',
            response: null,
          },
           {
            question:"question here",
            options: ["wrong option", "wrong option","wrong option"],
            answer: 'right answer',
            response: null,
          },
        ]

       leave response as null,  only write three options. Generate questions from this:

        ${n}.

        Generate an array for me
      `,r=await rd("Generate a javascript array. Do not include heading or markdown formatting. Make your response suitable for JSON parsing.",s);console.log(r);const o=JSON.parse(r);console.log(o),t(o)}catch(s){console.error(s),i(s)}}),W9=n=>new Promise(async(e,t)=>{try{const i=`
      Generate me a summary that encapsulate the whole information stated within this portion of a document

      ${n}
      `,s=await rd("generate a prose without a heading or markdown structure. Just paragraph",i);console.log(s),e(s)}catch(i){console.error(i),t(i)}}),G9=n=>new Promise(async(e,t)=>{try{const i=n.map(r=>W9(r)),s=await Promise.all(i);e(s)}catch(i){console.error(i),t(i)}}),K9=n=>new Promise(async(e,t)=>{try{const i=`
      for an outline from a pdf generate me data like this:

      [
          {
            isQuiz: false,
            title: 'What is Algorithm?',
            explanation: "",
            covered: false,
            completed: false,
            powerPoint: [],
          },
          {
            isQuiz: false,
            title: 'What is a system?',
            explanation: "",
            covered: false,
            completed: false,
            powerPoint: [],
          },
          {
            isQuiz: true,
            title: 'A quiz on algorithms',
            graded: false,
            score: null,
            quiz: [],
          },
        ]

        Leave every field except title blank, Populate this array by modifying the value of title to suit the following information:

        ${n}.

        Generate an array for me
      `,s=await rd("Generate a javascript array. Do not include heading or markdown formatting. Make your response suitable for JSON parsing.",i);console.log(s);const r=JSON.parse(s);console.log(r),e(r)}catch(i){console.error(i),t(i)}}),X9=n=>new Promise(async(e,t)=>{try{const i=n.map(o=>K9(o)),r=(await Promise.all(i)).flat(1);e(r)}catch(i){console.error(i),t(i)}}),Q9=(n,e)=>new Promise(async(t,i)=>{try{const s=`
      A student asked the following question "${e}". Using information from this summary "${n}", generate a response that answers his/her question comprehensively but within 50 - 300 words.
      `,r=await rd("Do not include heading or markdown formatting. Respond with paragraphs. Respond like a friendly lecturer",s);console.log(r),t(r)}catch(s){console.error(s),i(s)}}),Y9=({visible:n,onHideQuestionBox:e,courseSummary:t})=>{const[i,s]=U.useState(null),[r,o]=U.useState(""),a=c=>{c.key==="Escape"&&(s(null),e(),cb())},l=async()=>{try{s(void 0);const c=await Q9(t,r);s(c),o("")}catch(c){console.error(c),s(null),he.error("An error came up")}finally{}};return U.useEffect(()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}),[]),N.jsxs("div",{className:`QuestionBox ${n?"qb-active":"qb-inactive"}  ${i===null?"h-ht":"f-ht"} `,children:[N.jsxs("div",{className:"preview-qb",children:[N.jsx("textarea",{type:"text",placeholder:"Enter question...",value:r,onChange:c=>o(c.target.value)}),N.jsx("button",{onClick:l,children:"Generate answer"})]}),N.jsx("div",{className:"res-box",children:i===void 0?N.jsx(mc,{}):N.jsx("p",{children:i})})]})},J9=({index:n,question:e,options:t,answer:i,response:s,isGraded:r,onSelectOption:o})=>N.jsxs("div",{className:"QuestionComponent",children:[N.jsx("div",{className:"left",children:N.jsxs("p",{children:[n+1,"."]})}),N.jsxs("div",{className:"right",children:[N.jsx("p",{className:"question",children:e}),N.jsx("div",{className:"options",children:r?N.jsx(N.Fragment,{children:t==null?void 0:t.map(a=>N.jsx(eq,{option:a,isCorrect:a===i,isSelected:a===s}))}):N.jsx(N.Fragment,{children:t==null?void 0:t.map(a=>N.jsx(Z9,{option:a,onClick:()=>o(n,a),isSelected:a===s}))})})]})]}),Z9=({option:n,onClick:e,isSelected:t})=>N.jsxs("div",{className:`Option ${t?"selected-option ":""}`,onClick:e,children:[N.jsx("i",{className:"fa-regular fa-circle-dot"}),N.jsx("p",{children:n})]}),eq=({option:n,isSelected:e,isCorrect:t})=>N.jsxs("div",{className:`Option ${t?"correct-option ":e&&!t?"wrong-option":""}`,children:[N.jsx("i",{className:"fa-regular fa-circle-dot"}),N.jsx("p",{children:n})]}),tq=({currentLectureData:n,onSelectOption:e,onSubmitQuiz:t})=>{var i;return N.jsxs("div",{className:"QuizPreview flex flex-col fade-up",children:[N.jsxs("div",{className:"head shrink-0",children:[N.jsx("div",{className:"left",children:N.jsx("p",{children:n.title})}),N.jsx("div",{className:"right",children:n.graded?N.jsxs("p",{className:"score-box",children:[N.jsx("span",{children:"Score: "}),N.jsxs("span",{className:`score ${n.score<40?"red":n.score<60?"yellow":"green"}`,children:[n.score,"%"]})]}):N.jsx("button",{onClick:t,children:"Submit"})})]}),N.jsx("div",{className:"body",children:(n==null?void 0:n.quiz.length)>0?N.jsx(N.Fragment,{children:(i=n==null?void 0:n.quiz)==null?void 0:i.map((s,r)=>N.jsx(J9,{index:r,question:s==null?void 0:s.question,options:s==null?void 0:s.options,answer:s==null?void 0:s.answer,response:s==null?void 0:s.response,isGraded:n==null?void 0:n.graded,onSelectOption:e}))}):N.jsx(mc,{})})]})},nq=n=>{const e=n.quiz.length,t=n.quiz.filter(s=>s.answer===s.response).length,i=Math.round(t*100/e);return n.score=i,n.graded=!0,{...n}},iq=({content:n})=>{const[e,t]=U.useState(!1);return U.useEffect(()=>{if(!n)return;t(!0);const i=setTimeout(()=>t(!1),1e3);return()=>clearTimeout(i)},[n]),n?N.jsx("div",{className:`LectureCoursePreview ${e?"fade-left":""}`,children:N.jsx("p",{children:n})}):N.jsx(mc,{})};var wf={};wf.d=(n,e)=>{for(var t in e)wf.o(e,t)&&!wf.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};wf.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ge=globalThis.pdfjsLib={};wf.d(ge,{AbortException:()=>Pc,AnnotationEditorLayer:()=>sT,AnnotationEditorParamsType:()=>Re,AnnotationEditorType:()=>we,AnnotationEditorUIManager:()=>vc,AnnotationLayer:()=>JW,AnnotationMode:()=>Po,ColorPicker:()=>Ov,DOMSVGFactory:()=>vb,DrawLayer:()=>aT,FeatureTest:()=>Fn,GlobalWorkerOptions:()=>qr,ImageKind:()=>uy,InvalidPDFException:()=>E2,MissingPDFException:()=>Fg,OPS:()=>es,OutputScale:()=>eA,PDFDataRangeTransport:()=>yD,PDFDateString:()=>pb,PDFWorker:()=>Tu,PasswordResponses:()=>aq,PermissionFlag:()=>oq,PixelsPerInch:()=>xa,RenderingCancelledException:()=>db,TextLayer:()=>Yf,UnexpectedResponseException:()=>n0,Util:()=>re,VerbosityLevel:()=>Z_,XfaLayer:()=>_D,build:()=>NW,createValidAbsoluteUrl:()=>hq,fetchData:()=>s0,getDocument:()=>TW,getFilenameFromUrl:()=>wq,getPdfFilenameFromUrl:()=>Eq,getXfaPageViewport:()=>Aq,isDataScheme:()=>r0,isPdfFile:()=>fb,noContextMenu:()=>Is,normalizeUnicode:()=>yq,setLayerDimensions:()=>yc,shadow:()=>Te,stopEvent:()=>ms,version:()=>PW});const Mn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),w2=[1,0,0,1,0,0],QE=[.001,0,0,.001,0,0],sq=1e7,Aw=1.35,yi={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Po={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},rq="pdfjs_internal_editor_",we={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Re={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},oq={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},dn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},uy={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},kt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Rd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Z_={ERRORS:0,WARNINGS:1,INFOS:5},es={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},aq={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let e0=Z_.WARNINGS;function lq(n){Number.isInteger(n)&&(e0=n)}function cq(){return e0}function t0(n){e0>=Z_.INFOS&&console.log(`Info: ${n}`)}function Ee(n){e0>=Z_.WARNINGS&&console.log(`Warning: ${n}`)}function He(n){throw new Error(n)}function Ct(n,e){n||He(e)}function uq(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function hq(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=mq(n)}catch{}}const i=e?new URL(n,e):new URL(n);if(uq(i))return i}catch{}return null}function Te(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const $a=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class YE extends $a{constructor(e,t){super(e,"PasswordException"),this.code=t}}class JE extends $a{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class E2 extends $a{constructor(e){super(e,"InvalidPDFException")}}class Fg extends $a{constructor(e){super(e,"MissingPDFException")}}class n0 extends $a{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class dq extends $a{constructor(e){super(e,"FormatError")}}class Pc extends $a{constructor(e){super(e,"AbortException")}}function A2(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&He("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),o=n.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function i0(n){typeof n!="string"&&He("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function fq(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function ub(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function pq(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function gq(){try{return new Function(""),!0}catch{return!1}}class Fn{static get isLittleEndian(){return Te(this,"isLittleEndian",pq())}static get isEvalSupported(){return Te(this,"isEvalSupported",gq())}static get isOffscreenCanvasSupported(){return Te(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Te(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Te(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):Te(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return Te(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Tw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var io,hy,ZE;class re{static makeHexColor(e,t,i){return`#${Tw[e]}${Tw[t]}${Tw[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,r]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(i+o)/2,l=Math.sqrt((i+o)**2-4*(i*o-r*s))/2,c=a+l||1,h=a-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[i,r,s,o]}static bezierBoundingBox(e,t,i,s,r,o,a,l,c){return c?(c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],C(this,io,ZE).call(this,e,i,r,a,t,s,o,l,3*(-e+3*(i-r)+a),6*(e-2*i+r),3*(i-e),c),C(this,io,ZE).call(this,e,i,r,a,t,s,o,l,3*(-t+3*(s-o)+l),6*(t-2*s+o),3*(s-t),c),c}}io=new WeakSet,hy=function(e,t,i,s,r,o,a,l,c,h){if(c<=0||c>=1)return;const f=1-c,p=c*c,g=p*c,y=f*(f*(f*e+3*c*t)+3*p*i)+g*s,_=f*(f*(f*r+3*c*o)+3*p*a)+g*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],_),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],_)},ZE=function(e,t,i,s,r,o,a,l,c,h,f,p){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&C(this,io,hy).call(this,e,t,i,s,r,o,a,l,-f/h,p);return}const g=h**2-4*f*c;if(g<0)return;const y=Math.sqrt(g),_=2*c;C(this,io,hy).call(this,e,t,i,s,r,o,a,l,(-h+y)/_,p),C(this,io,hy).call(this,e,t,i,s,r,o,a,l,(-h-y)/_,p)},R(re,io);function mq(n){return decodeURIComponent(escape(n))}let Sw=null,ER=null;function yq(n){return Sw||(Sw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ER=new Map([["ﬅ","ſt"]])),n.replaceAll(Sw,(e,t,i)=>t?t.normalize("NFKC"):ER.get(i))}function vq(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),A2(n)}const hb="pdfjs_internal_id_",fr={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function _q(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(A2(n))}const pr="http://www.w3.org/2000/svg",Za=class Za{};ce(Za,"CSS",96),ce(Za,"PDF",72),ce(Za,"PDF_TO_CSS_UNITS",Za.CSS/Za.PDF);let xa=Za;async function s0(n,e="text"){if(Bd(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Vg{constructor({viewBox:e,scale:t,rotation:i,offsetX:s=0,offsetY:r=0,dontFlip:o=!1}){this.viewBox=e,this.scale=t,this.rotation=i,this.offsetX=s,this.offsetY=r;const a=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let c,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,f=0,p=1;break;case 90:c=0,h=1,f=1,p=0;break;case 270:c=0,h=-1,f=-1,p=0;break;case 0:c=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let g,y,_,A;c===0?(g=Math.abs(l-e[1])*t+s,y=Math.abs(a-e[0])*t+r,_=(e[3]-e[1])*t,A=(e[2]-e[0])*t):(g=Math.abs(a-e[0])*t+s,y=Math.abs(l-e[1])*t+r,_=(e[2]-e[0])*t,A=(e[3]-e[1])*t),this.transform=[c*t,h*t,f*t,p*t,g-c*t*a-f*t*l,y-h*t*a-p*t*l],this.width=_,this.height=A}get rawDims(){const{viewBox:e}=this;return Te(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Vg({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){return re.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=re.applyTransform([e[0],e[1]],this.transform),i=re.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return re.applyInverseTransform([e,t],this.transform)}}class db extends $a{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function r0(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function fb(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function wq(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Eq(n,e="document.pdf"){if(typeof n!="string")return e;if(r0(n))return Ee('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||e}class AR{constructor(){ce(this,"started",Object.create(null));ce(this,"times",[])}time(e){e in this.started&&Ee(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ee(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Bd(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Is(n){n.preventDefault()}function ms(n){n.preventDefault(),n.stopPropagation()}function TR(n){console.log("Deprecated API usage: "+n)}var Zf;class pb{static toDateObject(e){if(!e||typeof e!="string")return null;u(this,Zf)||T(this,Zf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=u(this,Zf).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(o+=h,a+=f):c==="+"&&(o-=h,a-=f),new Date(Date.UTC(i,s,r,o,a,l))}}Zf=new WeakMap,R(pb,Zf);function Aq(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Vg({viewBox:r,scale:e,rotation:t})}function gb(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ee(`Not a valid color format: "${n}"`),[0,0,0])}function Tq(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,gb(i))}e.remove()}function nt(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform();return[e,t,i,s,r,o]}function ks(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform().invertSelf();return[e,t,i,s,r,o]}function yc(n,e,t=!1,i=!0){if(e instanceof Vg){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:o}=n,a=Fn.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${r}px`,h=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=a?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(o.width=h,o.height=f):(o.width=f,o.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class eA{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var No,ol,ts,al,ep,tp,Uv,T2,Vn,S2,b2,dy,I2,nA;const vr=class vr{constructor(e){R(this,Vn);R(this,No,null);R(this,ol,null);R(this,ts);R(this,al,null);R(this,ep,null);T(this,ts,e),u(vr,tp)||T(vr,tp,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=T(this,No,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=u(this,ts)._uiManager._signal;e.addEventListener("contextmenu",Is,{signal:t}),e.addEventListener("pointerdown",C(vr,Uv,T2),{signal:t});const i=T(this,al,document.createElement("div"));i.className="buttons",e.append(i);const s=u(this,ts).toolbarPosition;if(s){const{style:r}=e,o=u(this,ts)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return C(this,Vn,I2).call(this),e}get div(){return u(this,No)}hide(){var e;u(this,No).classList.add("hidden"),(e=u(this,ol))==null||e.hideDropdown()}show(){var e;u(this,No).classList.remove("hidden"),(e=u(this,ep))==null||e.shown()}async addAltText(e){const t=await e.render();C(this,Vn,dy).call(this,t),u(this,al).prepend(t,u(this,Vn,nA)),T(this,ep,e)}addColorPicker(e){T(this,ol,e);const t=e.renderButton();C(this,Vn,dy).call(this,t),u(this,al).prepend(t,u(this,Vn,nA))}remove(){var e;u(this,No).remove(),(e=u(this,ol))==null||e.destroy(),T(this,ol,null)}};No=new WeakMap,ol=new WeakMap,ts=new WeakMap,al=new WeakMap,ep=new WeakMap,tp=new WeakMap,Uv=new WeakSet,T2=function(e){e.stopPropagation()},Vn=new WeakSet,S2=function(e){u(this,ts)._focusEventsAllowed=!1,ms(e)},b2=function(e){u(this,ts)._focusEventsAllowed=!0,ms(e)},dy=function(e){const t=u(this,ts)._uiManager._signal;e.addEventListener("focusin",C(this,Vn,S2).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",C(this,Vn,b2).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Is,{signal:t})},I2=function(){const{editorType:e,_uiManager:t}=u(this,ts),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",u(vr,tp)[e]),C(this,Vn,dy).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),u(this,al).append(i)},nA=function(){const e=document.createElement("div");return e.className="divider",e},R(vr,Uv),R(vr,tp,null);let tA=vr;var np,ll,cl,Pa,C2,R2,k2;class Sq{constructor(e){R(this,Pa);R(this,np,null);R(this,ll,null);R(this,cl);T(this,cl,e)}show(e,t,i){const[s,r]=C(this,Pa,R2).call(this,t,i),{style:o}=u(this,ll)||T(this,ll,C(this,Pa,C2).call(this));e.append(u(this,ll)),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,ll).remove()}}np=new WeakMap,ll=new WeakMap,cl=new WeakMap,Pa=new WeakSet,C2=function(){const e=T(this,ll,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Is,{signal:u(this,cl)._signal});const t=T(this,np,document.createElement("div"));return t.className="buttons",e.append(t),C(this,Pa,k2).call(this),e},R2=function(e,t){let i=0,s=0;for(const r of e){const o=r.y+r.height;if(o<i)continue;const a=r.x+(t?r.width:0);if(o>i){s=a,i=o;continue}t?a>s&&(s=a):a<s&&(s=a)}return[t?1-s:s,i]},k2=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=u(this,cl)._signal;e.addEventListener("contextmenu",Is,{signal:i}),e.addEventListener("click",()=>{u(this,cl).highlightSelection("floating_button")},{signal:i}),u(this,np).append(e)};function Lv(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var jv;class bq{constructor(){R(this,jv,0)}get id(){return`${rq}${Rn(this,jv)._++}`}}jv=new WeakMap;var Su,ip,gn,bu,fy;const wb=class wb{constructor(){R(this,bu);R(this,Su,vq());R(this,ip,0);R(this,gn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Te(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return C(this,bu,fy).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return C(this,bu,fy).call(this,e,e)}async getFromBlob(e,t){const i=await t;return C(this,bu,fy).call(this,e,i)}async getFromId(e){u(this,gn)||T(this,gn,new Map);const t=u(this,gn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){u(this,gn)||T(this,gn,new Map);let i=u(this,gn).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${u(this,Su)}_${Rn(this,ip)._++}`,refCounter:1,isSvg:!1},u(this,gn).set(e,i),u(this,gn).set(i.id,i),i}getSvgUrl(e){const t=u(this,gn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;u(this,gn)||T(this,gn,new Map);const t=u(this,gn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${u(this,Su)}_`)}};Su=new WeakMap,ip=new WeakMap,gn=new WeakMap,bu=new WeakSet,fy=async function(e,t){u(this,gn)||T(this,gn,new Map);let i=u(this,gn).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${u(this,Su)}_${Rn(this,ip)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await s0(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=wb._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,h)=>{a.onload=()=>{i.bitmap=a,i.isSvg=!0,c()},o.onload=async()=>{const f=i.svgUrl=o.result;a.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},a.onerror=o.onerror=h});o.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){Ee(s),i=null}return u(this,gn).set(e,i),i&&u(this,gn).set(i.id,i),i};let iA=wb;var vt,Lo,sp,rt;class Iq{constructor(e=128){R(this,vt,[]);R(this,Lo,!1);R(this,sp);R(this,rt,-1);T(this,sp,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&e(),u(this,Lo))return;const l={cmd:e,undo:t,post:i,type:r};if(u(this,rt)===-1){u(this,vt).length>0&&(u(this,vt).length=0),T(this,rt,0),u(this,vt).push(l);return}if(o&&u(this,vt)[u(this,rt)].type===r){a&&(l.undo=u(this,vt)[u(this,rt)].undo),u(this,vt)[u(this,rt)]=l;return}const c=u(this,rt)+1;c===u(this,sp)?u(this,vt).splice(0,1):(T(this,rt,c),c<u(this,vt).length&&u(this,vt).splice(c)),u(this,vt).push(l)}undo(){if(u(this,rt)===-1)return;T(this,Lo,!0);const{undo:e,post:t}=u(this,vt)[u(this,rt)];e(),t==null||t(),T(this,Lo,!1),T(this,rt,u(this,rt)-1)}redo(){if(u(this,rt)<u(this,vt).length-1){T(this,rt,u(this,rt)+1),T(this,Lo,!0);const{cmd:e,post:t}=u(this,vt)[u(this,rt)];e(),t==null||t(),T(this,Lo,!1)}}hasSomethingToUndo(){return u(this,rt)!==-1}hasSomethingToRedo(){return u(this,rt)<u(this,vt).length-1}cleanType(e){if(u(this,rt)!==-1){for(let t=u(this,rt);t>=0;t--)if(u(this,vt)[t].type!==e){u(this,vt).splice(t+1,u(this,rt)-t),T(this,rt,t);return}u(this,vt).length=0,T(this,rt,-1)}}destroy(){T(this,vt,null)}}vt=new WeakMap,Lo=new WeakMap,sp=new WeakMap,rt=new WeakMap;var Bv,x2;class Ug{constructor(e){R(this,Bv);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Fn.platform;for(const[i,s,r={}]of e)for(const o of i){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(C(this,Bv,x2).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:a=null}}=i;a&&!a(e,t)||(s.bind(e,...o,t)(),r||ms(t))}}Bv=new WeakSet,x2=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const $v=class $v{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Tq(e),Te(this,"_colors",e)}convert(e){const t=gb(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,o)=>r===t[o]))return $v._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?re.makeHexColor(...t):e}};ce($v,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let sA=$v;var Iu,ai,Pt,Gt,Cu,Er,Ru,Ni,Do,ku,ul,Ls,ns,hl,rp,op,xu,ap,Ds,Mo,Pu,Oo,Ms,zv,Fo,lp,Vo,dl,cp,up,Vt,Ue,Ar,fl,hp,dp,Uo,Os,Tr,fp,Li,X,py,rA,P2,N2,gy,L2,D2,M2,oA,O2,aA,lA,F2,kn,gr,V2,U2,cA,j2,$d,uA;const uu=class uu{constructor(e,t,i,s,r,o,a,l,c,h,f){R(this,X);R(this,Iu,new AbortController);R(this,ai,null);R(this,Pt,new Map);R(this,Gt,new Map);R(this,Cu,null);R(this,Er,null);R(this,Ru,null);R(this,Ni,new Iq);R(this,Do,null);R(this,ku,0);R(this,ul,new Set);R(this,Ls,null);R(this,ns,null);R(this,hl,new Set);R(this,rp,!1);R(this,op,!1);R(this,xu,!1);R(this,ap,null);R(this,Ds,null);R(this,Mo,null);R(this,Pu,null);R(this,Oo,!1);R(this,Ms,null);R(this,zv,new bq);R(this,Fo,!1);R(this,lp,!1);R(this,Vo,null);R(this,dl,null);R(this,cp,null);R(this,up,null);R(this,Vt,we.NONE);R(this,Ue,new Set);R(this,Ar,null);R(this,fl,null);R(this,hp,null);R(this,dp,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});R(this,Uo,[0,0]);R(this,Os,null);R(this,Tr,null);R(this,fp,null);R(this,Li,null);const p=this._signal=u(this,Iu).signal;T(this,Tr,e),T(this,fp,t),T(this,Cu,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:p}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),s._on("setpreference",this.onSetPreference.bind(this),{signal:p}),s._on("switchannotationeditorparams",g=>this.updateParams(g.type,g.value),{signal:p}),C(this,X,L2).call(this),C(this,X,F2).call(this),C(this,X,oA).call(this),T(this,Er,r.annotationStorage),T(this,ap,r.filterFactory),T(this,fl,o),T(this,Pu,a||null),T(this,rp,l),T(this,op,c),T(this,xu,h),T(this,up,f||null),this.viewParameters={realScale:xa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const e=uu.prototype,t=o=>u(o,Tr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Te(this,"_keyboardManager",new Ug([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&u(o,Tr).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&u(o,Tr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s;(e=u(this,Li))==null||e.resolve(),T(this,Li,null),(t=u(this,Iu))==null||t.abort(),T(this,Iu,null),this._signal=null;for(const r of u(this,Gt).values())r.destroy();u(this,Gt).clear(),u(this,Pt).clear(),u(this,hl).clear(),T(this,ai,null),u(this,Ue).clear(),u(this,Ni).destroy(),(i=u(this,Cu))==null||i.destroy(),(s=u(this,Ms))==null||s.hide(),T(this,Ms,null),u(this,Ds)&&(clearTimeout(u(this,Ds)),T(this,Ds,null)),u(this,Os)&&(clearTimeout(u(this,Os)),T(this,Os,null))}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return u(this,up)}get useNewAltTextFlow(){return u(this,op)}get useNewAltTextWhenAddingImage(){return u(this,xu)}get hcmFilter(){return Te(this,"hcmFilter",u(this,fl)?u(this,ap).addHCMFilter(u(this,fl).foreground,u(this,fl).background):"none")}get direction(){return Te(this,"direction",getComputedStyle(u(this,Tr)).direction)}get highlightColors(){return Te(this,"highlightColors",u(this,Pu)?new Map(u(this,Pu).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Te(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setMainHighlightColorPicker(e){T(this,cp,e)}editAltText(e,t=!1){var i;(i=u(this,Cu))==null||i.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":T(this,xu,t);break}}onPageChanging({pageNumber:e}){T(this,ku,e-1)}focusMainContainer(){u(this,Tr).focus()}findParent(e,t){for(const i of u(this,Gt).values()){const{x:s,y:r,width:o,height:a}=i.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=r&&t<=r+a)return i}return null}disableUserSelect(e=!1){u(this,fp).classList.toggle("noUserSelect",e)}addShouldRescale(e){u(this,hl).add(e)}removeShouldRescale(e){u(this,hl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*xa.PDF_TO_CSS_UNITS;for(const i of u(this,hl))i.onScaleChanging();(t=this.currentLayer)==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}=t,a=t.toString(),c=C(this,X,py).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;t.empty();const f=C(this,X,rA).call(this,c),p=u(this,Vt)===we.NONE,g=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o,text:a}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(we.HIGHLIGHT,g);return}g()}addToAnnotationStorage(e){!e.isEmpty()&&u(this,Er)&&!u(this,Er).has(e.id)&&u(this,Er).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,u(this,Oo)&&(T(this,Oo,!1),C(this,X,gy).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of u(this,Ue))if(t.div.contains(e)){T(this,dl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!u(this,dl))return;const[e,t]=u(this,dl);T(this,dl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){C(this,X,oA).call(this),C(this,X,aA).call(this)}removeEditListeners(){C(this,X,O2).call(this),C(this,X,lA).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of u(this,ns))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of u(this,ns))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=u(this,ai))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of u(this,Ue)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of u(this,ns))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){Ee(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const c=await s.deserialize(l);if(!c)return;r.push(c)}const o=()=>{for(const l of r)C(this,X,cA).call(this,l);C(this,X,uA).call(this,r)},a=()=>{for(const l of r)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){Ee(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,Vt)!==we.NONE&&!this.isEditorHandlingKeyboard&&uu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,Oo)&&(T(this,Oo,!1),C(this,X,gy).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(C(this,X,D2).call(this),C(this,X,aA).call(this),C(this,X,kn).call(this,{isEditing:u(this,Vt)!==we.NONE,isEmpty:C(this,X,$d).call(this),hasSomethingToUndo:u(this,Ni).hasSomethingToUndo(),hasSomethingToRedo:u(this,Ni).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,X,M2).call(this),C(this,X,lA).call(this),C(this,X,kn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!u(this,ns)){T(this,ns,e);for(const t of u(this,ns))C(this,X,gr).call(this,t.defaultPropertiesToUpdate)}}getId(){return u(this,zv).id}get currentLayer(){return u(this,Gt).get(u(this,ku))}getLayer(e){return u(this,Gt).get(e)}get currentPageIndex(){return u(this,ku)}addLayer(e){u(this,Gt).set(e.pageIndex,e),u(this,Fo)?e.enable():e.disable()}removeLayer(e){u(this,Gt).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(u(this,Vt)!==e&&!(u(this,Li)&&(await u(this,Li).promise,!u(this,Li)))){if(T(this,Li,Promise.withResolvers()),T(this,Vt,e),e===we.NONE){this.setEditingState(!1),C(this,X,U2).call(this),u(this,Li).resolve();return}this.setEditingState(!0),await C(this,X,V2).call(this),this.unselectAll();for(const s of u(this,Gt).values())s.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),u(this,Li).resolve();return}for(const s of u(this,Pt).values())s.annotationElementId===t?(this.setSelected(s),s.enterInEditMode()):s.unselect();u(this,Li).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==u(this,Vt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var i;if(u(this,ns)){switch(e){case Re.CREATE:this.currentLayer.addNewEditor();return;case Re.HIGHLIGHT_DEFAULT_COLOR:(i=u(this,cp))==null||i.updateColor(t);break;case Re.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,hp)||T(this,hp,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of u(this,Ue))s.updateParams(e,t);for(const s of u(this,ns))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const o of u(this,Pt).values())o.editorType===e&&o.show(t);(((r=u(this,hp))==null?void 0:r.get(Re.HIGHLIGHT_SHOW_ALL))??!0)!==t&&C(this,X,gr).call(this,[[Re.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(u(this,lp)!==e){T(this,lp,e);for(const t of u(this,Gt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of u(this,Pt).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return u(this,Pt).get(e)}addEditor(e){u(this,Pt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(u(this,Ds)&&clearTimeout(u(this,Ds)),T(this,Ds,setTimeout(()=>{this.focusMainContainer(),T(this,Ds,null)},0))),u(this,Pt).delete(e.id),this.unselect(e),(!e.annotationElementId||!u(this,ul).has(e.annotationElementId))&&((t=u(this,Er))==null||t.remove(e.id))}addDeletedAnnotationElement(e){u(this,ul).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return u(this,ul).has(e)}removeDeletedAnnotationElement(e){u(this,ul).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){u(this,ai)!==e&&(T(this,ai,e),e&&C(this,X,gr).call(this,e.propertiesToUpdate))}updateUI(e){u(this,X,j2)===e&&C(this,X,gr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){C(this,X,gr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(u(this,Ue).has(e)){u(this,Ue).delete(e),e.unselect(),C(this,X,kn).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,Ue).add(e),e.select(),C(this,X,gr).call(this,e.propertiesToUpdate),C(this,X,kn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=this.currentLayer)==null||t.commitOrRemove();for(const i of u(this,Ue))i!==e&&i.unselect();u(this,Ue).clear(),u(this,Ue).add(e),e.select(),C(this,X,gr).call(this,e.propertiesToUpdate),C(this,X,kn).call(this,{hasSelectedEditor:!0})}isSelected(e){return u(this,Ue).has(e)}get firstSelectedEditor(){return u(this,Ue).values().next().value}unselect(e){e.unselect(),u(this,Ue).delete(e),C(this,X,kn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,Ue).size!==0}get isEnterHandled(){return u(this,Ue).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){u(this,Ni).undo(),C(this,X,kn).call(this,{hasSomethingToUndo:u(this,Ni).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,X,$d).call(this)})}redo(){u(this,Ni).redo(),C(this,X,kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,Ni).hasSomethingToRedo(),isEmpty:C(this,X,$d).call(this)})}addCommands(e){u(this,Ni).add(e),C(this,X,kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,X,$d).call(this)})}cleanUndoStack(e){u(this,Ni).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...u(this,Ue)],i=()=>{for(const o of t)o.remove()},s=()=>{for(const o of t)C(this,X,cA).call(this,o)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=u(this,ai))==null||e.commitOrRemove()}hasSomethingToControl(){return u(this,ai)||this.hasSelection}selectAll(){for(const e of u(this,Ue))e.commit();C(this,X,uA).call(this,u(this,Pt).values())}unselectAll(){var e;if(!(u(this,ai)&&(u(this,ai).commitOrRemove(),u(this,Vt)!==we.NONE))&&!((e=this.currentLayer)!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear(),C(this,X,kn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;u(this,Uo)[0]+=e,u(this,Uo)[1]+=t;const[s,r]=u(this,Uo),o=[...u(this,Ue)],a=1e3;u(this,Os)&&clearTimeout(u(this,Os)),T(this,Os,setTimeout(()=>{T(this,Os,null),u(this,Uo)[0]=u(this,Uo)[1]=0,this.addCommands({cmd:()=>{for(const l of o)u(this,Pt).has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of o)u(this,Pt).has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,Ls,new Map);for(const e of u(this,Ue))u(this,Ls).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,Ls))return!1;this.disableUserSelect(!1);const e=u(this,Ls);T(this,Ls,null);let t=!1;for(const[{x:s,y:r,pageIndex:o},a]of e)a.newX=s,a.newY=r,a.newPageIndex=o,t||(t=s!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const i=(s,r,o,a)=>{if(u(this,Pt).has(s.id)){const l=u(this,Gt).get(a);l?s._setParentAndPosition(l,r,o):(s.pageIndex=a,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:a}]of e)i(s,r,o,a)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:a}]of e)i(s,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(u(this,Ls))for(const i of u(this,Ls).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||u(this,Ue).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return u(this,ai)===e}getActive(){return u(this,ai)}getMode(){return u(this,Vt)}get imageManager(){return Te(this,"imageManager",new iA)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,h=t.rangeCount;c<h;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(c,h,f,p)=>({x:(h-s)/o,y:1-(c+f-i)/r,width:p/o,height:f/r});break;case"180":a=(c,h,f,p)=>({x:1-(c+f-i)/r,y:1-(h+p-s)/o,width:f/r,height:p/o});break;case"270":a=(c,h,f,p)=>({x:1-(h+p-s)/o,y:(c-i)/r,width:p/o,height:f/r});break;default:a=(c,h,f,p)=>({x:(c-i)/r,y:(h-s)/o,width:f/r,height:p/o});break}const l=[];for(let c=0,h=t.rangeCount;c<h;c++){const f=t.getRangeAt(c);if(!f.collapsed)for(const{x:p,y:g,width:y,height:_}of f.getClientRects())y===0||_===0||l.push(a(p,g,y,_))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(u(this,Ru)||T(this,Ru,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=u(this,Ru))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=u(this,Ru))==null?void 0:s.get(e.data.id);if(!t)return;const i=u(this,Er).getRawValue(t);i&&(u(this,Vt)===we.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}};Iu=new WeakMap,ai=new WeakMap,Pt=new WeakMap,Gt=new WeakMap,Cu=new WeakMap,Er=new WeakMap,Ru=new WeakMap,Ni=new WeakMap,Do=new WeakMap,ku=new WeakMap,ul=new WeakMap,Ls=new WeakMap,ns=new WeakMap,hl=new WeakMap,rp=new WeakMap,op=new WeakMap,xu=new WeakMap,ap=new WeakMap,Ds=new WeakMap,Mo=new WeakMap,Pu=new WeakMap,Oo=new WeakMap,Ms=new WeakMap,zv=new WeakMap,Fo=new WeakMap,lp=new WeakMap,Vo=new WeakMap,dl=new WeakMap,cp=new WeakMap,up=new WeakMap,Vt=new WeakMap,Ue=new WeakMap,Ar=new WeakMap,fl=new WeakMap,hp=new WeakMap,dp=new WeakMap,Uo=new WeakMap,Os=new WeakMap,Tr=new WeakMap,fp=new WeakMap,Li=new WeakMap,X=new WeakSet,py=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},rA=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of u(this,Gt).values())if(i.hasTextLayer(e))return i;return null},P2=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=C(this,X,py).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(u(this,Ms)||T(this,Ms,new Sq(this)),u(this,Ms).show(i,s,this.direction==="ltr"))},N2=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){u(this,Ar)&&((r=u(this,Ms))==null||r.hide(),T(this,Ar,null),C(this,X,kn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===u(this,Ar))return;const s=C(this,X,py).call(this,e).closest(".textLayer");if(!s){u(this,Ar)&&((o=u(this,Ms))==null||o.hide(),T(this,Ar,null),C(this,X,kn).call(this,{hasSelectedText:!1}));return}if((a=u(this,Ms))==null||a.hide(),T(this,Ar,t),C(this,X,kn).call(this,{hasSelectedText:!0}),!(u(this,Vt)!==we.HIGHLIGHT&&u(this,Vt)!==we.NONE)&&(u(this,Vt)===we.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,Oo,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=u(this,Vt)===we.HIGHLIGHT?C(this,X,rA).call(this,s):null;l==null||l.toggleDrawing();const c=new AbortController,h=this.combinedSignal(c),f=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&C(this,X,gy).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}},gy=function(e=""){u(this,Vt)===we.HIGHLIGHT?this.highlightSelection(e):u(this,rp)&&C(this,X,P2).call(this)},L2=function(){document.addEventListener("selectionchange",C(this,X,N2).bind(this),{signal:this._signal})},D2=function(){if(u(this,Mo))return;T(this,Mo,new AbortController);const e=this.combinedSignal(u(this,Mo));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},M2=function(){var e;(e=u(this,Mo))==null||e.abort(),T(this,Mo,null)},oA=function(){if(u(this,Vo))return;T(this,Vo,new AbortController);const e=this.combinedSignal(u(this,Vo));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},O2=function(){var e;(e=u(this,Vo))==null||e.abort(),T(this,Vo,null)},aA=function(){if(u(this,Do))return;T(this,Do,new AbortController);const e=this.combinedSignal(u(this,Do));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},lA=function(){var e;(e=u(this,Do))==null||e.abort(),T(this,Do,null)},F2=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},kn=function(e){Object.entries(e).some(([i,s])=>u(this,dp)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,dp),e)}),u(this,Vt)===we.HIGHLIGHT&&e.hasSelectedEditor===!1&&C(this,X,gr).call(this,[[Re.HIGHLIGHT_FREE,!0]]))},gr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},V2=async function(){if(!u(this,Fo)){T(this,Fo,!0);const e=[];for(const t of u(this,Gt).values())e.push(t.enable());await Promise.all(e);for(const t of u(this,Pt).values())t.enable()}},U2=function(){if(this.unselectAll(),u(this,Fo)){T(this,Fo,!1);for(const e of u(this,Gt).values())e.disable();for(const e of u(this,Pt).values())e.disable()}},cA=function(e){const t=u(this,Gt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},j2=function(){let e=null;for(e of u(this,Ue));return e},$d=function(){if(u(this,Pt).size===0)return!0;if(u(this,Pt).size===1)for(const e of u(this,Pt).values())return e.isEmpty();return!1},uA=function(e){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear();for(const t of e)t.isEmpty()||(u(this,Ue).add(t),t.select());C(this,X,kn).call(this,{hasSelectedEditor:this.hasSelection})},ce(uu,"TRANSLATE_SMALL",1),ce(uu,"TRANSLATE_BIG",10);let vc=uu;var Ut,Fs,is,Nu,Vs,li,Lu,Us,Hn,Sr,pl,js,jo,vs,zd,my;const xn=class xn{constructor(e){R(this,vs);R(this,Ut,null);R(this,Fs,!1);R(this,is,null);R(this,Nu,null);R(this,Vs,null);R(this,li,null);R(this,Lu,!1);R(this,Us,null);R(this,Hn,null);R(this,Sr,null);R(this,pl,null);R(this,js,!1);T(this,Hn,e),T(this,js,e._uiManager.useNewAltTextFlow),u(xn,jo)||T(xn,jo,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){xn._l10n??(xn._l10n=e)}async render(){const e=T(this,is,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=T(this,Nu,document.createElement("span"));e.append(t),u(this,js)?(e.classList.add("new"),e.setAttribute("data-l10n-id",u(xn,jo).missing),t.setAttribute("data-l10n-id",u(xn,jo)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=u(this,Hn)._uiManager._signal;e.addEventListener("contextmenu",Is,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),u(this,Hn)._uiManager.editAltText(u(this,Hn)),u(this,js)&&u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,vs,zd)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(T(this,Lu,!0),s(r))},{signal:i}),await C(this,vs,my).call(this),e}finish(){u(this,is)&&(u(this,is).focus({focusVisible:u(this,Lu)}),T(this,Lu,!1))}isEmpty(){return u(this,js)?u(this,Ut)===null:!u(this,Ut)&&!u(this,Fs)}hasData(){return u(this,js)?u(this,Ut)!==null||!!u(this,Sr):this.isEmpty()}get guessedText(){return u(this,Sr)}async setGuessedText(e){u(this,Ut)===null&&(T(this,Sr,e),T(this,pl,await xn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),C(this,vs,my).call(this))}toggleAltTextBadge(e=!1){var t;if(!u(this,js)||u(this,Ut)){(t=u(this,Us))==null||t.remove(),T(this,Us,null);return}if(!u(this,Us)){const i=T(this,Us,document.createElement("div"));i.className="noAltTextBadge",u(this,Hn).div.append(i)}u(this,Us).classList.toggle("hidden",!e)}serialize(e){let t=u(this,Ut);return!e&&u(this,Sr)===t&&(t=u(this,pl)),{altText:t,decorative:u(this,Fs),guessedText:u(this,Sr),textWithDisclaimer:u(this,pl)}}get data(){return{altText:u(this,Ut),decorative:u(this,Fs)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(T(this,Sr,i),T(this,pl,s)),!(u(this,Ut)===e&&u(this,Fs)===t)&&(r||(T(this,Ut,e),T(this,Fs,t)),C(this,vs,my).call(this))}toggle(e=!1){u(this,is)&&(!e&&u(this,li)&&(clearTimeout(u(this,li)),T(this,li,null)),u(this,is).disabled=!e)}shown(){u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,vs,zd)}})}destroy(){var e,t;(e=u(this,is))==null||e.remove(),T(this,is,null),T(this,Nu,null),T(this,Vs,null),(t=u(this,Us))==null||t.remove(),T(this,Us,null)}};Ut=new WeakMap,Fs=new WeakMap,is=new WeakMap,Nu=new WeakMap,Vs=new WeakMap,li=new WeakMap,Lu=new WeakMap,Us=new WeakMap,Hn=new WeakMap,Sr=new WeakMap,pl=new WeakMap,js=new WeakMap,jo=new WeakMap,vs=new WeakSet,zd=function(){return u(this,Ut)&&"added"||u(this,Ut)===null&&this.guessedText&&"review"||"missing"},my=async function(){var s,r,o;const e=u(this,is);if(!e)return;if(u(this,js)){if(e.classList.toggle("done",!!u(this,Ut)),e.setAttribute("data-l10n-id",u(xn,jo)[u(this,vs,zd)]),(s=u(this,Nu))==null||s.setAttribute("data-l10n-id",u(xn,jo)[`${u(this,vs,zd)}-label`]),!u(this,Ut)){(r=u(this,Vs))==null||r.remove();return}}else{if(!u(this,Ut)&&!u(this,Fs)){e.classList.remove("done"),(o=u(this,Vs))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=u(this,Vs);if(!t){T(this,Vs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${u(this,Hn).id}`;const a=100,l=u(this,Hn)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(u(this,li)),T(this,li,null)},{once:!0}),e.addEventListener("mouseenter",()=>{T(this,li,setTimeout(()=>{T(this,li,null),u(this,Vs).classList.add("show"),u(this,Hn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;u(this,li)&&(clearTimeout(u(this,li)),T(this,li,null)),(c=u(this,Vs))==null||c.classList.remove("show")},{signal:l})}u(this,Fs)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=u(this,Ut)),t.parentNode||e.append(t);const i=u(this,Hn).getImageForAltText();i==null||i.setAttribute("aria-describedby",t.id)},R(xn,jo,null),ce(xn,"_l10n",null);let Dv=xn;var gl,ss,ot,Du,Bo,pp,ml,Kt,yl,$o,zo,gp,vl,Ho,mp,_l,br,Bs,Mu,Ou,Di,yp,Hv,ye,hA,vp,dA,fA,B2,$2,pA,gA,mA,yA,z2,vA,H2,q2,W2,_A,Hd;const Fe=class Fe{constructor(e){R(this,ye);R(this,gl,null);R(this,ss,null);R(this,ot,null);R(this,Du,!1);R(this,Bo,null);R(this,pp,"");R(this,ml,!1);R(this,Kt,null);R(this,yl,null);R(this,$o,null);R(this,zo,null);R(this,gp,"");R(this,vl,!1);R(this,Ho,null);R(this,mp,!1);R(this,_l,!1);R(this,br,!1);R(this,Bs,null);R(this,Mu,0);R(this,Ou,0);R(this,Di,null);ce(this,"_editToolbar",null);ce(this,"_initialOptions",Object.create(null));ce(this,"_initialData",null);ce(this,"_isVisible",!0);ce(this,"_uiManager",null);ce(this,"_focusEventsAllowed",!0);R(this,yp,!1);R(this,Hv,Fe._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Fe.prototype._resizeWithKeyboard,t=vc.TRANSLATE_SMALL,i=vc.TRANSLATE_BIG;return Te(this,"_resizerKeyboardManager",new Ug([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Fe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Te(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Cq({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Fe._l10n??(Fe._l10n=e),Fe._l10nResizer||(Fe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Fe._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Fe._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){He("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,yp)}set _isDraggable(e){var t;T(this,yp,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,Hv)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):C(this,ye,Hd).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(u(this,vl)?T(this,vl,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/o,this.fixAndSetPosition()}translate(e,t){C(this,ye,hA).call(this,this.parentDimensions,e,t)}translateInPage(e,t){u(this,Ho)||T(this,Ho,[this.x,this.y]),C(this,ye,hA).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){u(this,Ho)||T(this,Ho,[this.x,this.y]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,c]=this.getBaseTranslation();o+=l,a+=c;const{style:h}=i;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!u(this,Ho)&&(u(this,Ho)[0]!==this.x||u(this,Ho)[1]!==this.y)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Fe,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:o,width:a,height:l}=this;if(a*=i,l*=s,r*=i,o*=s,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(i-a,r)),o=Math.max(0,Math.min(s-l,o));break;case 90:r=Math.max(0,Math.min(i-l,r)),o=Math.min(s,Math.max(a,o));break;case 180:r=Math.min(i,Math.max(a,r)),o=Math.min(s,Math.max(l,o));break;case 270:r=Math.min(i,Math.max(l,r)),o=Math.max(0,Math.min(s-a,o));break}this.x=r/=i,this.y=o/=s;const[c,h]=this.getBaseTranslation();r+=c,o+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return C(i=Fe,vp,dA).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return C(i=Fe,vp,dA).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,u(this,ml)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!u(this,ml)&&t.endsWith("%");if(s&&r)return;const[o,a]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!u(this,ml)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}_onResizing(){}altTextFinish(){var e;(e=u(this,ot))==null||e.finish()}async addEditToolbar(){return this._editToolbar||u(this,_l)?this._editToolbar:(this._editToolbar=new tA(this),this.div.append(this._editToolbar.render()),u(this,ot)&&await this._editToolbar.addAltText(u(this,ot)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=u(this,ot))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){u(this,ot)||(Dv.initialize(Fe._l10n),T(this,ot,new Dv(this)),u(this,gl)&&(u(this,ot).data=u(this,gl),T(this,gl,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=u(this,ot))==null?void 0:e.data}set altTextData(e){u(this,ot)&&(u(this,ot).data=e)}get guessedAltText(){var e;return(e=u(this,ot))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=u(this,ot))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=u(this,ot))==null?void 0:t.serialize(e)}hasAltText(){return!!u(this,ot)&&!u(this,ot).isEmpty()}hasAltTextData(){var e;return((e=u(this,ot))==null?void 0:e.hasData())??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=u(this,Du)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),C(this,ye,vA).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Lv(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=Fn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(T(this,vl,!0),this._isDraggable){C(this,ye,z2).call(this,e);return}C(this,ye,yA).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,Bs)&&clearTimeout(u(this,Bs)),T(this,Bs,setTimeout(()=>{var e;T(this,Bs,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/s,h=t/s,f=this.x*r,p=this.y*o,g=this.width*r,y=this.height*o;switch(i){case 0:return[f+c+a,o-p-h-y+l,f+c+g+a,o-p-h+l];case 90:return[f+h+a,o-p+c+l,f+h+y+a,o-p+c+g+l];case 180:return[f-c-g+a,o-p+h+l,f-c+a,o-p+h+y+l];case 270:return[f-h-y+a,o-p-c-g+l,f-h+a,o-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,o]=e,a=r-i,l=o-s;switch(this.rotation){case 0:return[i,t-o,a,l];case 90:return[i,t-s,l,a];case 180:return[r,t-s,a,l];case 270:return[r,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){T(this,_l,!0)}disableEditMode(){T(this,_l,!1)}isInEditMode(){return u(this,_l)}shouldGetKeyboardEvents(){return u(this,br)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){C(this,ye,vA).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){He("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,T(s,gl,e.accessibilityData);const[r,o]=s.pageDimensions,[a,l,c,h]=s.getRectInCurrentCoords(e.rect,o);return s.x=a/r,s.y=l/o,s.width=c/r,s.height=h/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e;if((e=u(this,zo))==null||e.abort(),T(this,zo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),u(this,Bs)&&(clearTimeout(u(this,Bs)),T(this,Bs,null)),C(this,ye,Hd).call(this),this.removeEditToolbar(),u(this,Di)){for(const t of u(this,Di).values())clearTimeout(t);T(this,Di,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,ye,B2).call(this),u(this,Kt).classList.remove("hidden"),Lv(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),T(this,$o,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=u(this,Kt).children;if(!u(this,ss)){T(this,ss,Array.from(t));const o=C(this,ye,H2).bind(this),a=C(this,ye,q2).bind(this),l=this._uiManager._signal;for(const c of u(this,ss)){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",C(this,ye,W2).bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",Fe._l10nResizer[h])}}const i=u(this,ss)[0];let s=0;for(const o of t){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(u(this,ss).length/4);if(r!==s){if(r<s)for(let a=0;a<s-r;a++)u(this,Kt).append(u(this,Kt).firstChild);else if(r>s)for(let a=0;a<r-s;a++)u(this,Kt).firstChild.before(u(this,Kt).lastChild);let o=0;for(const a of t){const c=u(this,ss)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Fe._l10nResizer[c])}}C(this,ye,_A).call(this,0),T(this,br,!0),u(this,Kt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){u(this,br)&&C(this,ye,mA).call(this,u(this,gp),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){C(this,ye,Hd).call(this),this.div.focus()}select(){var e,t,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=u(this,ot))==null||i.toggleAltTextBadge(!1)}unselect(){var e,t,i,s,r;(e=u(this,Kt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=u(this,ot))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return u(this,mp)}set isEditing(e){T(this,mp,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){T(this,ml,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){u(this,Di)||T(this,Di,new Map);const{action:i}=e;let s=u(this,Di).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),u(this,Di).delete(i),u(this,Di).size===0&&T(this,Di,null)},Fe._telemetryTimeout),u(this,Di).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),T(this,Du,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,Du,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};gl=new WeakMap,ss=new WeakMap,ot=new WeakMap,Du=new WeakMap,Bo=new WeakMap,pp=new WeakMap,ml=new WeakMap,Kt=new WeakMap,yl=new WeakMap,$o=new WeakMap,zo=new WeakMap,gp=new WeakMap,vl=new WeakMap,Ho=new WeakMap,mp=new WeakMap,_l=new WeakMap,br=new WeakMap,Bs=new WeakMap,Mu=new WeakMap,Ou=new WeakMap,Di=new WeakMap,yp=new WeakMap,Hv=new WeakMap,ye=new WeakSet,hA=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},vp=new WeakSet,dA=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},fA=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},B2=function(){if(u(this,Kt))return;T(this,Kt,document.createElement("div")),u(this,Kt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");u(this,Kt).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",C(this,ye,$2).bind(this,i),{signal:t}),s.addEventListener("contextmenu",Is,{signal:t}),s.tabIndex=-1}this.div.prepend(u(this,Kt))},$2=function(e,t){var h;t.preventDefault();const{isMac:i}=Fn.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=u(this,ot))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,T(this,yl,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C(this,ye,mA).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ms,{passive:!1,signal:o}),window.addEventListener("contextmenu",Is,{signal:o}),T(this,$o,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=u(this,ot))==null||f.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,C(this,ye,gA).call(this)};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})},pA=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*i,o*s),this.fixAndSetPosition(),this._onResized()},gA=function(){if(!u(this,$o))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=u(this,$o);T(this,$o,null);const r=this.x,o=this.y,a=this.width,l=this.height;r===e&&o===t&&a===i&&l===s||this.addCommands({cmd:C(this,ye,pA).bind(this,r,o,a,l),undo:C(this,ye,pA).bind(this,e,t,i,s),mustExec:!0})},mA=function(e,t){const[i,s]=this.parentDimensions,r=this.x,o=this.y,a=this.width,l=this.height,c=Fe.MIN_SIZE/i,h=Fe.MIN_SIZE/s,f=z=>Math.round(z*1e4)/1e4,p=C(this,ye,fA).call(this,this.rotation),g=(z,B)=>[p[0]*z+p[2]*B,p[1]*z+p[3]*B],y=C(this,ye,fA).call(this,360-this.rotation),_=(z,B)=>[y[0]*z+y[2]*B,y[1]*z+y[3]*B];let A,v,E=!1,S=!1;switch(e){case"topLeft":E=!0,A=(z,B)=>[0,0],v=(z,B)=>[z,B];break;case"topMiddle":A=(z,B)=>[z/2,0],v=(z,B)=>[z/2,B];break;case"topRight":E=!0,A=(z,B)=>[z,0],v=(z,B)=>[0,B];break;case"middleRight":S=!0,A=(z,B)=>[z,B/2],v=(z,B)=>[0,B/2];break;case"bottomRight":E=!0,A=(z,B)=>[z,B],v=(z,B)=>[0,0];break;case"bottomMiddle":A=(z,B)=>[z/2,B],v=(z,B)=>[z/2,0];break;case"bottomLeft":E=!0,A=(z,B)=>[0,B],v=(z,B)=>[z,0];break;case"middleLeft":S=!0,A=(z,B)=>[0,B/2],v=(z,B)=>[z,B/2];break}const P=A(a,l),O=v(a,l);let F=g(...O);const I=f(r+F[0]),b=f(o+F[1]);let k=1,L=1,M,V;if(t.fromKeyboard)({deltaX:M,deltaY:V}=t);else{const{screenX:z,screenY:B}=t,[Q,ie]=u(this,yl);[M,V]=this.screenToPageTranslation(z-Q,B-ie),u(this,yl)[0]=z,u(this,yl)[1]=B}if([M,V]=_(M/i,V/s),E){const z=Math.hypot(a,l);k=L=Math.max(Math.min(Math.hypot(O[0]-P[0]-M,O[1]-P[1]-V)/z,1/a,1/l),c/a,h/l)}else S?k=Math.max(c,Math.min(1,Math.abs(O[0]-P[0]-M)))/a:L=Math.max(h,Math.min(1,Math.abs(O[1]-P[1]-V)))/l;const D=f(a*k),oe=f(l*L);F=g(...v(D,oe));const Pe=I-F[0],K=b-F[1];this.width=D,this.height=oe,this.x=Pe,this.y=K,this.setDims(i*D,s*oe),this.fixAndSetPosition(),this._onResizing()},yA=function(e){const{isMac:t}=Fn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},z2=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const i=new AbortController,s=this._uiManager.combinedSignal(i),r={capture:!0,passive:!1,signal:s},o=l=>{i.abort(),T(this,Bo,null),T(this,vl,!1),this._uiManager.endDragSession()||C(this,ye,yA).call(this,l)};t&&(T(this,Mu,e.clientX),T(this,Ou,e.clientY),T(this,Bo,e.pointerId),T(this,pp,e.pointerType),window.addEventListener("pointermove",l=>{const{clientX:c,clientY:h,pointerId:f}=l;if(f!==u(this,Bo)){ms(l);return}const[p,g]=this.screenToPageTranslation(c-u(this,Mu),h-u(this,Ou));T(this,Mu,c),T(this,Ou,h),this._uiManager.dragSelectedEditors(p,g)},r),window.addEventListener("touchmove",ms,r),window.addEventListener("pointerdown",l=>{l.isPrimary&&l.pointerType===u(this,pp)&&o(l),ms(l)},r)),this._onStartDragging();const a=l=>{if(!u(this,Bo)||u(this,Bo)===l.pointerId){o(l),this._onStopDragging();return}ms(l)};window.addEventListener("pointerup",a,{signal:s}),window.addEventListener("blur",a,{signal:s})},vA=function(){if(u(this,zo)||!this.div)return;T(this,zo,new AbortController);const e=this._uiManager.combinedSignal(u(this,zo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},H2=function(e){Fe._resizerKeyboardManager.exec(this,e)},q2=function(e){var t;u(this,br)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==u(this,Kt)&&C(this,ye,Hd).call(this)},W2=function(e){T(this,gp,u(this,br)?e:"")},_A=function(e){if(u(this,ss))for(const t of u(this,ss))t.tabIndex=e},Hd=function(){T(this,br,!1),C(this,ye,_A).call(this,-1),C(this,ye,gA).call(this)},R(Fe,vp),ce(Fe,"_l10n",null),ce(Fe,"_l10nResizer",null),ce(Fe,"_borderLineWidth",-1),ce(Fe,"_colorManager",new sA),ce(Fe,"_zIndex",1),ce(Fe,"_telemetryTimeout",1e3);let ct=Fe;class Cq extends ct{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const SR=3285377520,xi=4294901760,xs=65535;class G2{constructor(e){this.h1=e?e&4294967295:SR,this.h2=e?e&4294967295:SR}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let _=0,A=e.length;_<A;_++){const v=e.charCodeAt(_);v<=255?t[i++]=v:(t[i++]=v>>>8,t[i++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(t.buffer,0,s);let a=0,l=0,c=this.h1,h=this.h2;const f=3432918353,p=461845907,g=f&xs,y=p&xs;for(let _=0;_<s;_++)_&1?(a=o[_],a=a*f&xi|a*g&xs,a=a<<15|a>>>17,a=a*p&xi|a*y&xs,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[_],l=l*f&xi|l*g&xs,l=l<<15|l>>>17,l=l*p&xi|l*y&xs,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(a=0,r){case 3:a^=t[s*4+2]<<16;case 2:a^=t[s*4+1]<<8;case 1:a^=t[s*4],a=a*f&xi|a*g&xs,a=a<<15|a>>>17,a=a*p&xi|a*y&xs,s&1?c^=a:h^=a}this.h1=c,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&xi|e*36045&xs,t=t*4283543511&xi|((t<<16|e>>>16)*2950163797&xi)>>>16,e^=t>>>1,e=e*444984403&xi|e*60499&xs,t=t*3301882366&xi|((t<<16|e>>>16)*3120437893&xi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const wA=Object.freeze({map:null,hash:"",transfer:void 0});var wl,El,jt,qv,K2;class mb{constructor(){R(this,qv);R(this,wl,!1);R(this,El,null);R(this,jt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=u(this,jt).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return u(this,jt).get(e)}remove(e){if(u(this,jt).delete(e),u(this,jt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of u(this,jt).values())if(t instanceof ct)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=u(this,jt).get(e);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(t))i[r]!==o&&(s=!0,i[r]=o);else s=!0,u(this,jt).set(e,t);s&&C(this,qv,K2).call(this),t instanceof ct&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return u(this,jt).has(e)}getAll(){return u(this,jt).size>0?ub(u(this,jt)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return u(this,jt).size}resetModified(){u(this,wl)&&(T(this,wl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new X2(this)}get serializable(){if(u(this,jt).size===0)return wA;const e=new Map,t=new G2,i=[],s=Object.create(null);let r=!1;for(const[o,a]of u(this,jt)){const l=a instanceof ct?a.serialize(!1,s):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const o of e.values())o.bitmap&&i.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:wA}get editorStats(){let e=null;const t=new Map;for(const i of u(this,jt).values()){if(!(i instanceof ct))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,l]of Object.entries(s)){if(a==="type")continue;let c=o.get(a);c||(c=new Map,o.set(a,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){T(this,El,null)}get modifiedIds(){if(u(this,El))return u(this,El);const e=[];for(const t of u(this,jt).values())!(t instanceof ct)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return T(this,El,{ids:new Set(e),hash:e.join(",")})}}wl=new WeakMap,El=new WeakMap,jt=new WeakMap,qv=new WeakSet,K2=function(){u(this,wl)||(T(this,wl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var _p;class X2 extends mb{constructor(t){super();R(this,_p);const{map:i,hash:s,transfer:r}=t.serializable,o=structuredClone(i,r?{transfer:r}:null);T(this,_p,{map:o,hash:s,transfer:r})}get print(){He("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,_p)}get modifiedIds(){return Te(this,"modifiedIds",{ids:new Set,hash:""})}}_p=new WeakMap;var Fu;class Rq{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){R(this,Fu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),u(this,Fu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||u(this,Fu).has(e.loadedName))){if(Ct(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=e,o=new FontFace(i,s,r);this.addNativeFontFace(o);try{await o.load(),u(this,Fu).add(i),t==null||t(e)}catch{Ee(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}He("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw Ee(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Te(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Mn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Te(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ct(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Te(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(P,O){return P.charCodeAt(O)<<24|P.charCodeAt(O+1)<<16|P.charCodeAt(O+2)<<8|P.charCodeAt(O+3)&255}function s(P,O,F,I){const b=P.substring(0,O),k=P.substring(O+F);return b+I+k}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function h(P,O){if(++c>30){Ee("Load test font never loaded."),O();return}if(l.font="30px "+P,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(h.bind(null,P,O))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const y=16,_=1482184792;let A=i(p,y);for(r=0,o=f.length-3;r<o;r+=4)A=A-_+i(f,r)|0;r<f.length&&(A=A-_+i(f+"XXX",r)|0),p=s(p,y,4,fq(A));const v=`url(data:font/opentype;base64,${btoa(p)});`,E=`@font-face {font-family:"${f}";src:${v}}`;this.insertRule(E);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const P of[e.loadedName,f]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=P,S.append(O)}this._document.body.append(S),h(f,()=>{S.remove(),t.complete()})}}Fu=new WeakMap;class kq{constructor(e,{disableFontFace:t=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.disableFontFace=t===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${_q(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let i;try{i=e.get(this.loadedName+"_path_"+t)}catch(r){Ee(`getPathGenerator - ignoring character: "${r}".`)}if(!Array.isArray(i)||i.length===0)return this.compiledGlyphs[t]=function(r,o){};const s=[];for(let r=0,o=i.length;r<o;)switch(i[r++]){case fr.BEZIER_CURVE_TO:{const[a,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.bezierCurveTo(a,l,c,h,f,p)),r+=6}break;case fr.MOVE_TO:{const[a,l]=i.slice(r,r+2);s.push(c=>c.moveTo(a,l)),r+=2}break;case fr.LINE_TO:{const[a,l]=i.slice(r,r+2);s.push(c=>c.lineTo(a,l)),r+=2}break;case fr.QUADRATIC_CURVE_TO:{const[a,l,c,h]=i.slice(r,r+4);s.push(f=>f.quadraticCurveTo(a,l,c,h)),r+=4}break;case fr.RESTORE:s.push(a=>a.restore());break;case fr.SAVE:s.push(a=>a.save());break;case fr.SCALE:Ct(s.length===2,"Scale command is only valid at the third position.");break;case fr.TRANSFORM:{const[a,l,c,h,f,p]=i.slice(r,r+6);s.push(g=>g.transform(a,l,c,h,f,p)),r+=6}break;case fr.TRANSLATE:{const[a,l]=i.slice(r,r+2);s.push(c=>c.translate(a,l)),r+=2}break}return s.push(r=>r.closePath()),this.compiledGlyphs[t]=function(o,a){s[0](o),s[1](o),o.scale(a,-a);for(let l=2,c=s.length;l<c;l++)s[l](o)}}}var wp;class Q2{constructor({enableHWA:e=!1}){R(this,wp,!1);T(this,wp,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!u(this,wp)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){He("Abstract method `_createCanvas` called.")}}wp=new WeakMap;class xq extends Q2{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class Y2{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){He("Abstract method `_fetch` called.")}}class J2 extends Y2{async _fetch(e){const t=await s0(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):i0(t)}}class Z2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var Al,Vu,Ir,Cr,mn,Tl,Sl,J,fn,qd,Hc,yy,qc,eD,EA,Wc,Wd,Gd,AA,Kd;class Pq extends Z2{constructor({docId:t,ownerDocument:i=globalThis.document}){super();R(this,J);R(this,Al);R(this,Vu);R(this,Ir);R(this,Cr);R(this,mn);R(this,Tl);R(this,Sl,0);T(this,Cr,t),T(this,mn,i)}addFilter(t){if(!t)return"none";let i=u(this,J,fn).get(t);if(i)return i;const[s,r,o]=C(this,J,yy).call(this,t),a=t.length===1?s:`${s}${r}${o}`;if(i=u(this,J,fn).get(a),i)return u(this,J,fn).set(t,i),i;const l=`g_${u(this,Cr)}_transfer_map_${Rn(this,Sl)._++}`,c=C(this,J,qc).call(this,l);u(this,J,fn).set(t,c),u(this,J,fn).set(a,c);const h=C(this,J,Wc).call(this,l);return C(this,J,Gd).call(this,s,r,o,h),c}addHCMFilter(t,i){var y;const s=`${t}-${i}`,r="base";let o=u(this,J,qd).get(r);if((o==null?void 0:o.key)===s||(o?((y=o.filter)==null||y.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},u(this,J,qd).set(r,o)),!t||!i))return o.url;const a=C(this,J,Kd).call(this,t);t=re.makeHexColor(...a);const l=C(this,J,Kd).call(this,i);if(i=re.makeHexColor(...l),u(this,J,Hc).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const c=new Array(256);for(let _=0;_<=255;_++){const A=_/255;c[_]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const h=c.join(","),f=`g_${u(this,Cr)}_hcm_filter`,p=o.filter=C(this,J,Wc).call(this,f);C(this,J,Gd).call(this,h,h,h,p),C(this,J,EA).call(this,p);const g=(_,A)=>{const v=a[_]/255,E=l[_]/255,S=new Array(A+1);for(let P=0;P<=A;P++)S[P]=v+P/A*(E-v);return S.join(",")};return C(this,J,Gd).call(this,g(0,5),g(1,5),g(2,5),p),o.url=C(this,J,qc).call(this,f),o.url}addAlphaFilter(t){let i=u(this,J,fn).get(t);if(i)return i;const[s]=C(this,J,yy).call(this,[t]),r=`alpha_${s}`;if(i=u(this,J,fn).get(r),i)return u(this,J,fn).set(t,i),i;const o=`g_${u(this,Cr)}_alpha_map_${Rn(this,Sl)._++}`,a=C(this,J,qc).call(this,o);u(this,J,fn).set(t,a),u(this,J,fn).set(r,a);const l=C(this,J,Wc).call(this,o);return C(this,J,AA).call(this,s,l),a}addLuminosityFilter(t){let i=u(this,J,fn).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=C(this,J,yy).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=u(this,J,fn).get(r),i)return u(this,J,fn).set(t,i),i;const o=`g_${u(this,Cr)}_luminosity_map_${Rn(this,Sl)._++}`,a=C(this,J,qc).call(this,o);u(this,J,fn).set(t,a),u(this,J,fn).set(r,a);const l=C(this,J,Wc).call(this,o);return C(this,J,eD).call(this,l),t&&C(this,J,AA).call(this,s,l),a}addHighlightHCMFilter(t,i,s,r,o){var E;const a=`${i}-${s}-${r}-${o}`;let l=u(this,J,qd).get(t);if((l==null?void 0:l.key)===a||(l?((E=l.filter)==null||E.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},u(this,J,qd).set(t,l)),!i||!s))return l.url;const[c,h]=[i,s].map(C(this,J,Kd).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,y]=[r,o].map(C(this,J,Kd).bind(this));p<f&&([f,p,g,y]=[p,f,y,g]),u(this,J,Hc).style.color="";const _=(S,P,O)=>{const F=new Array(256),I=(p-f)/O,b=S/255,k=(P-S)/(255*O);let L=0;for(let M=0;M<=O;M++){const V=Math.round(f+M*I),D=b+M*k;for(let oe=L;oe<=V;oe++)F[oe]=D;L=V+1}for(let M=L;M<256;M++)F[M]=F[L-1];return F.join(",")},A=`g_${u(this,Cr)}_hcm_${t}_filter`,v=l.filter=C(this,J,Wc).call(this,A);return C(this,J,EA).call(this,v),C(this,J,Gd).call(this,_(g[0],y[0],5),_(g[1],y[1],5),_(g[2],y[2],5),v),l.url=C(this,J,qc).call(this,A),l.url}destroy(t=!1){var i,s,r,o;t&&((i=u(this,Tl))!=null&&i.size)||((s=u(this,Ir))==null||s.parentNode.parentNode.remove(),T(this,Ir,null),(r=u(this,Vu))==null||r.clear(),T(this,Vu,null),(o=u(this,Tl))==null||o.clear(),T(this,Tl,null),T(this,Sl,0))}}Al=new WeakMap,Vu=new WeakMap,Ir=new WeakMap,Cr=new WeakMap,mn=new WeakMap,Tl=new WeakMap,Sl=new WeakMap,J=new WeakSet,fn=function(){return u(this,Vu)||T(this,Vu,new Map)},qd=function(){return u(this,Tl)||T(this,Tl,new Map)},Hc=function(){if(!u(this,Ir)){const t=u(this,mn).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=u(this,mn).createElementNS(pr,"svg");s.setAttribute("width",0),s.setAttribute("height",0),T(this,Ir,u(this,mn).createElementNS(pr,"defs")),t.append(s),s.append(u(this,Ir)),u(this,mn).body.append(t)}return u(this,Ir)},yy=function(t){if(t.length===1){const c=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=c[p]/255;const f=h.join(",");return[f,f,f]}const[i,s,r]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let c=0;c<256;c++)o[c]=i[c]/255,a[c]=s[c]/255,l[c]=r[c]/255;return[o.join(","),a.join(","),l.join(",")]},qc=function(t){if(u(this,Al)===void 0){T(this,Al,"");const i=u(this,mn).URL;i!==u(this,mn).baseURI&&(r0(i)?Ee('#createUrl: ignore "data:"-URL for performance reasons.'):T(this,Al,i.split("#",1)[0]))}return`url(${u(this,Al)}#${t})`},eD=function(t){const i=u(this,mn).createElementNS(pr,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},EA=function(t){const i=u(this,mn).createElementNS(pr,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Wc=function(t){const i=u(this,mn).createElementNS(pr,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),u(this,J,Hc).append(i),i},Wd=function(t,i,s){const r=u(this,mn).createElementNS(pr,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Gd=function(t,i,s,r){const o=u(this,mn).createElementNS(pr,"feComponentTransfer");r.append(o),C(this,J,Wd).call(this,o,"feFuncR",t),C(this,J,Wd).call(this,o,"feFuncG",i),C(this,J,Wd).call(this,o,"feFuncB",s)},AA=function(t,i){const s=u(this,mn).createElementNS(pr,"feComponentTransfer");i.append(s),C(this,J,Wd).call(this,s,"feFuncA",t)},Kd=function(t){return u(this,J,Hc).style.color=t,gb(getComputedStyle(u(this,J,Hc)).getPropertyValue("color"))};class tD{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){He("Abstract method `_fetch` called.")}}class nD extends tD{async _fetch(e){const t=await s0(e,"arraybuffer");return new Uint8Array(t)}}async function iD(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class Nq extends Z2{}class Lq extends Q2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///home/runner/work/pdf.js/pdf.js/src/display/node_utils.js")("@napi-rs/canvas").createCanvas(e,t)}}class Dq extends Y2{async _fetch(e){return iD(e)}}class Mq extends tD{async _fetch(e){return iD(e)}}const wn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function TA(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class yb{getPattern(){He("Abstract method `getPattern` called.")}}class Oq extends yb{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===wn.STROKE||s===wn.FILL){const o=t.current.getClippedPathBoundingBox(s,nt(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),i=re.transform(i,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),TA(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else TA(e,this._bbox),r=this._createGradient(e);return r}}function bw(n,e,t,i,s,r,o,a){const l=e.coords,c=e.colors,h=n.data,f=n.width*4;let p;l[t+1]>l[i+1]&&(p=t,t=i,i=p,p=r,r=o,o=p),l[i+1]>l[s+1]&&(p=i,i=s,s=p,p=o,o=a,a=p),l[t+1]>l[i+1]&&(p=t,t=i,i=p,p=r,r=o,o=p);const g=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,_=(l[i]+e.offsetX)*e.scaleX,A=(l[i+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,E=(l[s+1]+e.offsetY)*e.scaleY;if(y>=E)return;const S=c[r],P=c[r+1],O=c[r+2],F=c[o],I=c[o+1],b=c[o+2],k=c[a],L=c[a+1],M=c[a+2],V=Math.round(y),D=Math.round(E);let oe,Pe,K,z,B,Q,ie,fe;for(let ne=V;ne<=D;ne++){if(ne<A){const _e=ne<y?0:(y-ne)/(y-A);oe=g-(g-_)*_e,Pe=S-(S-F)*_e,K=P-(P-I)*_e,z=O-(O-b)*_e}else{let _e;ne>E?_e=1:A===E?_e=0:_e=(A-ne)/(A-E),oe=_-(_-v)*_e,Pe=F-(F-k)*_e,K=I-(I-L)*_e,z=b-(b-M)*_e}let ae;ne<y?ae=0:ne>E?ae=1:ae=(y-ne)/(y-E),B=g-(g-v)*ae,Q=S-(S-k)*ae,ie=P-(P-L)*ae,fe=O-(O-M)*ae;const $e=Math.round(Math.min(oe,B)),Ke=Math.round(Math.max(oe,B));let De=f*ne+$e*4;for(let _e=$e;_e<=Ke;_e++)ae=(oe-_e)/(oe-B),ae<0?ae=0:ae>1&&(ae=1),h[De++]=Pe-(Pe-Q)*ae|0,h[De++]=K-(K-ie)*ae|0,h[De++]=z-(z-fe)*ae|0,h[De++]=255}}function Fq(n,e,t){const i=e.coords,s=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(i.length/a)-1,c=a-1;for(r=0;r<l;r++){let h=r*a;for(let f=0;f<c;f++,h++)bw(n,t,i[h],i[h+1],i[h+a],s[h],s[h+1],s[h+a]),bw(n,t,i[h+a+1],i[h+1],i[h+a],s[h+a+1],s[h+1],s[h+a])}break;case"triangles":for(r=0,o=i.length;r<o;r+=3)bw(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class Vq extends yb{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,h=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),g=c/f,y=h/p,_={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/g,scaleY:1/y},A=f+2*2,v=p+2*2,E=i.getCanvas("mesh",A,v),S=E.context,P=S.createImageData(f,p);if(t){const F=P.data;for(let I=0,b=F.length;I<b;I+=4)F[I]=t[0],F[I+1]=t[1],F[I+2]=t[2],F[I+3]=255}for(const F of this._figures)Fq(P,F,_);return S.putImageData(P,2,2),{canvas:E.canvas,offsetX:a-2*g,offsetY:l-2*y,scaleX:g,scaleY:y}}getPattern(e,t,i,s){TA(e,this._bbox);let r;if(s===wn.SHADING)r=re.singularValueDecompose2dScale(nt(e));else if(r=re.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=re.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,s===wn.SHADING?null:this._background,t.cachedCanvases);return s!==wn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class Uq extends yb{getPattern(){return"hotpink"}}function jq(n){switch(n[0]){case"RadialAxial":return new Oq(n);case"Mesh":return new Vq(n);case"Dummy":return new Uq}throw new Error(`Unknown IR type: ${n[0]}`)}const bR={COLORED:1,UNCOLORED:2},Wv=class Wv{constructor(e,t,i,s,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),t0("TilingType: "+r);const h=t[0],f=t[1],p=t[2],g=t[3],y=p-h,_=g-f,A=re.singularValueDecompose2dScale(this.matrix),v=re.singularValueDecompose2dScale(this.baseTransform),E=A[0]*v[0],S=A[1]*v[1];let P=y,O=_,F=!1,I=!1;const b=Math.ceil(l*E),k=Math.ceil(c*S),L=Math.ceil(y*E),M=Math.ceil(_*S);b>=L?P=l:F=!0,k>=M?O=c:I=!0;const V=this.getSizeAndScale(P,this.ctx.canvas.width,E),D=this.getSizeAndScale(O,this.ctx.canvas.height,S),oe=e.cachedCanvases.getCanvas("pattern",V.size,D.size),Pe=oe.context,K=a.createCanvasGraphics(Pe);if(K.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(K,s,o),Pe.translate(-V.scale*h,-D.scale*f),K.transform(V.scale,0,0,D.scale,0,0),Pe.save(),this.clipBbox(K,h,f,p,g),K.baseTransform=nt(K.ctx),K.executeOperatorList(i),K.endDrawing(),Pe.restore(),F||I){const z=oe.canvas;F&&(P=l),I&&(O=c);const B=this.getSizeAndScale(P,this.ctx.canvas.width,E),Q=this.getSizeAndScale(O,this.ctx.canvas.height,S),ie=B.size,fe=Q.size,ne=e.cachedCanvases.getCanvas("pattern-workaround",ie,fe),ae=ne.context,$e=F?Math.floor(y/l):0,Ke=I?Math.floor(_/c):0;for(let De=0;De<=$e;De++)for(let _e=0;_e<=Ke;_e++)ae.drawImage(z,ie*De,fe*_e,ie,fe,0,0,ie,fe);return{canvas:ne.canvas,scaleX:B.scale,scaleY:Q.scale,offsetX:h,offsetY:f}}return{canvas:oe.canvas,scaleX:V.scale,scaleY:D.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,i){const s=Math.max(Wv.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const o=s-t,a=r-i;e.ctx.rect(t,i,o,a),e.current.updateRectMinMax(nt(e.ctx),[t,i,s,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case bR.COLORED:const o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case bR.UNCOLORED:const a=re.makeHexColor(i[0],i[1],i[2]);s.fillStyle=a,s.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new dq(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,s){let r=i;s!==wn.SHADING&&(r=re.transform(r,t.baseTransform),this.matrix&&(r=re.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}};ce(Wv,"MAX_PATTERN_SIZE",3e3);let SA=Wv;function Bq({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Fn.isLittleEndian?4278190080:255,[l,c]=o?[r,a]:[a,r],h=i>>3,f=i&7,p=n.length;t=new Uint32Array(t.buffer);let g=0;for(let y=0;y<s;y++){for(const A=e+h;e<A;e++){const v=e<p?n[e]:255;t[g++]=v&128?c:l,t[g++]=v&64?c:l,t[g++]=v&32?c:l,t[g++]=v&16?c:l,t[g++]=v&8?c:l,t[g++]=v&4?c:l,t[g++]=v&2?c:l,t[g++]=v&1?c:l}if(f===0)continue;const _=e<p?n[e++]:255;for(let A=0;A<f;A++)t[g++]=_&1<<7-A?c:l}return{srcPos:e,destPos:g}}const IR=16,CR=100,$q=15,RR=10,kR=1e3,Kn=16;function zq(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,o,a,l){e.transform(i,s,r,o,a,l),this.__originalTransform(i,s,r,o,a,l)},n.setTransform=function(i,s,r,o,a,l){e.setTransform(i,s,r,o,a,l),this.__originalSetTransform(i,s,r,o,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,o,a){e.bezierCurveTo(t,i,s,r,o,a),this.__originalBezierCurveTo(t,i,s,r,o,a)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Hq{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Lm(n,e,t,i,s,r,o,a,l,c){const[h,f,p,g,y,_]=nt(n);if(f===0&&p===0){const E=o*h+y,S=Math.round(E),P=a*g+_,O=Math.round(P),F=(o+l)*h+y,I=Math.abs(Math.round(F)-S)||1,b=(a+c)*g+_,k=Math.abs(Math.round(b)-O)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(g),S,O),n.drawImage(e,t,i,s,r,0,0,I,k),n.setTransform(h,f,p,g,y,_),[I,k]}if(h===0&&g===0){const E=a*p+y,S=Math.round(E),P=o*f+_,O=Math.round(P),F=(a+c)*p+y,I=Math.abs(Math.round(F)-S)||1,b=(o+l)*f+_,k=Math.abs(Math.round(b)-O)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,S,O),n.drawImage(e,t,i,s,r,0,0,k,I),n.setTransform(h,f,p,g,y,_),[k,I]}n.drawImage(e,t,i,s,r,o,a,l,c);const A=Math.hypot(h,f),v=Math.hypot(p,g);return[A*l,v*c]}function qq(n){const{width:e,height:t}=n;if(e>kR||t>kR)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let o=new Uint8Array(r*(t+1)),a,l,c;const h=e+7&-8;let f=new Uint8Array(h*t),p=0;for(const v of n.data){let E=128;for(;E>0;)f[p++]=v&E?0:255,E>>=1}let g=0;for(p=0,f[p]!==0&&(o[0]=1,++g),l=1;l<e;l++)f[p]!==f[p+1]&&(o[l]=f[p]?2:1,++g),p++;for(f[p]!==0&&(o[l]=2,++g),a=1;a<t;a++){p=a*h,c=a*r,f[p-h]!==f[p]&&(o[c]=f[p]?1:8,++g);let v=(f[p]?4:0)+(f[p-h]?8:0);for(l=1;l<e;l++)v=(v>>2)+(f[p+1]?4:0)+(f[p-h+1]?8:0),s[v]&&(o[c+l]=s[v],++g),p++;if(f[p-h]!==f[p]&&(o[c+l]=f[p]?2:4,++g),g>i)return null}for(p=h*(t-1),c=a*r,f[p]!==0&&(o[c]=8,++g),l=1;l<e;l++)f[p]!==f[p+1]&&(o[c+l]=f[p]?4:8,++g),p++;if(f[p]!==0&&(o[c+l]=4,++g),g>i)return null;const y=new Int32Array([0,r,-1,0,-r,0,0,0,1]),_=new Path2D;for(a=0;g&&a<=t;a++){let v=a*r;const E=v+e;for(;v<E&&!o[v];)v++;if(v===E)continue;_.moveTo(v%r,a);const S=v;let P=o[v];do{const O=y[P];do v+=O;while(!o[v]);const F=o[v];F!==5&&F!==10?(P=F,o[v]=0):(P=F&51*P>>4,o[v]&=P>>2|P<<2),_.lineTo(v%r,v/r|0),o[v]||--g}while(S!==v);--a}return f=null,o=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(_),v.beginPath(),v.restore()}}class xR{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=w2,this.textMatrixScale=1,this.fontMatrix=QE,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=dn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=re.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=re.applyTransform(t,e),s=re.applyTransform(t.slice(2),e),r=re.applyTransform([t[0],t[3]],e),o=re.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],r[0],o[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],o[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],o[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],o[1])}updateScalingPathMinMax(e,t){re.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,r,o,a,l,c,h){const f=re.bezierBoundingBox(t,i,s,r,o,a,l,c,h);h||this.updateRectMinMax(e,f)}getPathBoundingBox(e=wn.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===wn.STROKE){t||He("Stroke bounding box must include transform.");const s=re.singularValueDecompose2dScale(t),r=s[0]*this.lineWidth/2,o=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=o,i[2]+=r,i[3]+=o}return i}updateClipFromPath(){const e=re.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=wn.FILL,t=null){return re.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function PR(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%Kn,r=(t-s)/Kn,o=s===0?r:r+1,a=n.createImageData(i,Kn);let l=0,c;const h=e.data,f=a.data;let p,g,y,_;if(e.kind===uy.GRAYSCALE_1BPP){const A=h.byteLength,v=new Uint32Array(f.buffer,0,f.byteLength>>2),E=v.length,S=i+7>>3,P=4294967295,O=Fn.isLittleEndian?4278190080:255;for(p=0;p<o;p++){for(y=p<r?Kn:s,c=0,g=0;g<y;g++){const F=A-l;let I=0;const b=F>S?i:F*8-7,k=b&-8;let L=0,M=0;for(;I<k;I+=8)M=h[l++],v[c++]=M&128?P:O,v[c++]=M&64?P:O,v[c++]=M&32?P:O,v[c++]=M&16?P:O,v[c++]=M&8?P:O,v[c++]=M&4?P:O,v[c++]=M&2?P:O,v[c++]=M&1?P:O;for(;I<b;I++)L===0&&(M=h[l++],L=128),v[c++]=M&L?P:O,L>>=1}for(;c<E;)v[c++]=0;n.putImageData(a,0,p*Kn)}}else if(e.kind===uy.RGBA_32BPP){for(g=0,_=i*Kn*4,p=0;p<r;p++)f.set(h.subarray(l,l+_)),l+=_,n.putImageData(a,0,g),g+=Kn;p<o&&(_=i*s*4,f.set(h.subarray(l,l+_)),n.putImageData(a,0,g))}else if(e.kind===uy.RGB_24BPP)for(y=Kn,_=i*y,p=0;p<o;p++){for(p>=r&&(y=s,_=i*y),c=0,g=_;g--;)f[c++]=h[l++],f[c++]=h[l++],f[c++]=h[l++],f[c++]=255;n.putImageData(a,0,p*Kn)}else throw new Error(`bad image kind: ${e.kind}`)}function NR(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%Kn,r=(t-s)/Kn,o=s===0?r:r+1,a=n.createImageData(i,Kn);let l=0;const c=e.data,h=a.data;for(let f=0;f<o;f++){const p=f<r?Kn:s;({srcPos:l}=Bq({src:c,srcPos:l,dest:h,width:i,height:p,nonBlackColor:0})),n.putImageData(a,0,f*Kn)}}function kd(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Dm(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Mn){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function LR(n,e){if(e)return!0;const t=re.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*xa.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const Wq=["butt","round","square"],Gq=["miter","round","bevel"],Kq={},DR={};var Na,bA,IA;const Eb=class Eb{constructor(e,t,i,s,r,{optionalContentConfig:o,markedContentStack:a=null},l,c){R(this,Na);this.ctx=e,this.current=new xR(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new Hq(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const l=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...nt(this.compositeCtx))}this.ctx.save(),Dm(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=nt(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const c=l-a>RR&&typeof i=="function",h=c?Date.now()+$q:0;let f=0;const p=this.commonObjs,g=this.objs;let y;for(;;){if(s!==void 0&&a===s.nextBreakPoint)return s.breakIt(a,i),a;if(y=o[a],y!==es.dependency)this[y].apply(this,r[a]);else for(const _ of r[a]){const A=_.startsWith("g_")?p:g;if(!A.has(_))return A.get(_,i),a}if(a++,a===l)return a;if(c&&++f>RR){if(Date.now()>h)return i(),a;f=0}}}endDrawing(){C(this,Na,bA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),C(this,Na,IA).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=i,l=s,c="prescale1",h,f;for(;r>2&&a>1||o>2&&l>1;){let p=a,g=l;r>2&&a>1&&(p=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/p),o>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/g),h=this.cachedCanvases.getCanvas(c,p,g),f=h.context,f.clearRect(0,0,p,g),f.drawImage(e,0,0,a,l,0,0,p,g),e=h.canvas,a=p,l=g,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,o=this.current.patternFill,a=nt(t);let l,c,h,f;if((e.bitmap||e.data)&&e.count>1){const b=e.bitmap||e.data.buffer;c=JSON.stringify(o?a:[a.slice(0,4),r]),l=this._cachedBitmapsMap.get(b),l||(l=new Map,this._cachedBitmapsMap.set(b,l));const k=l.get(c);if(k&&!o){const L=Math.round(Math.min(a[0],a[2])+a[4]),M=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:k,offsetX:L,offsetY:M}}h=k}h||(f=this.cachedCanvases.getCanvas("maskCanvas",i,s),NR(f.context,e));let p=re.transform(a,[1/i,0,0,-1/s,0,0]);p=re.transform(p,[1,0,0,1,0,-s]);const[g,y,_,A]=re.getAxialAlignedBoundingBox([0,0,i,s],p),v=Math.round(_-g)||1,E=Math.round(A-y)||1,S=this.cachedCanvases.getCanvas("fillCanvas",v,E),P=S.context,O=g,F=y;P.translate(-O,-F),P.transform(...p),h||(h=this._scaleImage(f.canvas,ks(P)),h=h.img,l&&o&&l.set(c,h)),P.imageSmoothingEnabled=LR(nt(P),e.interpolate),Lm(P,h,0,0,h.width,h.height,0,0,i,s),P.globalCompositeOperation="source-in";const I=re.transform(ks(P),[1,0,0,1,-O,-F]);return P.fillStyle=o?r.getPattern(t,this,I,wn.FILL):r,P.fillRect(0,0,i,s),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,S.canvas)),{canvas:S.canvas,offsetX:Math.round(O),offsetY:Math.round(F)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Wq[e]}setLineJoin(e){this.ctx.lineJoin=Gq[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...nt(this.suspendedCtx)),kd(this.suspendedCtx,r),zq(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),kd(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],o=s[1],a=s[2]-r,l=s[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,i,a,l,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,o,a,l,c,h,f){let p=e.canvas,g=l-h,y=c-f;if(o){const A=re.makeHexColor(...o);if(g<0||y<0||g+i>p.width||y+s>p.height){const v=this.cachedCanvases.getCanvas("maskExtension",i,s),E=v.context;E.drawImage(p,-g,-y),E.globalCompositeOperation="destination-atop",E.fillStyle=A,E.fillRect(0,0,i,s),E.globalCompositeOperation="source-over",p=v.canvas,g=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(g,y,i,s),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=A,e.fillRect(g,y,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const _=new Path2D;_.rect(l,c,i,s),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(p,g,y,i,s,l,c,i,s),t.restore()}save(){this.inSMaskMode?(kd(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),kd(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,r,o){this.ctx.transform(e,t,i,s,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const s=this.ctx,r=this.current;let o=r.x,a=r.y,l,c;const h=nt(s),f=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=f?i.slice(0):null;for(let g=0,y=0,_=e.length;g<_;g++)switch(e[g]|0){case es.rectangle:o=t[y++],a=t[y++];const A=t[y++],v=t[y++],E=o+A,S=a+v;s.moveTo(o,a),A===0||v===0?s.lineTo(E,S):(s.lineTo(E,a),s.lineTo(E,S),s.lineTo(o,S)),f||r.updateRectMinMax(h,[o,a,E,S]),s.closePath();break;case es.moveTo:o=t[y++],a=t[y++],s.moveTo(o,a),f||r.updatePathMinMax(h,o,a);break;case es.lineTo:o=t[y++],a=t[y++],s.lineTo(o,a),f||r.updatePathMinMax(h,o,a);break;case es.curveTo:l=o,c=a,o=t[y+4],a=t[y+5],s.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],o,a),r.updateCurvePathMinMax(h,l,c,t[y],t[y+1],t[y+2],t[y+3],o,a,p),y+=6;break;case es.curveTo2:l=o,c=a,s.bezierCurveTo(o,a,t[y],t[y+1],t[y+2],t[y+3]),r.updateCurvePathMinMax(h,l,c,o,a,t[y],t[y+1],t[y+2],t[y+3],p),o=t[y+2],a=t[y+3],y+=4;break;case es.curveTo3:l=o,c=a,o=t[y+2],a=t[y+3],s.bezierCurveTo(t[y],t[y+1],o,a,o,a),r.updateCurvePathMinMax(h,l,c,t[y],t[y+1],o,a,o,a,p),y+=4;break;case es.closePath:s.closePath();break}f&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(t.save(),t.strokeStyle=i.getPattern(t,this,ks(t),wn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,ks(t),wn.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Kq}eoClip(){this.pendingClip=DR}beginText(){this.current.textMatrix=w2,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const i of e)t.setTransform(...i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||QE,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ee("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",o=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let a="normal";i.black?a="900":i.bold&&(a="bold");const l=i.italic?"italic":"normal";let c=t;t<IR?c=IR:t>CR&&(c=CR),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${a} ${c}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,r,o){this.current.textMatrix=[e,t,i,s,r,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,h=a.fontSize/a.fontSizeScale,f=c&dn.FILL_STROKE_MASK,p=!!(c&dn.ADD_TO_PATH_FLAG),g=a.patternFill&&!l.missingFile,y=a.patternStroke&&!l.missingFile;let _;(l.disableFontFace||p||g||y)&&(_=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||g||y?(o.save(),o.translate(t,i),o.beginPath(),_(o,h),(f===dn.FILL||f===dn.FILL_STROKE)&&(s&&o.setTransform(...s),o.fill()),(f===dn.STROKE||f===dn.FILL_STROKE)&&(r&&o.setTransform(...r),o.stroke()),o.restore()):((f===dn.FILL||f===dn.FILL_STROKE)&&o.fillText(e,t,i),(f===dn.STROKE||f===dn.FILL_STROKE)&&o.strokeText(e,t,i)),p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:nt(o),x:t,y:i,fontSize:h,addToPath:_})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return Te(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,h=t.textHScale*c,f=e.length,p=i.vertical,g=p?1:-1,y=i.defaultVMetrics,_=s*t.fontMatrix[0],A=t.textRenderingMode===dn.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),c>0?r.scale(h,-1):r.scale(h,1);let v,E;if(t.patternFill){r.save();const I=t.fillColor.getPattern(r,this,ks(r),wn.FILL);v=nt(r),r.restore(),r.fillStyle=I}if(t.patternStroke){r.save();const I=t.strokeColor.getPattern(r,this,ks(r),wn.STROKE);E=nt(r),r.restore(),r.strokeStyle=I}let S=t.lineWidth;const P=t.textMatrixScale;if(P===0||S===0){const I=t.textRenderingMode&dn.FILL_STROKE_MASK;(I===dn.STROKE||I===dn.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=P;if(o!==1&&(r.scale(o,o),S/=o),r.lineWidth=S,i.isInvalidPDFjsFont){const I=[];let b=0;for(const k of e)I.push(k.unicode),b+=k.width;r.fillText(I.join(""),0,0),t.x+=b*_*h,r.restore(),this.compose();return}let O=0,F;for(F=0;F<f;++F){const I=e[F];if(typeof I=="number"){O+=g*I*s/1e3;continue}let b=!1;const k=(I.isSpace?l:0)+a,L=I.fontChar,M=I.accent;let V,D,oe=I.width;if(p){const K=I.vmetric||y,z=-(I.vmetric?K[1]:oe*.5)*_,B=K[2]*_;oe=K?-K[0]:oe,V=z/o,D=(O+B)/o}else V=O/o,D=0;if(i.remeasure&&oe>0){const K=r.measureText(L).width*1e3/s*o;if(oe<K&&this.isFontSubpixelAAEnabled){const z=oe/K;b=!0,r.save(),r.scale(z,1),V/=z}else oe!==K&&(V+=(oe-K)/2e3*s/o)}if(this.contentVisible&&(I.isInFont||i.missingFile)){if(A&&!M)r.fillText(L,V,D);else if(this.paintChar(L,V,D,v,E),M){const K=V+s*M.offset.x/o,z=D-s*M.offset.y/o;this.paintChar(M.fontChar,K,z,v,E)}}const Pe=p?oe*_-k*c:oe*_+k*c;O+=Pe,b&&r.restore()}p?t.y-=O:t.x+=O*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,o=i.fontDirection,a=s.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*o,f=i.fontMatrix||QE,p=e.length,g=i.textRenderingMode===dn.INVISIBLE;let y,_,A,v;if(!(g||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(h,o),y=0;y<p;++y){if(_=e[y],typeof _=="number"){v=a*_*r/1e3,this.ctx.translate(v,0),i.x+=v*h;continue}const E=(_.isSpace?c:0)+l,S=s.charProcOperatorList[_.operatorListId];if(!S){Ee(`Type3 character "${_.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=_,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(S),this.restore()),A=re.applyTransform([_.width,0],f)[0]*r+E,t.translate(A,0),i.x+=A*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,o){this.ctx.rect(i,s,r-i,o-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],s=this.baseTransform||nt(this.ctx),r={createCanvasGraphics:o=>new Eb(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new SA(e,i,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=re.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=re.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=jq(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,ks(t),wn.SHADING);const s=ks(t);if(s){const{width:r,height:o}=t.canvas,[a,l,c,h]=re.getAxialAlignedBoundingBox([0,0,r,o],s);this.ctx.fillRect(a,l,c-a,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){He("Should not call beginInlineImage")}beginImageData(){He("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=nt(this.ctx),t)){const i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(nt(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||t0("TODO: Support non-isolated groups."),e.knockout&&Ee("Knockout groups not supported.");const i=nt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=re.getAxialAlignedBoundingBox(e.bbox,nt(t));const r=[0,0,t.canvas.width,t.canvas.height];s=re.intersect(s,r)||[0,0,0,0];const o=Math.floor(s[0]),a=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-o,1),c=Math.max(Math.ceil(s[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,l,c),p=f.context;p.translate(-o,-a),p.transform(...i),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),kd(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=nt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=re.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(C(this,Na,bA).call(this),Dm(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;const[l,c]=re.singularValueDecompose2dScale(nt(this.ctx)),{viewportScale:h}=this,f=Math.ceil(o*this.outputScaleX*h),p=Math.ceil(a*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:g,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,a*c),Dm(this.ctx)}else Dm(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new xR(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),C(this,Na,IA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=qq(e)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(e),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=nt(a);a.transform(t,i,s,r,0,0);const c=this._createMaskCanvas(e);a.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,f=o.length;h<f;h+=2){const p=re.transform(l,[t,i,s,r,o[h],o[h+1]]),[g,y]=re.applyTransform([0,0],p);a.drawImage(c.canvas,g,y)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:o,width:a,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",a,l),f=h.context;f.save();const p=this.getObject(o,r);NR(f,p),f.globalCompositeOperation="source-in",f.fillStyle=s?i.getPattern(f,this,ks(t),wn.FILL):i,f.fillRect(0,0,a,l),f.restore(),t.save(),t.transform(...c),t.scale(1,-1),Lm(t,h.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ee("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){Ee("Dependent image isn't ready yet");return}const o=r.width,a=r.height,l=[];for(let c=0,h=s.length;c<h;c+=2)l.push({transform:[t,0,0,i,s[c],s[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;if(this.save(),!Mn){const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none")}s.scale(1/t,-1/i);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;PR(l,e),r=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(r,ks(s));s.imageSmoothingEnabled=LR(nt(s),e.interpolate),Lm(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,o).context;PR(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),Lm(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===DR?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=nt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let o,a;if(i===0&&s===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)o=a=1/l;else{const h=l*e;o=a=h<1?1/h:1}else if(e===0)o=1/l,a=1/c;else{const h=l*e,f=c*e;o=h<1?1/h:1,a=f<1?1/f:1}}else{const l=Math.abs(t*r-i*s),c=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)o=h/l,a=c/l;else{const f=e*l;o=h>f?h/f:1,a=c>f?c/f:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&r===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(s,r),o.length>0){const a=Math.max(s,r);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Na=new WeakSet,bA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},IA=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}};let Au=Eb;for(const n in es)Au.prototype[n]!==void 0&&(Au.prototype[es[n]]=Au.prototype[n]);var Ep,Ap;class qr{static get workerPort(){return u(this,Ep)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");T(this,Ep,e)}static get workerSrc(){return u(this,Ap)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");T(this,Ap,e)}}Ep=new WeakMap,Ap=new WeakMap,R(qr,Ep,null),R(qr,Ap,"");const Mm={UNKNOWN:0,DATA:1,ERROR:2},Tt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function oi(n){switch(n instanceof Error||typeof n=="object"&&n!==null||He('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Pc(n.message);case"MissingPDFException":return new Fg(n.message);case"PasswordException":return new YE(n.message,n.code);case"UnexpectedResponseException":return new n0(n.message,n.status);case"UnknownErrorException":return new JE(n.message,n.details);default:return new JE(n.message,n.toString())}}var Uu,qi,sD,rD,oD,vy;class Xd{constructor(e,t,i){R(this,qi);R(this,Uu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",C(this,qi,sD).bind(this),{signal:u(this,Uu).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:c.desiredSize},s),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:o,targetName:a,stream:Tt.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Ct(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Tt.CANCEL,streamId:r,reason:oi(c)}),h.promise}},i)}destroy(){var e;(e=u(this,Uu))==null||e.abort(),T(this,Uu,null)}}Uu=new WeakMap,qi=new WeakSet,sD=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){C(this,qi,oD).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Mm.DATA)s.resolve(e.data);else if(e.callback===Mm.ERROR)s.reject(oi(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;new Promise(function(o){o(t(e.data))}).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:Mm.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:Mm.ERROR,callbackId:e.callbackId,reason:oi(o)})});return}if(e.streamId){C(this,qi,rD).call(this,e);return}t(e.data)},rD=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(c,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Tt.ENQUEUE,streamId:t,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Tt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){Ct(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Tt.ERROR,streamId:t,reason:oi(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(c){c(a(e.data,l))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:i,targetName:s,stream:Tt.START_COMPLETE,streamId:t,reason:oi(c)})})},oD=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Tt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(oi(e.reason));break;case Tt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(oi(e.reason));break;case Tt.PULL:if(!a){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(l){var c;l((c=a.onPull)==null?void 0:c.call(a))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:Tt.PULL_COMPLETE,streamId:t,reason:oi(l)})});break;case Tt.ENQUEUE:if(Ct(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Tt.CLOSE:if(Ct(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),C(this,qi,vy).call(this,o,t);break;case Tt.ERROR:Ct(o,"error should have stream controller"),o.controller.error(oi(e.reason)),C(this,qi,vy).call(this,o,t);break;case Tt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(oi(e.reason)),C(this,qi,vy).call(this,o,t);break;case Tt.CANCEL:if(!a)break;new Promise(function(l){var c;l((c=a.onCancel)==null?void 0:c.call(a,oi(e.reason)))}).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Tt.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){r.postMessage({sourceName:i,targetName:s,stream:Tt.CANCEL_COMPLETE,streamId:t,reason:oi(l)})}),a.sinkCapability.reject(oi(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},vy=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var bl,Tp;class Xq{constructor({parsedData:e,rawData:t}){R(this,bl);R(this,Tp);T(this,bl,e),T(this,Tp,t)}getRaw(){return u(this,Tp)}get(e){return u(this,bl).get(e)??null}getAll(){return ub(u(this,bl))}has(e){return u(this,bl).has(e)}}bl=new WeakMap,Tp=new WeakMap;const Gc=Symbol("INTERNAL");var Sp,bp,Ip,ju;class Qq{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){R(this,Sp,!1);R(this,bp,!1);R(this,Ip,!1);R(this,ju,!0);T(this,Sp,!!(e&yi.DISPLAY)),T(this,bp,!!(e&yi.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(u(this,Ip))return u(this,ju);if(!u(this,ju))return!1;const{print:e,view:t}=this.usage;return u(this,Sp)?(t==null?void 0:t.viewState)!=="OFF":u(this,bp)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Gc&&He("Internal method `_setVisible` called."),T(this,Ip,i),T(this,ju,t)}}Sp=new WeakMap,bp=new WeakMap,Ip=new WeakMap,ju=new WeakMap;var qo,je,Bu,$u,Cp,CA;class Yq{constructor(e,t=yi.DISPLAY){R(this,Cp);R(this,qo,null);R(this,je,new Map);R(this,Bu,null);R(this,$u,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,T(this,$u,e.order);for(const i of e.groups)u(this,je).set(i.id,new Qq(t,i));if(e.baseState==="OFF")for(const i of u(this,je).values())i._setVisible(Gc,!1);for(const i of e.on)u(this,je).get(i)._setVisible(Gc,!0);for(const i of e.off)u(this,je).get(i)._setVisible(Gc,!1);T(this,Bu,this.getHash())}}isVisible(e){if(u(this,je).size===0)return!0;if(!e)return t0("Optional content group not defined."),!0;if(e.type==="OCG")return u(this,je).has(e.id)?u(this,je).get(e.id).visible:(Ee(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return C(this,Cp,CA).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!u(this,je).has(t))return Ee(`Optional content group not found: ${t}`),!0;if(u(this,je).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!u(this,je).has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!u(this,je).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!u(this,je).has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!u(this,je).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!u(this,je).has(t))return Ee(`Optional content group not found: ${t}`),!0;if(u(this,je).get(t).visible)return!1}return!0}return Ee(`Unknown optional content policy ${e.policy}.`),!0}return Ee(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=u(this,je).get(e);if(!s){Ee(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const a of o)a!==e&&((r=u(this,je).get(a))==null||r._setVisible(Gc,!1,!0));s._setVisible(Gc,!!t,!0),T(this,qo,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=u(this,je).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}T(this,qo,null)}get hasInitialVisibility(){return u(this,Bu)===null||this.getHash()===u(this,Bu)}getOrder(){return u(this,je).size?u(this,$u)?u(this,$u).slice():[...u(this,je).keys()]:null}getGroups(){return u(this,je).size>0?ub(u(this,je)):null}getGroup(e){return u(this,je).get(e)||null}getHash(){if(u(this,qo)!==null)return u(this,qo);const e=new G2;for(const[t,i]of u(this,je))e.update(`${t}:${i.visible}`);return T(this,qo,e.hexdigest())}}qo=new WeakMap,je=new WeakMap,Bu=new WeakMap,$u=new WeakMap,Cp=new WeakSet,CA=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let o;if(Array.isArray(r))o=C(this,Cp,CA).call(this,r);else if(u(this,je).has(r))o=u(this,je).get(r).visible;else return Ee(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"};class Jq{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Ct(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});Ct(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ct(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Zq(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new eW(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class Zq{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=fb(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class eW{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function tW(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=a(t);return h=unescape(h),h=l(h),h=c(h),r(h)}if(t=o(n),t){const h=c(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=a(t);return h=c(h),r(h)}function i(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),g=i0(f);f=p.decode(g),e=!1}catch{}}return f}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function o(h){const f=[];let p;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(h))!==null;){let[,_,A,v]=p;if(_=parseInt(_,10),_ in f){if(_===0)break;continue}f[_]=[A,v]}const y=[];for(let _=0;_<f.length&&_ in f;++_){let[A,v]=f[_];v=a(v),A&&(v=unescape(v),_===0&&(v=l(v))),y.push(v)}return y.join("")}function a(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),y=h.slice(f+1).replace(/^[^']*'/,"");return s(p,y)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,y){if(g==="q"||g==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,A){return String.fromCharCode(parseInt(A,16))}),s(p,y);try{y=atob(y)}catch{}return s(p,y)})}return""}function aD(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function o0(n){try{return new URL(n).origin}catch{}return null}function lD({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function cD(n){const e=n.get("Content-Disposition");if(e){let t=tW(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(fb(t))return t}return null}function a0(n,e){return n===404||n===0&&e.startsWith("file:")?new Fg('Missing PDF "'+e+'".'):new n0(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function uD(n){return n===200||n===206}function hD(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function dD(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ee(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class MR{constructor(e){ce(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=aD(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ct(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new nW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new iW(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class nW{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,hD(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=o0(r.url),!uD(r.status))throw a0(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:l}=lD({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=cD(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Pc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class iW{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const o=s.url;fetch(o,hD(r,this._withCredentials,this._abortController)).then(a=>{const l=o0(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!uD(a.status))throw a0(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:dD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Iw=200,Cw=206;function sW(n){const e=n.response;return typeof e!="string"?e:i0(e).buffer}class rW{constructor({url:e,httpHeaders:t,withCredentials:i}){ce(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=aD(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,i){const s={begin:e,end:t};for(const r in i)s[r]=i[r];return this.request(s)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Cw):s.expectedStatus=Iw,t.responseType="arraybuffer",e.onError&&(t.onerror=function(r){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){var l,c,h;const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){(l=i.onError)==null||l.call(i,s.status);return}const r=s.status||Iw;if(!(r===Iw&&i.expectedStatus===Cw)&&r!==i.expectedStatus){(c=i.onError)==null||c.call(i,s.status);return}const a=sW(s);if(r===Cw){const f=s.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);i.onDone({begin:parseInt(p[1],10),chunk:a})}else a?i.onDone({begin:0,chunk:a}):(h=i.onError)==null||h.call(i,s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class oW{constructor(e){this._source=e,this._manager=new rW(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ct(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new aW(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new lW(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class aW{constructor(e,t){this._manager=e;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(i),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=o0(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trim().split(/[\r\n]+/).map(a=>{const[l,...c]=a.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=lD({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=cD(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=a0(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class lW{constructor(e,t,i){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=o0((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=a0(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const cW=/^[a-z][a-z0-9\-+.]+:/i;function uW(n){if(cW.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class hW{constructor(e){this.source=e,this.url=uW(e.url),Ct(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ct(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new dW(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new fW(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class dW{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new Fg(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Pc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class fW{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const pW=1e5,$n=30,gW=.8;var jR,Wo,qn,Rp,kp,Il,Rr,xp,Pp,Cl,zu,Hu,Go,qu,Np,Wu,Rl,Lp,Dp,kl,xl,Mp,Ko,Gu,po,fD,pD,RA,Ii,_y,kA,gD,mD;const xt=class xt{constructor({textContentSource:e,container:t,viewport:i}){R(this,po);R(this,Wo,Promise.withResolvers());R(this,qn,null);R(this,Rp,!1);R(this,kp,!!((jR=globalThis.FontInspector)!=null&&jR.enabled));R(this,Il,null);R(this,Rr,null);R(this,xp,0);R(this,Pp,0);R(this,Cl,null);R(this,zu,null);R(this,Hu,0);R(this,Go,0);R(this,qu,Object.create(null));R(this,Np,[]);R(this,Wu,null);R(this,Rl,[]);R(this,Lp,new WeakMap);R(this,Dp,null);var l;if(e instanceof ReadableStream)T(this,Wu,e);else if(typeof e=="object")T(this,Wu,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,qn,T(this,zu,t)),T(this,Go,i.scale*(globalThis.devicePixelRatio||1)),T(this,Hu,i.rotation),T(this,Rr,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:o,pageY:a}=i.rawDims;T(this,Dp,[1,0,0,-1,-o,a+r]),T(this,Pp,s),T(this,xp,r),C(l=xt,Ii,gD).call(l),yc(t,i),u(this,Wo).promise.finally(()=>{u(xt,Gu).delete(this),T(this,Rr,null),T(this,qu,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Fn.platform;return Te(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{u(this,Cl).read().then(({value:t,done:i})=>{if(i){u(this,Wo).resolve();return}u(this,Il)??T(this,Il,t.lang),Object.assign(u(this,qu),t.styles),C(this,po,fD).call(this,t.items),e()},u(this,Wo).reject)};return T(this,Cl,u(this,Wu).getReader()),u(xt,Gu).add(this),e(),u(this,Wo).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==u(this,Hu)&&(t==null||t(),T(this,Hu,s),yc(u(this,zu),{rotation:s})),i!==u(this,Go)){t==null||t(),T(this,Go,i);const o={div:null,properties:null,ctx:C(r=xt,Ii,_y).call(r,u(this,Il))};for(const a of u(this,Rl))o.properties=u(this,Lp).get(a),o.div=a,C(this,po,RA).call(this,o)}}cancel(){var t;const e=new Pc("TextLayer task cancelled.");(t=u(this,Cl))==null||t.cancel(e).catch(()=>{}),T(this,Cl,null),u(this,Wo).reject(e)}get textDivs(){return u(this,Rl)}get textContentItemsStr(){return u(this,Np)}static cleanup(){if(!(u(this,Gu).size>0)){u(this,kl).clear();for(const{canvas:e}of u(this,xl).values())e.remove();u(this,xl).clear()}}};Wo=new WeakMap,qn=new WeakMap,Rp=new WeakMap,kp=new WeakMap,Il=new WeakMap,Rr=new WeakMap,xp=new WeakMap,Pp=new WeakMap,Cl=new WeakMap,zu=new WeakMap,Hu=new WeakMap,Go=new WeakMap,qu=new WeakMap,Np=new WeakMap,Wu=new WeakMap,Rl=new WeakMap,Lp=new WeakMap,Dp=new WeakMap,kl=new WeakMap,xl=new WeakMap,Mp=new WeakMap,Ko=new WeakMap,Gu=new WeakMap,po=new WeakSet,fD=function(e){var s,r;if(u(this,Rp))return;(r=u(this,Rr)).ctx??(r.ctx=C(s=xt,Ii,_y).call(s,u(this,Il)));const t=u(this,Rl),i=u(this,Np);for(const o of e){if(t.length>pW){Ee("Ignoring additional textDivs for performance reasons."),T(this,Rp,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=u(this,qn);T(this,qn,document.createElement("span")),u(this,qn).classList.add("markedContent"),o.id!==null&&u(this,qn).setAttribute("id",`${o.id}`),a.append(u(this,qn))}else o.type==="endMarkedContent"&&T(this,qn,u(this,qn).parentNode);continue}i.push(o.str),C(this,po,pD).call(this,o)}},pD=function(e){var _;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};u(this,Rl).push(t);const s=re.transform(u(this,Dp),e.transform);let r=Math.atan2(s[1],s[0]);const o=u(this,qu)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=u(this,kp)&&o.fontSubstitution||o.fontFamily;a=xt.fontFamilyMap.get(a)||a;const l=Math.hypot(s[2],s[3]),c=l*C(_=xt,Ii,mD).call(_,a,u(this,Il));let h,f;r===0?(h=s[4],f=s[5]-c):(h=s[4]+c*Math.sin(r),f=s[5]-c*Math.cos(r));const p="calc(var(--scale-factor)*",g=t.style;u(this,qn)===u(this,zu)?(g.left=`${(100*h/u(this,Pp)).toFixed(2)}%`,g.top=`${(100*f/u(this,xp)).toFixed(2)}%`):(g.left=`${p}${h.toFixed(2)}px)`,g.top=`${p}${f.toFixed(2)}px)`),g.fontSize=`${p}${(u(xt,Ko)*l).toFixed(2)}px)`,g.fontFamily=a,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,u(this,kp)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);A!==v&&Math.max(A,v)/Math.min(A,v)>1.5&&(y=!0)}if(y&&(i.canvasWidth=o.vertical?e.height:e.width),u(this,Lp).set(t,i),u(this,Rr).div=t,u(this,Rr).properties=i,C(this,po,RA).call(this,u(this,Rr)),i.hasText&&u(this,qn).append(t),i.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),u(this,qn).append(A)}},RA=function(e){var a;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let o="";if(u(xt,Ko)>1&&(o=`scale(${1/u(xt,Ko)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:h}=i;C(a=xt,Ii,kA).call(a,s,h*u(this,Go),l);const{width:f}=s.measureText(t.textContent);f>0&&(o=`scaleX(${c*u(this,Go)/f}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Ii=new WeakSet,_y=function(e=null){let t=u(this,xl).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,xl).set(e,t),u(this,Mp).set(t,{size:0,family:""})}return t},kA=function(e,t,i){const s=u(this,Mp).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},gD=function(){if(u(this,Ko)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),T(this,Ko,e.getBoundingClientRect().height),e.remove()},mD=function(e,t){const i=u(this,kl).get(e);if(i)return i;const s=C(this,Ii,_y).call(this,t);s.canvas.width=s.canvas.height=$n,C(this,Ii,kA).call(this,s,$n,e);const r=s.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const h=o/(o+a);return u(this,kl).set(e,h),s.canvas.width=s.canvas.height=0,h}s.strokeStyle="red",s.clearRect(0,0,$n,$n),s.strokeText("g",0,0);let l=s.getImageData(0,0,$n,$n).data;a=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){a=Math.ceil(h/4/$n);break}s.clearRect(0,0,$n,$n),s.strokeText("A",0,$n),l=s.getImageData(0,0,$n,$n).data,o=0;for(let h=0,f=l.length;h<f;h+=4)if(l[h]>0){o=$n-Math.floor(h/4/$n);break}s.canvas.width=s.canvas.height=0;const c=o?o/(o+a):gW;return u(this,kl).set(e,c),c},R(xt,Ii),R(xt,kl,new Map),R(xt,xl,new Map),R(xt,Mp,new WeakMap),R(xt,Ko,null),R(xt,Gu,new Set);let Yf=xt;class Jf{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Jf.shouldBuildText(a))(l=r==null?void 0:r.attributes)!=null&&l.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const c of r.children)s(c)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const mW=65536,yW=100,vW=5e3,_W=Mn?Lq:xq,wW=Mn?Dq:J2,EW=Mn?Nq:Pq,AW=Mn?Mq:nD;function TW(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new xA,{docId:t}=e,i=n.url?SW(n.url):null,s=n.data?bW(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof yD?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:mW;let h=n.worker instanceof Tu?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!r0(n.docBaseUrl)?n.docBaseUrl:null,g=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,_=n.CMapReaderFactory||wW,A=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||AW,E=n.stopAtErrors!==!0,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,P=n.isEvalSupported!==!1,O=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Mn,F=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Mn&&(Fn.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,b=typeof n.disableFontFace=="boolean"?n.disableFontFace:Mn,k=n.fontExtraProperties===!0,L=n.enableXfa===!0,M=n.ownerDocument||globalThis.document,V=n.disableRange===!0,D=n.disableStream===!0,oe=n.disableAutoFetch===!0,Pe=n.pdfBug===!0,K=n.CanvasFactory||_W,z=n.FilterFactory||EW,B=n.enableHWA===!0,Q=l?l.length:n.length??NaN,ie=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Mn&&!b,fe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:_===J2&&v===nD&&g&&A&&Bd(g,document.baseURI)&&Bd(A,document.baseURI);n.canvasFactory&&TR("`canvasFactory`-instance option, please use `CanvasFactory` instead."),n.filterFactory&&TR("`filterFactory`-instance option, please use `FilterFactory` instead.");const ne=null;lq(f);const ae={canvasFactory:new K({ownerDocument:M,enableHWA:B}),filterFactory:new z({docId:t,ownerDocument:M}),cMapReaderFactory:fe?null:new _({baseUrl:g,isCompressed:y}),standardFontDataFactory:fe?null:new v({baseUrl:A})};if(!h){const De={verbosity:f,port:qr.workerPort};h=De.port?Tu.fromPort(De):new Tu(De),e._worker=h}const $e={docId:t,apiVersion:"4.9.124",data:s,password:a,disableAutoFetch:oe,rangeChunkSize:c,length:Q,docBaseUrl:p,enableXfa:L,evaluatorOptions:{maxImageSize:S,disableFontFace:b,ignoreErrors:E,isEvalSupported:P,isOffscreenCanvasSupported:O,isImageDecoderSupported:F,canvasMaxAreaInBytes:I,fontExtraProperties:k,useSystemFonts:ie,cMapUrl:fe?g:null,standardFontDataUrl:fe?A:null}},Ke={disableFontFace:b,fontExtraProperties:k,ownerDocument:M,pdfBug:Pe,styleElement:ne,loadingParams:{disableAutoFetch:oe,enableXfa:L}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const De=h.messageHandler.sendWithPromise("GetDocRequest",$e,s?[s.buffer]:null);let _e;if(l)_e=new Jq(l,{disableRange:V,disableStream:D});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Cs;if(Mn)if(Bd(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Cs=MR}else Cs=hW;else Cs=Bd(i)?MR:oW;_e=new Cs({url:i,length:Q,httpHeaders:r,withCredentials:o,rangeChunkSize:c,disableRange:V,disableStream:D})}return De.then(Cs=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Bg=new Xd(t,Cs,h.port),Lc=new kW(Bg,e,_e,Ke,ae);e._transport=Lc,Bg.send("Ready",null)})}).catch(e._capability.reject),e}function SW(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Mn&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function bW(n){if(Mn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return i0(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function OR(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var Gv;const Kv=class Kv{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Rn(Kv,Gv)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};Gv=new WeakMap,R(Kv,Gv,0);let xA=Kv;class yD{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){He("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class IW{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Te(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Xo,kr,Bi,Kc,wy;class CW{constructor(e,t,i,s=!1){R(this,Bi);R(this,Xo,null);R(this,kr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new AR:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new vD,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new Vg({viewBox:this.view,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Te(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=Po.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:f=!1}){var P,O;(P=this._stats)==null||P.time("Overall");const p=this._transport.getRenderingIntent(i,s,h,f),{renderingIntent:g,cacheKey:y}=p;T(this,kr,!1),C(this,Bi,wy).call(this),a||(a=this._transport.getOptionalContentConfig(g));let _=this._intentStates.get(y);_||(_=Object.create(null),this._intentStates.set(y,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const A=!!(g&yi.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(O=this._stats)==null||O.time("Page Request"),this._pumpOperatorList(p));const v=F=>{var I;_.renderTasks.delete(E),(this._maybeCleanupAfterRender||A)&&T(this,kr,!0),C(this,Bi,Kc).call(this,!A),F?(E.capability.reject(F),this._abortOperatorList({intentState:_,reason:F instanceof Error?F:new Error(F)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(I=globalThis.Stats)!=null&&I.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new NA({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:c});(_.renderTasks||(_.renderTasks=new Set)).add(E);const S=E.task;return Promise.all([_.displayReadyCapability.promise,a]).then(([F,I])=>{var b;if(this.destroyed){v();return}if((b=this._stats)==null||b.time("Rendering"),!(I.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:F,optionalContentConfig:I}),E.operatorListChanged()}).catch(v),S}getOperatorList({intent:e="display",annotationMode:t=Po.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var c;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,i,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Jf.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){o.read().then(function({value:l,done:c}){if(c){i(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),r()},s)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),T(this,kr,!1),C(this,Bi,wy).call(this),Promise.all(e)}cleanup(e=!1){T(this,kr,!0);const t=C(this,Bi,Kc).call(this,!1);return e&&t&&this._stats&&(this._stats=new AR),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&C(this,Bi,Kc).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},o).getReader(),c=this._intentStates.get(t);c.streamReader=l;const h=()=>{l.read().then(({value:f,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),h())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();C(this,Bi,Kc).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof db){let s=yW;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Pc(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Xo=new WeakMap,kr=new WeakMap,Bi=new WeakSet,Kc=function(e=!1){if(C(this,Bi,wy).call(this),!u(this,kr)||this.destroyed)return!1;if(e)return T(this,Xo,setTimeout(()=>{T(this,Xo,null),C(this,Bi,Kc).call(this,!1)},vW)),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,kr,!1),!0},wy=function(){u(this,Xo)&&(clearTimeout(u(this,Xo)),T(this,Xo,null))};var xr,Xv;class RW{constructor(){R(this,xr,new Map);R(this,Xv,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};u(this,Xv).then(()=>{for(const[s]of u(this,xr))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){Ee("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}u(this,xr).set(t,s)}removeEventListener(e,t){const i=u(this,xr).get(t);i==null||i(),u(this,xr).delete(t)}terminate(){for(const[,e]of u(this,xr))e==null||e();u(this,xr).clear()}}xr=new WeakMap,Xv=new WeakMap;var Qv,Pl,Nl,Ku,Ey,Xu,Ay;const tt=class tt{constructor({name:e=null,port:t=null,verbosity:i=cq()}={}){R(this,Ku);var s;if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=u(tt,Nl))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(u(tt,Nl)||T(tt,Nl,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Xd("main","worker",e),this._messageHandler.on("ready",function(){}),C(this,Ku,Ey).call(this)}_initialize(){if(u(tt,Pl)||u(tt,Xu,Ay)){this._setupFakeWorker();return}let{workerSrc:e}=tt;try{tt._isSameOrigin(window.location.href,e)||(e=tt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Xd("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",a=>{if(r.abort(),this.destroyed||!a){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,C(this,Ku,Ey).call(this)}),i.on("ready",a=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;i.send("test",a,[a.buffer])};o();return}catch{t0("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){u(tt,Pl)||(Ee("Setting up fake worker."),T(tt,Pl,!0)),tt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new RW;this._port=t;const i=`fake${Rn(tt,Qv)._++}`,s=new Xd(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new Xd(i,i+"_worker",t),C(this,Ku,Ey).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,i;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=u(tt,Nl))==null||t.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(e){var i;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(i=u(this,Nl))==null?void 0:i.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new tt(e)}static get workerSrc(){if(qr.workerSrc)return qr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Te(this,"_setupFakeWorkerGlobal",(async()=>u(this,Xu,Ay)?u(this,Xu,Ay):(await import(this.workerSrc)).WorkerMessageHandler)())}};Qv=new WeakMap,Pl=new WeakMap,Nl=new WeakMap,Ku=new WeakSet,Ey=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Xu=new WeakSet,Ay=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},R(tt,Xu),R(tt,Qv,0),R(tt,Pl,!1),R(tt,Nl),Mn&&(T(tt,Pl,!0),qr.workerSrc||(qr.workerSrc="./pdf.worker.mjs")),tt._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(t,i);return i.origin===s.origin},tt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Tu=tt;var Pr,$s,Qu,Yu,zs,Ll,Qd;class kW{constructor(e,t,i,s,r){R(this,Ll);R(this,Pr,new Map);R(this,$s,new Map);R(this,Qu,new Map);R(this,Yu,new Map);R(this,zs,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new vD,this.fontLoader=new Rq({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Te(this,"annotationStorage",new mb)}getRenderingIntent(e,t=Po.ENABLE,i=null,s=!1,r=!1){let o=yi.DISPLAY,a=wA;switch(e){case"any":o=yi.ANY;break;case"display":break;case"print":o=yi.PRINT;break;default:Ee(`getRenderingIntent - invalid intent: ${e}`)}const l=o&yi.PRINT&&i instanceof X2?i:this.annotationStorage;switch(t){case Po.DISABLE:o+=yi.ANNOTATIONS_DISABLE;break;case Po.ENABLE:break;case Po.ENABLE_FORMS:o+=yi.ANNOTATIONS_FORMS;break;case Po.ENABLE_STORAGE:o+=yi.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Ee(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=yi.IS_EDITING),r&&(o+=yi.OPLIST);const{ids:c,hash:h}=l.modifiedIds,f=[o,a.hash,h];return{renderingIntent:o,cacheKey:f.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=u(this,zs))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of u(this,$s).values())e.push(s._destroy());u(this,$s).clear(),u(this,Qu).clear(),u(this,Yu).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),u(this,Pr).clear(),this.filterFactory.destroy(),Yf.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Pc("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Ct(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){s.close();return}Ct(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async i=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(i,s)=>{Ct(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){s.close();return}Ct(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new IW(i,this))}),e.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new YE(i.message,i.code);break;case"InvalidPDFException":s=new E2(i.message);break;case"MissingPDFException":s=new Fg(i.message);break;case"UnexpectedResponseException":s=new n0(i.message,i.status);break;case"UnknownErrorException":s=new JE(i.message,i.details);break;default:He("DocException - expected a valid Error.")}t._capability.reject(s)}),e.on("PasswordRequest",i=>{if(T(this,zs,Promise.withResolvers()),t.onPassword){const s=r=>{r instanceof Error?u(this,zs).reject(r):u(this,zs).resolve({password:r})};try{t.onPassword(s,i.code)}catch(r){u(this,zs).reject(r)}}else u(this,zs).reject(new YE(i.message,i.code));return u(this,zs).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;u(this,$s).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var o;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in r){const g=r.error;Ee(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const h=c&&((o=globalThis.FontInspector)!=null&&o.enabled)?(g,y)=>globalThis.FontInspector.fontAdded(g,y):null,f=new kq(r,{disableFontFace:a,inspectFont:h});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":const{imageRef:p}=r;Ct(p,"The imageRef must be defined.");for(const g of u(this,$s).values())for(const[,y]of g.objs)if((y==null?void 0:y.ref)===p)return y.dataLen?(this.commonObjs.resolve(i,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,o])=>{var l;if(this.destroyed)return;const a=u(this,$s).get(s);if(!a.objs.has(i)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(r){case"Image":a.objs.resolve(i,o),(o==null?void 0:o.dataLen)>sq&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&Ee("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=u(this,Qu).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&u(this,Yu).set(r.refStr,e);const o=new CW(t,r,this,this._params.pdfBug);return u(this,$s).set(t,o),o});return u(this,Qu).set(t,s),s}getPageIndex(e){return OR(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return C(this,Ll,Qd).call(this,"GetFieldObjects")}hasJSActions(){return C(this,Ll,Qd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return C(this,Ll,Qd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return C(this,Ll,Qd).call(this,"GetOptionalContentConfig").then(t=>new Yq(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=u(this,Pr).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,o;return{info:s[0],metadata:s[1]?new Xq(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return u(this,Pr).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of u(this,$s).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),u(this,Pr).clear(),this.filterFactory.destroy(!0),Yf.cleanup()}}cachedPageNumber(e){if(!OR(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return u(this,Yu).get(t)??null}}Pr=new WeakMap,$s=new WeakMap,Qu=new WeakMap,Yu=new WeakMap,zs=new WeakMap,Ll=new WeakSet,Qd=function(e,t=null){const i=u(this,Pr).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return u(this,Pr).set(e,s),s};const Om=Symbol("INITIAL_DATA");var rs,Op,PA;class vD{constructor(){R(this,Op);R(this,rs,Object.create(null))}get(e,t=null){if(t){const s=C(this,Op,PA).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=u(this,rs)[e];if(!i||i.data===Om)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=u(this,rs)[e];return!!t&&t.data!==Om}resolve(e,t=null){const i=C(this,Op,PA).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in u(this,rs)){const{data:i}=u(this,rs)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}T(this,rs,Object.create(null))}*[Symbol.iterator](){for(const e in u(this,rs)){const{data:t}=u(this,rs)[e];t!==Om&&(yield[e,t])}}}rs=new WeakMap,Op=new WeakSet,PA=function(e){var t;return(t=u(this,rs))[e]||(t[e]={...Promise.withResolvers(),data:Om})};var Qo;class xW{constructor(e){R(this,Qo,null);T(this,Qo,e),this.onContinue=null}get promise(){return u(this,Qo).capability.promise}cancel(e=0){u(this,Qo).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=u(this,Qo).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=u(this,Qo);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Qo=new WeakMap;var Yo,Dl;const el=class el{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null}){R(this,Yo,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new xW(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,l;if(this.cancelled)return;if(this._canvas){if(u(el,Dl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(el,Dl).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:o}=this.params;this.gfx=new Au(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),u(this,Yo)&&(window.cancelAnimationFrame(u(this,Yo)),T(this,Yo,null)),u(el,Dl).delete(this._canvas),this.callback(e||new db(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?T(this,Yo,window.requestAnimationFrame(()=>{T(this,Yo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(el,Dl).delete(this._canvas),this.callback())))}};Yo=new WeakMap,Dl=new WeakMap,R(el,Dl,new WeakSet);let NA=el;const PW="4.9.124",NW="867aaf01f";function FR(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function xd(n){return Math.max(0,Math.min(255,255*n))}class VR{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=xd(e),[e,e,e]}static G_HTML([e]){const t=FR(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(xd)}static RGB_HTML(e){return`#${e.map(FR).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[xd(1-Math.min(1,e+s)),xd(1-Math.min(1,i+s)),xd(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,o=1-i,a=Math.min(s,r,o);return["CMYK",s,r,o,a]}}class LW{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){He("Abstract method `_createSVG` called.")}}class vb extends LW{_createSVG(e){return document.createElementNS(pr,e)}}class _D{static setupStorage(e,t,i,s,r){const o=s.getValue(t,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?e.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{s.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of i.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&r.addLinkAttributes(e,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(e,o.dataId,t,i)}static render(e){var f,p;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const a=r!=="richText",l=e.div;if(l.append(o),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=g}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);o.append(g),a&&Jf.shouldBuildText(s.name)&&c.push(g)}return{textDivs:c}}const h=[[s,-1,o]];for(;h.length>0;){const[g,y,_]=h.at(-1);if(y+1===g.children.length){h.pop();continue}const A=g.children[++h.at(-1)[1]];if(A===null)continue;const{name:v}=A;if(v==="#text"){const S=document.createTextNode(A.value);c.push(S),_.append(S);continue}const E=(f=A==null?void 0:A.attributes)!=null&&f.xmlns?document.createElementNS(A.attributes.xmlns,v):document.createElement(v);if(_.append(E),A.attributes&&this.setAttributes({html:E,element:A,storage:t,intent:r,linkService:i}),((p=A.children)==null?void 0:p.length)>0)h.push([A,-1,E]);else if(A.value){const S=document.createTextNode(A.value);a&&Jf.shouldBuildText(v)&&c.push(S),E.append(S)}}for(const g of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const jg=1e3,DW=9,_c=new WeakSet;function no(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class MW{static create(e){switch(e.data.annotationType){case kt.LINK:return new wD(e);case kt.TEXT:return new OW(e);case kt.WIDGET:switch(e.data.fieldType){case"Tx":return new FW(e);case"Btn":return e.data.radioButton?new TD(e):e.data.checkBox?new UW(e):new jW(e);case"Ch":return new BW(e);case"Sig":return new VW(e)}return new Nc(e);case kt.POPUP:return new DA(e);case kt.FREETEXT:return new RD(e);case kt.LINE:return new zW(e);case kt.SQUARE:return new HW(e);case kt.CIRCLE:return new qW(e);case kt.POLYLINE:return new kD(e);case kt.CARET:return new GW(e);case kt.INK:return new _b(e);case kt.POLYGON:return new WW(e);case kt.HIGHLIGHT:return new xD(e);case kt.UNDERLINE:return new KW(e);case kt.SQUIGGLY:return new XW(e);case kt.STRIKEOUT:return new QW(e);case kt.STAMP:return new PD(e);case kt.FILEATTACHMENT:return new YW(e);default:return new At(e)}}}var Ml,Ju,Zu,Fp,LA;const Ab=class Ab{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){R(this,Fp);R(this,Ml,null);R(this,Ju,!1);R(this,Zu,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e!=null&&e.str||t!=null&&t.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ab._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;u(this,Ml)||T(this,Ml,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&C(this,Fp,LA).call(this,t),(i=u(this,Zu))==null||i.popup.updateEdited(e)}resetEdited(){var e;u(this,Ml)&&(C(this,Fp,LA).call(this,u(this,Ml).rect),(e=u(this,Zu))==null||e.popup.resetEdited(),T(this,Ml,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Nc||(r.tabIndex=jg);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof DA){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,r),r}const{width:a,height:l}=no(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(_>0||A>0){const E=`calc(${_}px * var(--scale-factor)) / calc(${A}px * var(--scale-factor))`;o.borderRadius=E}else if(this instanceof TD){const E=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=E}switch(t.borderStyle.style){case Rd.SOLID:o.borderStyle="solid";break;case Rd.DASHED:o.borderStyle="dashed";break;case Rd.BEVELED:Ee("Unimplemented border style: beveled");break;case Rd.INSET:Ee("Unimplemented border style: inset");break;case Rd.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(T(this,Ju,!0),o.borderColor=re.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const c=re.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:g}=s.rawDims;o.left=`${100*(c[0]-p)/h}%`,o.top=`${100*(c[1]-g)/f}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/h}%`,o.height=`${100*l/f}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:o}=no(this.data.rect);let a,l;e%180===0?(a=100*r/i,l=100*o/s):(a=100*o/i,l=100*r/s),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],o=r[0],a=r.slice(1);s.target.style[i]=VR[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[i]:VR[`${o}_rgb`](a)})};return Te(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const o=i[s];if(o){const a={detail:{[s]:r},target:e};o(a),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,A,v,E]=e.subarray(2,6);if(s===_&&r===A&&t===v&&i===E)return}const{style:o}=this.container;let a;if(u(this,Ju)){const{borderColor:_,borderWidth:A}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const l=s-t,c=r-i,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=h.createElement("defs");f.append(p);const g=h.createElement("clipPath"),y=`clippath_${this.data.id}`;g.setAttribute("id",y),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let _=2,A=e.length;_<A;_+=8){const v=e[_],E=e[_+1],S=e[_+2],P=e[_+3],O=h.createElement("rect"),F=(S-t)/l,I=(r-E)/c,b=(v-S)/l,k=(E-P)/c;O.setAttribute("x",F),O.setAttribute("y",I),O.setAttribute("width",b),O.setAttribute("height",k),g.append(O),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${I}" width="${b}" height="${k}"/>`)}u(this,Ju)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(f),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=T(this,Zu,new DA({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){He("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:o,exportValues:a}of s){if(r===-1||o===t)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!_c.has(c)){Ee(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:l,domElement:c})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==t&&_c.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Ml=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,Fp=new WeakSet,LA=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}}}=this;i==null||i.splice(0,4,...e);const{width:c,height:h}=no(e);t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+l)/o}%`,s===0?(t.width=`${100*c/r}%`,t.height=`${100*h/o}%`):this.setRotation(s)};let At=Ab;var _i,Qa,ED,AD;class wD extends At{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});R(this,_i);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(C(this,_i,ED).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(C(this,_i,AD).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&C(this,_i,Qa).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),C(this,_i,Qa).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const o=s.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),C(this,_i,Qa).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),C(this,_i,Qa).call(this),!this._fieldObjects){Ee('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var f;s==null||s();const{fields:r,refs:o,include:a}=i,l=[];if(r.length!==0||o.length!==0){const p=new Set(o);for(const g of r){const y=this._fieldObjects[g]||[];for(const{id:_}of y)p.add(_)}for(const g of Object.values(this._fieldObjects))for(const y of g)p.has(y.id)===a&&l.push(y)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const c=this.annotationStorage,h=[];for(const p of l){const{id:g}=p;switch(h.push(g),p.type){case"text":{const _=p.defaultValue||"";c.setValue(g,{value:_});break}case"checkbox":case"radiobutton":{const _=p.defaultValue===p.exportValues;c.setValue(g,{value:_});break}case"combobox":case"listbox":{const _=p.defaultValue||"";c.setValue(g,{value:_});break}default:continue}const y=document.querySelector(`[data-element-id="${g}"]`);if(y){if(!_c.has(y)){Ee(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}_i=new WeakSet,Qa=function(){this.container.setAttribute("data-internal-link","")},ED=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},C(this,_i,Qa).call(this)},AD=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),C(this,_i,Qa).call(this)};class OW extends At{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Nc extends At{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Fn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(i,o=>{var a;if(i==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}}))})}_setEventListeners(e,t,i,s){var r,o,a;for(const[l,c]of i)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,s),c==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":re.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||DW,r=e.style;let o;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),h=Math.round(c/(Aw*s))||1,f=c/h;o=Math.min(s,l(f/Aw))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,l(c/Aw))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=re.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class FW extends Nc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=i),r.setValue(o.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=o.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",c??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),_c.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=jg,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(i,"value",p.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let f=p=>{const{formattedValue:g}=h;g!=null&&(p.target.value=g),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var _;if(h.focused)return;const{target:y}=g;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(_=this.data.actions)!=null&&_.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const y={value(_){h.userValue=_.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:A}=_.detail;h.formattedValue=A,A!=null&&_.target!==document.activeElement&&(_.target.value=A),e.setValue(t,{formattedValue:A})},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{var S;const{charLimit:A}=_.detail,{target:v}=_;if(A===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",A);let E=h.userValue;!E||E.length<=A||(E=E.slice(0,A),v.value=h.userValue=E,e.setValue(t,{value:E}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(y,g)}),i.addEventListener("keydown",g=>{var A;h.commitKey=1;let y=-1;if(g.key==="Escape"?y=0:g.key==="Enter"&&!this.data.multiLine?y=2:g.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:_}=g.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:y,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const p=f;f=null,i.addEventListener("blur",g=>{var _,A;if(!h.focused||!g.relatedTarget)return;(_=this.data.actions)!=null&&_.Blur||(h.focused=!1);const{value:y}=g.target;h.userValue=y,h.lastCommittedValue!==y&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),p(g)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",g=>{var O;h.lastCommittedValue=null;const{data:y,target:_}=g,{value:A,selectionStart:v,selectionEnd:E}=_;let S=v,P=E;switch(g.inputType){case"deleteWordBackward":{const F=A.substring(0,v).match(/\w*[^\w]*$/);F&&(S-=F[0].length);break}case"deleteWordForward":{const F=A.substring(v).match(/^[^\w]*\w*/);F&&(P+=F[0].length);break}case"deleteContentBackward":v===E&&(S-=1);break;case"deleteContentForward":v===E&&(P+=1);break}g.preventDefault(),(O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:y||"",willCommit:!1,selStart:S,selEnd:P}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${g}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class VW extends Nc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class UW extends Nc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return _c.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=jg,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,i)){const h=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=h),e.setValue(c.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class TD extends Nc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,i))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(_c.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=jg,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,i))e.setValue(c.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const h=o===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const p=h&&f.id===i;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class jW extends wD{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class BW extends Nc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");_c.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=jg;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,i.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let o=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),o=()=>{h.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=h=>{const f=h?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=a(!1);const c=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const f={value(p){o==null||o();const g=p.detail.value,y=new Set(Array.isArray(g)?g:[g]);for(const _ of s.options)_.selected=y.has(_.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,y=p.detail.remove;g[y].selected=!1,s.remove(y),g.length>0&&Array.prototype.findIndex.call(g,A=>A.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:a(!0),items:c(p)}),l=a(!1)},clear(p){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(p){const{index:g,displayValue:y,exportValue:_}=p.detail.insert,A=s.children[g],v=document.createElement("option");v.textContent=y,v.value=_,A?A.before(v):s.append(v),e.setValue(t,{value:a(!0),items:c(p)}),l=a(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const y of g){const{displayValue:_,exportValue:A}=y,v=document.createElement("option");v.textContent=_,v.value=A,s.append(v)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(p)}),l=a(!1)},indices(p){const g=new Set(p.detail.indices);for(const y of p.target.options)y.selected=g.has(y.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),s.addEventListener("input",h=>{var g;const f=a(!0),p=a(!1);e.setValue(t,{value:f}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class DA extends At{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:At._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new $W({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${hb}${i}`).join(",")),this.container}}var eh,Yv,Jv,th,Ol,gt,Nr,nh,Vp,Up,ih,Lr,os,Dr,jp,Mr,Bp,Fl,Vl,qe,Ty,MA,SD,bD,ID,CD,Sy,by,OA;class $W{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:c,parentRect:h,open:f}){R(this,qe);R(this,eh,C(this,qe,ID).bind(this));R(this,Yv,C(this,qe,OA).bind(this));R(this,Jv,C(this,qe,by).bind(this));R(this,th,C(this,qe,Sy).bind(this));R(this,Ol,null);R(this,gt,null);R(this,Nr,null);R(this,nh,null);R(this,Vp,null);R(this,Up,null);R(this,ih,null);R(this,Lr,!1);R(this,os,null);R(this,Dr,null);R(this,jp,null);R(this,Mr,null);R(this,Bp,null);R(this,Fl,null);R(this,Vl,!1);var p;T(this,gt,e),T(this,Bp,s),T(this,Nr,o),T(this,Mr,a),T(this,Up,l),T(this,Ol,t),T(this,jp,c),T(this,ih,h),T(this,Vp,i),T(this,nh,pb.toDateObject(r)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",u(this,th)),g.addEventListener("mouseenter",u(this,Jv)),g.addEventListener("mouseleave",u(this,Yv)),g.classList.add("popupTriggerArea");for(const g of i)(p=g.container)==null||p.addEventListener("keydown",u(this,eh));u(this,gt).hidden=!0,f&&C(this,qe,Sy).call(this)}render(){if(u(this,os))return;const e=T(this,os,document.createElement("div"));if(e.className="popup",u(this,Ol)){const r=e.style.outlineColor=re.makeHexColor(...u(this,Ol));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=re.makeHexColor(...u(this,Ol).map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=u(this,Bp),e.append(t),u(this,nh)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,nh).valueOf()})),t.append(r)}const s=u(this,qe,Ty);if(s)_D.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(u(this,Nr));e.append(r)}u(this,gt).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,o=s.length;r<o;++r){const a=s[r];i.append(document.createTextNode(a)),r<o-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;u(this,Fl)||T(this,Fl,{contentsObj:u(this,Nr),richText:u(this,Mr)}),e&&T(this,Dr,null),t&&(T(this,Mr,C(this,qe,bD).call(this,t)),T(this,Nr,null)),(i=u(this,os))==null||i.remove(),T(this,os,null)}resetEdited(){var e;u(this,Fl)&&({contentsObj:Rn(this,Nr)._,richText:Rn(this,Mr)._}=u(this,Fl),T(this,Fl,null),(e=u(this,os))==null||e.remove(),T(this,os,null),T(this,Dr,null))}forceHide(){T(this,Vl,this.isVisible),u(this,Vl)&&(u(this,gt).hidden=!0)}maybeShow(){u(this,Vl)&&(u(this,os)||C(this,qe,by).call(this),T(this,Vl,!1),u(this,gt).hidden=!1)}get isVisible(){return u(this,gt).hidden===!1}}eh=new WeakMap,Yv=new WeakMap,Jv=new WeakMap,th=new WeakMap,Ol=new WeakMap,gt=new WeakMap,Nr=new WeakMap,nh=new WeakMap,Vp=new WeakMap,Up=new WeakMap,ih=new WeakMap,Lr=new WeakMap,os=new WeakMap,Dr=new WeakMap,jp=new WeakMap,Mr=new WeakMap,Bp=new WeakMap,Fl=new WeakMap,Vl=new WeakMap,qe=new WeakSet,Ty=function(){const e=u(this,Mr),t=u(this,Nr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&u(this,Mr).html||null},MA=function(){var e,t,i;return((i=(t=(e=u(this,qe,Ty))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},SD=function(){var e,t,i;return((i=(t=(e=u(this,qe,Ty))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},bD=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:u(this,qe,SD),fontSize:u(this,qe,MA)?`calc(${u(this,qe,MA)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},ID=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&u(this,Lr))&&C(this,qe,Sy).call(this)},CD=function(){if(u(this,Dr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=u(this,Up);let o=!!u(this,ih),a=o?u(this,ih):u(this,jp);for(const y of u(this,Vp))if(!a||re.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const l=re.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),h=o?a[2]-a[0]+5:0,f=l[0]+h,p=l[1];T(this,Dr,[100*(f-s)/t,100*(p-r)/i]);const{style:g}=u(this,gt);g.left=`${u(this,Dr)[0]}%`,g.top=`${u(this,Dr)[1]}%`},Sy=function(){T(this,Lr,!u(this,Lr)),u(this,Lr)?(C(this,qe,by).call(this),u(this,gt).addEventListener("click",u(this,th)),u(this,gt).addEventListener("keydown",u(this,eh))):(C(this,qe,OA).call(this),u(this,gt).removeEventListener("click",u(this,th)),u(this,gt).removeEventListener("keydown",u(this,eh)))},by=function(){u(this,os)||this.render(),this.isVisible?u(this,Lr)&&u(this,gt).classList.add("focused"):(C(this,qe,CD).call(this),u(this,gt).hidden=!1,u(this,gt).style.zIndex=parseInt(u(this,gt).style.zIndex)+1e3)},OA=function(){u(this,gt).classList.remove("focused"),!(u(this,Lr)||!this.isVisible)&&(u(this,gt).hidden=!0,u(this,gt).style.zIndex=parseInt(u(this,gt).style.zIndex)-1e3)};class RD extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=we.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var $p;class zW extends At{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,$p,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:i,height:s}=no(t.rect),r=this.svgFactory.create(i,s,!0),o=T(this,$p,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,$p)}addHighlightArea(){this.container.classList.add("highlightArea")}}$p=new WeakMap;var zp;class HW extends At{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,zp,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:i,height:s}=no(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=T(this,zp,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",i-o),a.setAttribute("height",s-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,zp)}addHighlightArea(){this.container.classList.add("highlightArea")}}zp=new WeakMap;var Hp;class qW extends At{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,Hp,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:i,height:s}=no(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=T(this,Hp,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",i/2),a.setAttribute("cy",s/2),a.setAttribute("rx",i/2-o/2),a.setAttribute("ry",s/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,Hp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hp=new WeakMap;var qp;class kD extends At{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,qp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r}}=this;if(!i)return this.container;const{width:o,height:a}=no(t),l=this.svgFactory.create(o,a,!0);let c=[];for(let f=0,p=i.length;f<p;f+=2){const g=i[f]-t[0],y=t[3]-i[f+1];c.push(`${g},${y}`)}c=c.join(" ");const h=T(this,qp,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",c),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,qp)}addHighlightArea(){this.container.classList.add("highlightArea")}}qp=new WeakMap;class WW extends kD{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class GW extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Wp;class _b extends At{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});R(this,Wp,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?we.HIGHLIGHT:we.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,inkLists:i,borderStyle:s,popupRef:r}}=this,{width:o,height:a}=no(t),l=this.svgFactory.create(o,a,!0);for(const c of i){let h=[];for(let p=0,g=c.length;p<g;p+=2){const y=c[p]-t[0],_=t[3]-c[p+1];h.push(`${y},${_}`)}h=h.join(" ");const f=this.svgFactory.createElement(this.svgElementName);u(this,Wp).push(f),f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return u(this,Wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wp=new WeakMap;class xD extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=we.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class KW extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class XW extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class QW extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class PD extends At{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=we.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Gp,Kp,FA;class YW extends At{constructor(t){var s;super(t,{isRenderable:!0});R(this,Kp);R(this,Gp,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",C(this,Kp,FA).bind(this)),T(this,Gp,s);const{isMac:r}=Fn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&C(this,Kp,FA).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return u(this,Gp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gp=new WeakMap,Kp=new WeakSet,FA=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Xp,Ul,jl,Qp,wc,ND,VA;class JW{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a}){R(this,wc);R(this,Xp,null);R(this,Ul,null);R(this,jl,new Map);R(this,Qp,null);this.div=e,T(this,Xp,t),T(this,Ul,i),T(this,Qp,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return u(this,jl).size>0}async render(e){var o;const{annotations:t}=e,i=this.div;yc(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new vb,annotationStorage:e.annotationStorage||new mb,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===kt.POPUP;if(l){const f=s.get(a.id);if(!f)continue;r.elements=f}else{const{width:f,height:p}=no(a.rect);if(f<=0||p<=0)continue}r.data=a;const c=MW.create(r);if(!c.isRenderable)continue;if(!l&&a.popupRef){const f=s.get(a.popupRef);f?f.push(c):s.set(a.popupRef,[c])}const h=c.render();a.hidden&&(h.style.visibility="hidden"),await C(this,wc,ND).call(this,h,a.id),c._isEditable&&(u(this,jl).set(c.data.id,c),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(c))}C(this,wc,VA).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,yc(t,{rotation:e.rotation}),C(this,wc,VA).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,jl).values())}getEditableAnnotation(e){return u(this,jl).get(e)}}Xp=new WeakMap,Ul=new WeakMap,jl=new WeakMap,Qp=new WeakMap,wc=new WeakSet,ND=async function(e,t){var o,a;const i=e.firstChild||e,s=i.id=`${hb}${t}`,r=await((o=u(this,Qp))==null?void 0:o.getAriaAttributes(s));if(r)for(const[l,c]of r)i.setAttribute(l,c);this.div.append(e),(a=u(this,Xp))==null||a.moveElementInDOM(this.div,e,i,!1)},VA=function(){if(!u(this,Ul))return;const e=this.div;for(const[t,i]of u(this,Ul)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}u(this,Ul).clear()};const Fm=/\r\n?|\n/g;var as,ci,Yp,Bl,ui,Rt,LD,DD,MD,Iy,so,Cy,Ry,OD,jA,FD;const Xe=class Xe extends ct{constructor(t){super({...t,name:"freeTextEditor"});R(this,Rt);R(this,as);R(this,ci,"");R(this,Yp,`${this.id}-editor`);R(this,Bl,null);R(this,ui);T(this,as,t.color||Xe._defaultColor||ct._defaultLineColor),T(this,ui,t.fontSize||Xe._defaultFontSize)}static get _keyboardManager(){const t=Xe.prototype,i=o=>o.isEmpty(),s=vc.TRANSLATE_SMALL,r=vc.TRANSLATE_BIG;return Te(this,"_keyboardManager",new Ug([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){ct.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Re.FREETEXT_SIZE:Xe._defaultFontSize=i;break;case Re.FREETEXT_COLOR:Xe._defaultColor=i;break}}updateParams(t,i){switch(t){case Re.FREETEXT_SIZE:C(this,Rt,LD).call(this,i);break;case Re.FREETEXT_COLOR:C(this,Rt,DD).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Re.FREETEXT_SIZE,Xe._defaultFontSize],[Re.FREETEXT_COLOR,Xe._defaultColor||ct._defaultLineColor]]}get propertiesToUpdate(){return[[Re.FREETEXT_SIZE,u(this,ui)],[Re.FREETEXT_COLOR,u(this,as)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-Xe._internalPadding*t,-(Xe._internalPadding+u(this,ui))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(we.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),T(this,Bl,new AbortController);const t=this._uiManager.combinedSignal(u(this,Bl));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,Yp)),this._isDraggable=!0,(t=u(this,Bl))==null||t.abort(),T(this,Bl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var t;this.width||(this.enableEditMode(),this.editorDiv.focus(),(t=this._initialOptions)!=null&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,ci),i=T(this,ci,C(this,Rt,MD).call(this).trimEnd());if(t===i)return;const s=r=>{if(T(this,ci,r),!r){this.remove();return}C(this,Rt,Ry).call(this),this._uiManager.rebuild(this),C(this,Rt,Iy).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),C(this,Rt,Iy).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Xe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,Yp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${u(this,ui)}px * var(--scale-factor))`,s.color=u(this,as),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Lv(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[h,f]=this.pageDimensions,[p,g]=this.pageTranslation;let y,_;switch(this.rotation){case 0:y=t+(a[0]-p)/h,_=i+this.height-(a[1]-g)/f;break;case 90:y=t+(a[0]-p)/h,_=i-(a[1]-g)/f,[l,c]=[c,-l];break;case 180:y=t-this.width+(a[0]-p)/h,_=i-(a[1]-g)/f,[l,c]=[-l,-c];break;case 270:y=t+(a[0]-p-this.height*f)/h,_=i+(a[1]-g-this.width*h)/f,[l,c]=[-c,l];break}this.setAt(y*r,_*o,l,c)}else this.setAt(t*r,i*o,this.width*r,this.height*o);C(this,Rt,Ry).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,_,A;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=C(y=Xe,so,jA).call(y,i.getData("text")||"").replaceAll(Fm,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:c}=a,h=[],f=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(Fm,"")),v!==this.editorDiv){let E=h;for(const S of this.editorDiv.childNodes){if(S===v){E=f;continue}E.push(C(_=Xe,so,Cy).call(_,S))}}h.push(l.nodeValue.slice(0,c).replaceAll(Fm,""))}else if(l===this.editorDiv){let v=h,E=0;for(const S of this.editorDiv.childNodes)E++===c&&(v=f),v.push(C(A=Xe,so,Cy).call(A,S))}T(this,ci,`${h.join(`
`)}${r}${f.join(`
`)}`),C(this,Rt,Ry).call(this);const p=new Range;let g=h.reduce((v,E)=>v+E.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const E=v.nodeValue.length;if(g<=E){p.setStart(v,g),p.setEnd(v,g);break}g-=E}o.removeAllRanges(),o.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var a;let r=null;if(t instanceof RD){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:p,popupRef:g},textContent:y,textPosition:_,parent:{page:{pageNumber:A}}}=t;if(!y||y.length===0)return null;r=t={annotationType:we.FREETEXT,color:Array.from(c),fontSize:l,value:y.join(`
`),position:_,pageIndex:A-1,rect:h.slice(0),rotation:f,id:p,deleted:!1,popupRef:g}}const o=await super.deserialize(t,i,s);return T(o,ui,t.fontSize),T(o,as,re.makeHexColor(...t.color)),T(o,ci,C(a=Xe,so,jA).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Xe._internalPadding*this.parentScale,s=this.getRect(i,i),r=ct._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,as)),o={annotationType:we.FREETEXT,color:r,fontSize:u(this,ui),value:C(this,Rt,OD).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!C(this,Rt,FD).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${u(this,ui)}px * var(--scale-factor))`,s.color=u(this,as),i.replaceChildren();for(const o of u(this,ci).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),i.append(a)}const r=Xe._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:u(this,ci)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};as=new WeakMap,ci=new WeakMap,Yp=new WeakMap,Bl=new WeakMap,ui=new WeakMap,Rt=new WeakSet,LD=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-u(this,ui))*this.parentScale),T(this,ui,r),C(this,Rt,Iy).call(this)},s=u(this,ui);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},DD=function(t){const i=r=>{T(this,as,this.editorDiv.style.color=r)},s=u(this,as);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},MD=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(C(s=Xe,so,Cy).call(s,r)),i=r);return t.join(`
`)},Iy=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},so=new WeakSet,Cy=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Fm,"")},Ry=function(){if(this.editorDiv.replaceChildren(),!!u(this,ci))for(const t of u(this,ci).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},OD=function(){return u(this,ci).replaceAll(" "," ")},jA=function(t){return t.replaceAll(" "," ")},FD=function(t){const{value:i,fontSize:s,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==o},R(Xe,so),ce(Xe,"_freeTextDefaultContent",""),ce(Xe,"_internalPadding",0),ce(Xe,"_defaultColor",null),ce(Xe,"_defaultFontSize",10),ce(Xe,"_type","freetext"),ce(Xe,"_editorType",we.FREETEXT);let UA=Xe;class te{toSVGPath(){He("Abstract method `toSVGPath` must be implemented.")}get box(){He("Abstract getter `box` must be implemented.")}serialize(e,t){He("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*s,o[a+1]=i+e[a+1]*r;return o}static _rescaleAndSwap(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*s,o[a+1]=i+e[a]*r;return o}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}}ce(te,"PRECISION",1e-4);var hi,ls,sh,rh,Hs,Ae,$l,zl,Jp,Zp,oh,ah,Jo,eg,Zv,e_,Mt,Yd,VD,UD,jD,BD,$D,zD;const _r=class _r{constructor({x:e,y:t},i,s,r,o,a=0){R(this,Mt);R(this,hi);R(this,ls,[]);R(this,sh);R(this,rh);R(this,Hs,[]);R(this,Ae,new Float32Array(18));R(this,$l);R(this,zl);R(this,Jp);R(this,Zp);R(this,oh);R(this,ah);R(this,Jo,[]);T(this,hi,i),T(this,ah,r*s),T(this,rh,o),u(this,Ae).set([NaN,NaN,NaN,NaN,e,t],6),T(this,sh,a),T(this,Zp,u(_r,eg)*s),T(this,Jp,u(_r,e_)*s),T(this,oh,s),u(this,Jo).push(e,t)}isEmpty(){return isNaN(u(this,Ae)[8])}add({x:e,y:t}){var k;T(this,$l,e),T(this,zl,t);const[i,s,r,o]=u(this,hi);let[a,l,c,h]=u(this,Ae).subarray(8,12);const f=e-c,p=t-h,g=Math.hypot(f,p);if(g<u(this,Jp))return!1;const y=g-u(this,Zp),_=y/g,A=_*f,v=_*p;let E=a,S=l;a=c,l=h,c+=A,h+=v,(k=u(this,Jo))==null||k.push(e,t);const P=-v/y,O=A/y,F=P*u(this,ah),I=O*u(this,ah);return u(this,Ae).set(u(this,Ae).subarray(2,8),0),u(this,Ae).set([c+F,h+I],4),u(this,Ae).set(u(this,Ae).subarray(14,18),12),u(this,Ae).set([c-F,h-I],16),isNaN(u(this,Ae)[6])?(u(this,Hs).length===0&&(u(this,Ae).set([a+F,l+I],2),u(this,Hs).push(NaN,NaN,NaN,NaN,(a+F-i)/r,(l+I-s)/o),u(this,Ae).set([a-F,l-I],14),u(this,ls).push(NaN,NaN,NaN,NaN,(a-F-i)/r,(l-I-s)/o)),u(this,Ae).set([E,S,a,l,c,h],6),!this.isEmpty()):(u(this,Ae).set([E,S,a,l,c,h],6),Math.abs(Math.atan2(S-l,E-a)-Math.atan2(v,A))<Math.PI/2?([a,l,c,h]=u(this,Ae).subarray(2,6),u(this,Hs).push(NaN,NaN,NaN,NaN,((a+c)/2-i)/r,((l+h)/2-s)/o),[a,l,E,S]=u(this,Ae).subarray(14,18),u(this,ls).push(NaN,NaN,NaN,NaN,((E+a)/2-i)/r,((S+l)/2-s)/o),!0):([E,S,a,l,c,h]=u(this,Ae).subarray(0,6),u(this,Hs).push(((E+5*a)/6-i)/r,((S+5*l)/6-s)/o,((5*a+c)/6-i)/r,((5*l+h)/6-s)/o,((a+c)/2-i)/r,((l+h)/2-s)/o),[c,h,a,l,E,S]=u(this,Ae).subarray(12,18),u(this,ls).push(((E+5*a)/6-i)/r,((S+5*l)/6-s)/o,((5*a+c)/6-i)/r,((5*l+h)/6-s)/o,((a+c)/2-i)/r,((l+h)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=u(this,Hs),t=u(this,ls);if(isNaN(u(this,Ae)[6])&&!this.isEmpty())return C(this,Mt,VD).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);C(this,Mt,jD).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return C(this,Mt,UD).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,o){return new HD(e,t,i,s,r,o)}getOutlines(){var f;const e=u(this,Hs),t=u(this,ls),i=u(this,Ae),[s,r,o,a]=u(this,hi),l=new Float32Array((((f=u(this,Jo))==null?void 0:f.length)??0)+2);for(let p=0,g=l.length-2;p<g;p+=2)l[p]=(u(this,Jo)[p]-s)/o,l[p+1]=(u(this,Jo)[p+1]-r)/a;if(l[l.length-2]=(u(this,$l)-s)/o,l[l.length-1]=(u(this,zl)-r)/a,isNaN(i[6])&&!this.isEmpty())return C(this,Mt,BD).call(this,l);const c=new Float32Array(u(this,Hs).length+24+u(this,ls).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){c[p]=c[p+1]=NaN;continue}c[p]=e[p],c[p+1]=e[p+1]}h=C(this,Mt,zD).call(this,c,h);for(let p=t.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(t[p+g])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=t[p+g],c[h+1]=t[p+g+1],h+=2}return C(this,Mt,$D).call(this,c,h),this.newFreeDrawOutline(c,l,u(this,hi),u(this,oh),u(this,sh),u(this,rh))}};hi=new WeakMap,ls=new WeakMap,sh=new WeakMap,rh=new WeakMap,Hs=new WeakMap,Ae=new WeakMap,$l=new WeakMap,zl=new WeakMap,Jp=new WeakMap,Zp=new WeakMap,oh=new WeakMap,ah=new WeakMap,Jo=new WeakMap,eg=new WeakMap,Zv=new WeakMap,e_=new WeakMap,Mt=new WeakSet,Yd=function(){const e=u(this,Ae).subarray(4,6),t=u(this,Ae).subarray(16,18),[i,s,r,o]=u(this,hi);return[(u(this,$l)+(e[0]-t[0])/2-i)/r,(u(this,zl)+(e[1]-t[1])/2-s)/o,(u(this,$l)+(t[0]-e[0])/2-i)/r,(u(this,zl)+(t[1]-e[1])/2-s)/o]},VD=function(){const[e,t,i,s]=u(this,hi),[r,o,a,l]=C(this,Mt,Yd).call(this);return`M${(u(this,Ae)[2]-e)/i} ${(u(this,Ae)[3]-t)/s} L${(u(this,Ae)[4]-e)/i} ${(u(this,Ae)[5]-t)/s} L${r} ${o} L${a} ${l} L${(u(this,Ae)[16]-e)/i} ${(u(this,Ae)[17]-t)/s} L${(u(this,Ae)[14]-e)/i} ${(u(this,Ae)[15]-t)/s} Z`},UD=function(e){const t=u(this,ls);e.push(`L${t[4]} ${t[5]} Z`)},jD=function(e){const[t,i,s,r]=u(this,hi),o=u(this,Ae).subarray(4,6),a=u(this,Ae).subarray(16,18),[l,c,h,f]=C(this,Mt,Yd).call(this);e.push(`L${(o[0]-t)/s} ${(o[1]-i)/r} L${l} ${c} L${h} ${f} L${(a[0]-t)/s} ${(a[1]-i)/r}`)},BD=function(e){const t=u(this,Ae),[i,s,r,o]=u(this,hi),[a,l,c,h]=C(this,Mt,Yd).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/o],0),this.newFreeDrawOutline(f,e,u(this,hi),u(this,oh),u(this,sh),u(this,rh))},$D=function(e,t){const i=u(this,ls);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},zD=function(e,t){const i=u(this,Ae).subarray(4,6),s=u(this,Ae).subarray(16,18),[r,o,a,l]=u(this,hi),[c,h,f,p]=C(this,Mt,Yd).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/l],t),t+=24},R(_r,eg,8),R(_r,Zv,2),R(_r,e_,u(_r,eg)+u(_r,Zv));let Mv=_r;var lh,Hl,Or,tg,di,ng,_t,t_,qD;class HD extends te{constructor(t,i,s,r,o,a){super();R(this,t_);R(this,lh);R(this,Hl,new Float32Array(4));R(this,Or);R(this,tg);R(this,di);R(this,ng);R(this,_t);T(this,_t,t),T(this,di,i),T(this,lh,s),T(this,ng,r),T(this,Or,o),T(this,tg,a),this.lastPoint=[NaN,NaN],C(this,t_,qD).call(this,a);const[l,c,h,f]=u(this,Hl);for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-l)/h,t[p+1]=(t[p+1]-c)/f;for(let p=0,g=i.length;p<g;p+=2)i[p]=(i[p]-l)/h,i[p+1]=(i[p+1]-c)/f}toSVGPath(){const t=[`M${u(this,_t)[4]} ${u(this,_t)[5]}`];for(let i=6,s=u(this,_t).length;i<s;i+=6){if(isNaN(u(this,_t)[i])){t.push(`L${u(this,_t)[i+4]} ${u(this,_t)[i+5]}`);continue}t.push(`C${u(this,_t)[i]} ${u(this,_t)[i+1]} ${u(this,_t)[i+2]} ${u(this,_t)[i+3]} ${u(this,_t)[i+4]} ${u(this,_t)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],o){const a=s-t,l=r-i;let c,h;switch(o){case 0:c=te._rescale(u(this,_t),t,r,a,-l),h=te._rescale(u(this,di),t,r,a,-l);break;case 90:c=te._rescaleAndSwap(u(this,_t),t,i,a,l),h=te._rescaleAndSwap(u(this,di),t,i,a,l);break;case 180:c=te._rescale(u(this,_t),s,i,-a,l),h=te._rescale(u(this,di),s,i,-a,l);break;case 270:c=te._rescaleAndSwap(u(this,_t),s,r,-a,-l),h=te._rescaleAndSwap(u(this,di),s,r,-a,-l);break}return{outline:Array.from(c),points:[Array.from(h)]}}get box(){return u(this,Hl)}newOutliner(t,i,s,r,o,a=0){return new Mv(t,i,s,r,o,a)}getNewOutline(t,i){const[s,r,o,a]=u(this,Hl),[l,c,h,f]=u(this,lh),p=o*h,g=a*f,y=s*h+l,_=r*f+c,A=this.newOutliner({x:u(this,di)[0]*p+y,y:u(this,di)[1]*g+_},u(this,lh),u(this,ng),t,u(this,tg),i??u(this,Or));for(let v=2;v<u(this,di).length;v+=2)A.add({x:u(this,di)[v]*p+y,y:u(this,di)[v+1]*g+_});return A.getOutlines()}}lh=new WeakMap,Hl=new WeakMap,Or=new WeakMap,tg=new WeakMap,di=new WeakMap,ng=new WeakMap,_t=new WeakMap,t_=new WeakSet,qD=function(t){const i=u(this,_t);let s=i[4],r=i[5],o=s,a=r,l=s,c=r,h=s,f=r;const p=t?Math.max:Math.min;for(let y=6,_=i.length;y<_;y+=6){if(isNaN(i[y]))o=Math.min(o,i[y+4]),a=Math.min(a,i[y+5]),l=Math.max(l,i[y+4]),c=Math.max(c,i[y+5]),f<i[y+5]?(h=i[y+4],f=i[y+5]):f===i[y+5]&&(h=p(h,i[y+4]));else{const A=re.bezierBoundingBox(s,r,...i.slice(y,y+6));o=Math.min(o,A[0]),a=Math.min(a,A[1]),l=Math.max(l,A[2]),c=Math.max(c,A[3]),f<A[3]?(h=A[2],f=A[3]):f===A[3]&&(h=p(h,A[2]))}s=i[y+4],r=i[y+5]}const g=u(this,Hl);g[0]=o-u(this,Or),g[1]=a-u(this,Or),g[2]=l-o+2*u(this,Or),g[3]=c-a+2*u(this,Or),this.lastPoint=[h,f]};var ig,sg,Zo,cs,Un,WD,ky,GD,KD,$A;class BA{constructor(e,t=0,i=0,s=!0){R(this,Un);R(this,ig);R(this,sg);R(this,Zo,[]);R(this,cs,[]);let r=1/0,o=-1/0,a=1/0,l=-1/0;const h=10**-4;for(const{x:v,y:E,width:S,height:P}of e){const O=Math.floor((v-t)/h)*h,F=Math.ceil((v+S+t)/h)*h,I=Math.floor((E-t)/h)*h,b=Math.ceil((E+P+t)/h)*h,k=[O,I,b,!0],L=[F,I,b,!1];u(this,Zo).push(k,L),r=Math.min(r,O),o=Math.max(o,F),a=Math.min(a,I),l=Math.max(l,b)}const f=o-r+2*i,p=l-a+2*i,g=r-i,y=a-i,_=u(this,Zo).at(s?-1:-2),A=[_[0],_[2]];for(const v of u(this,Zo)){const[E,S,P]=v;v[0]=(E-g)/f,v[1]=(S-y)/p,v[2]=(P-y)/p}T(this,ig,new Float32Array([g,y,f,p])),T(this,sg,A)}getOutlines(){u(this,Zo).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of u(this,Zo))t[3]?(e.push(...C(this,Un,$A).call(this,t)),C(this,Un,GD).call(this,t)):(C(this,Un,KD).call(this,t),e.push(...C(this,Un,$A).call(this,t)));return C(this,Un,WD).call(this,e)}}ig=new WeakMap,sg=new WeakMap,Zo=new WeakMap,cs=new WeakMap,Un=new WeakSet,WD=function(e){const t=[],i=new Set;for(const o of e){const[a,l,c]=o;t.push([a,l,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],c=t[o+1][2];l.push(c),c.push(l),i.add(l),i.add(c)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[a,l,c,h,f]=o;i.delete(o);let p=a,g=l;for(r=[a,c],s.push(r);;){let y;if(i.has(h))y=h;else if(i.has(f))y=f;else break;i.delete(y),[a,l,c,h,f]=y,p!==a&&(r.push(p,g,a,g===l?l:c),p=a),g=g===l?c:l}r.push(p,g)}return new ZW(s,u(this,ig),u(this,sg))},ky=function(e){const t=u(this,cs);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,o=t[r][0];if(o===e)return r;o<e?i=r+1:s=r-1}return s+1},GD=function([,e,t]){const i=C(this,Un,ky).call(this,e);u(this,cs).splice(i,0,[e,t])},KD=function([,e,t]){const i=C(this,Un,ky).call(this,e);for(let s=i;s<u(this,cs).length;s++){const[r,o]=u(this,cs)[s];if(r!==e)break;if(r===e&&o===t){u(this,cs).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=u(this,cs)[s];if(r!==e)break;if(r===e&&o===t){u(this,cs).splice(s,1);return}}},$A=function(e){const[t,i,s]=e,r=[[t,i,s]],o=C(this,Un,ky).call(this,s);for(let a=0;a<o;a++){const[l,c]=u(this,cs)[a];for(let h=0,f=r.length;h<f;h++){const[,p,g]=r[h];if(!(c<=p||g<=l)){if(p>=l){if(g>c)r[h][1]=c;else{if(f===1)return[];r.splice(h,1),h--,f--}continue}r[h][2]=l,g>c&&r.push([t,c,g])}}}return r};var rg,ch;class ZW extends te{constructor(t,i,s){super();R(this,rg);R(this,ch);T(this,ch,t),T(this,rg,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of u(this,ch)){let[s,r]=i;t.push(`M${s} ${r}`);for(let o=2;o<i.length;o+=2){const a=i[o],l=i[o+1];a===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),s=a)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],o){const a=[],l=s-t,c=r-i;for(const h of u(this,ch)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=t+h[p]*l,f[p+1]=r-h[p+1]*c;a.push(f)}return a}get box(){return u(this,rg)}get classNamesForOutlining(){return["highlightOutline"]}}rg=new WeakMap,ch=new WeakMap;class zA extends Mv{newFreeDrawOutline(e,t,i,s,r,o){return new e8(e,t,i,s,r,o)}}class e8 extends HD{newOutliner(e,t,i,s,r,o=0){return new zA(e,t,i,s,r,o)}}var us,ql,uh,Nt,og,hh,ag,lg,ea,hs,dh,cg,ze,HA,qA,WA,Ya,XD,Ao;const zn=class zn{constructor({editor:e=null,uiManager:t=null}){R(this,ze);R(this,us,null);R(this,ql,null);R(this,uh);R(this,Nt,null);R(this,og,!1);R(this,hh,!1);R(this,ag,null);R(this,lg);R(this,ea,null);R(this,hs,null);R(this,dh);var i;e?(T(this,hh,!1),T(this,dh,Re.HIGHLIGHT_COLOR),T(this,ag,e)):(T(this,hh,!0),T(this,dh,Re.HIGHLIGHT_DEFAULT_COLOR)),T(this,hs,(e==null?void 0:e._uiManager)||t),T(this,lg,u(this,hs)._eventBus),T(this,uh,(e==null?void 0:e.color)||((i=u(this,hs))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),u(zn,cg)||T(zn,cg,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Te(this,"_keyboardManager",new Ug([[["Escape","mac+Escape"],zn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],zn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],zn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],zn.prototype._moveToPrevious],[["Home","mac+Home"],zn.prototype._moveToBeginning],[["End","mac+End"],zn.prototype._moveToEnd]]))}renderButton(){const e=T(this,us,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=u(this,hs)._signal;e.addEventListener("click",C(this,ze,Ya).bind(this),{signal:t}),e.addEventListener("keydown",C(this,ze,WA).bind(this),{signal:t});const i=T(this,ql,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=u(this,uh),e.append(i),e}renderMainDropdown(){const e=T(this,Nt,C(this,ze,HA).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===u(this,us)){C(this,ze,Ya).call(this,e);return}const t=e.target.getAttribute("data-color");t&&C(this,ze,qA).call(this,t,e)}_moveToNext(e){var t,i;if(!u(this,ze,Ao)){C(this,ze,Ya).call(this,e);return}if(e.target===u(this,us)){(t=u(this,Nt).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=u(this,Nt))==null?void 0:t.firstChild)||e.target===u(this,us)){u(this,ze,Ao)&&this._hideDropdownFromKeyboard();return}u(this,ze,Ao)||C(this,ze,Ya).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!u(this,ze,Ao)){C(this,ze,Ya).call(this,e);return}(t=u(this,Nt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!u(this,ze,Ao)){C(this,ze,Ya).call(this,e);return}(t=u(this,Nt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=u(this,Nt))==null||e.classList.add("hidden"),(t=u(this,ea))==null||t.abort(),T(this,ea,null)}_hideDropdownFromKeyboard(){var e;if(!u(this,hh)){if(!u(this,ze,Ao)){(e=u(this,ag))==null||e.unselect();return}this.hideDropdown(),u(this,us).focus({preventScroll:!0,focusVisible:u(this,og)})}}updateColor(e){if(u(this,ql)&&(u(this,ql).style.backgroundColor=e),!u(this,Nt))return;const t=u(this,hs).highlightColors.values();for(const i of u(this,Nt).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=u(this,us))==null||e.remove(),T(this,us,null),T(this,ql,null),(t=u(this,Nt))==null||t.remove(),T(this,Nt,null)}};us=new WeakMap,ql=new WeakMap,uh=new WeakMap,Nt=new WeakMap,og=new WeakMap,hh=new WeakMap,ag=new WeakMap,lg=new WeakMap,ea=new WeakMap,hs=new WeakMap,dh=new WeakMap,cg=new WeakMap,ze=new WeakSet,HA=function(){const e=document.createElement("div"),t=u(this,hs)._signal;e.addEventListener("contextmenu",Is,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of u(this,hs).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",u(zn,cg)[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.setAttribute("aria-selected",s===u(this,uh)),r.addEventListener("click",C(this,ze,qA).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",C(this,ze,WA).bind(this),{signal:t}),e},qA=function(e,t){t.stopPropagation(),u(this,lg).dispatch("switchannotationeditorparams",{source:this,type:u(this,dh),value:e})},WA=function(e){zn._keyboardManager.exec(this,e)},Ya=function(e){if(u(this,ze,Ao)){this.hideDropdown();return}if(T(this,og,e.detail===0),u(this,ea)||(T(this,ea,new AbortController),window.addEventListener("pointerdown",C(this,ze,XD).bind(this),{signal:u(this,hs).combinedSignal(u(this,ea))})),u(this,Nt)){u(this,Nt).classList.remove("hidden");return}const t=T(this,Nt,C(this,ze,HA).call(this));u(this,us).append(t)},XD=function(e){var t;(t=u(this,Nt))!=null&&t.contains(e.target)||this.hideDropdown()},Ao=function(){return u(this,Nt)&&!u(this,Nt).classList.contains("hidden")},R(zn,cg,null);let Ov=zn;var fh,ug,Fr,Wl,ph,Wn,hg,dg,Gl,Mi,fi,Xt,gh,Vr,yn,mh,Oi,fg,ve,GA,xy,QD,YD,JD,KA,Ja,$i,Xc,ZD,Py,Jd,eM,tM,nM,iM,sM;const Oe=class Oe extends ct{constructor(t){super({...t,name:"highlightEditor"});R(this,ve);R(this,fh,null);R(this,ug,0);R(this,Fr);R(this,Wl,null);R(this,ph,null);R(this,Wn,null);R(this,hg,null);R(this,dg,0);R(this,Gl,null);R(this,Mi,null);R(this,fi,null);R(this,Xt,!1);R(this,gh,null);R(this,Vr);R(this,yn,null);R(this,mh,"");R(this,Oi);R(this,fg,"");this.color=t.color||Oe._defaultColor,T(this,Oi,t.thickness||Oe._defaultThickness),T(this,Vr,t.opacity||Oe._defaultOpacity),T(this,Fr,t.boxes||null),T(this,fg,t.methodOfCreation||""),T(this,mh,t.text||""),this._isDraggable=!1,t.highlightId>-1?(T(this,Xt,!0),C(this,ve,xy).call(this,t),C(this,ve,Ja).call(this)):u(this,Fr)&&(T(this,fh,t.anchorNode),T(this,ug,t.anchorOffset),T(this,hg,t.focusNode),T(this,dg,t.focusOffset),C(this,ve,GA).call(this),C(this,ve,Ja).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=Oe.prototype;return Te(this,"_keyboardManager",new Ug([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,Xt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:u(this,Oi),methodOfCreation:u(this,fg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;ct.initialize(t,i),Oe._defaultColor||(Oe._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Re.HIGHLIGHT_DEFAULT_COLOR:Oe._defaultColor=i;break;case Re.HIGHLIGHT_THICKNESS:Oe._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return u(this,gh)}updateParams(t,i){switch(t){case Re.HIGHLIGHT_COLOR:C(this,ve,QD).call(this,i);break;case Re.HIGHLIGHT_THICKNESS:C(this,ve,YD).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Re.HIGHLIGHT_DEFAULT_COLOR,Oe._defaultColor],[Re.HIGHLIGHT_THICKNESS,Oe._defaultThickness]]}get propertiesToUpdate(){return[[Re.HIGHLIGHT_COLOR,this.color||Oe._defaultColor],[Re.HIGHLIGHT_THICKNESS,u(this,Oi)||Oe._defaultThickness],[Re.HIGHLIGHT_FREE,u(this,Xt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(T(this,ph,new Ov({editor:this})),t.addColorPicker(u(this,ph))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,ve,Jd).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,C(this,ve,Jd).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){C(this,ve,KA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,ve,Ja).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?C(this,ve,KA).call(this):t&&(C(this,ve,Ja).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,o,a;const{drawLayer:i}=this.parent;let s;u(this,Xt)?(t=(t-this.rotation+360)%360,s=C(r=Oe,$i,Xc).call(r,u(this,Mi).box,t)):s=C(o=Oe,$i,Xc).call(o,[this.x,this.y,this.width,this.height],t),i.updateProperties(u(this,fi),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(u(this,yn),{bbox:C(a=Oe,$i,Xc).call(a,u(this,Wn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();u(this,mh)&&(t.setAttribute("aria-label",u(this,mh)),t.setAttribute("role","mark")),u(this,Xt)?t.classList.add("free"):this.div.addEventListener("keydown",C(this,ve,ZD).bind(this),{signal:this._uiManager._signal});const i=T(this,Gl,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=u(this,Wl);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),Lv(this,u(this,Gl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,yn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,yn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:C(this,ve,Py).call(this,!0);break;case 1:case 3:C(this,ve,Py).call(this,!1);break}}select(){var t;super.select(),u(this,yn)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,yn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),u(this,yn)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,yn),{rootClass:{selected:!1}}),u(this,Xt)||C(this,ve,Py).call(this,!1))}get _mustFixPosition(){return!u(this,Xt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(u(this,fi),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(u(this,yn),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:o}){const{x:a,y:l,width:c,height:h}=s.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),g=y=>{f.abort(),C(this,$i,iM).call(this,t,y)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",ms,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Is,{signal:p}),s.addEventListener("pointermove",C(this,$i,nM).bind(this,t),{signal:p}),this._freeHighlight=new zA({x:r,y:o},[a,l,c,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var _,A,v,E;let r=null;if(t instanceof xD){const{data:{quadPoints:S,rect:P,rotation:O,id:F,color:I,opacity:b,popupRef:k},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:we.HIGHLIGHT,color:Array.from(I),opacity:b,quadPoints:S,boxes:null,pageIndex:L-1,rect:P.slice(0),rotation:O,id:F,deleted:!1,popupRef:k}}else if(t instanceof _b){const{data:{inkLists:S,rect:P,rotation:O,id:F,color:I,borderStyle:{rawWidth:b},popupRef:k},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:we.HIGHLIGHT,color:Array.from(I),thickness:b,inkLists:S,boxes:null,pageIndex:L-1,rect:P.slice(0),rotation:O,id:F,deleted:!1,popupRef:k}}const{color:o,quadPoints:a,inkLists:l,opacity:c}=t,h=await super.deserialize(t,i,s);h.color=re.makeHexColor(...o),T(h,Vr,c||1),l&&T(h,Oi,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[f,p]=h.pageDimensions,[g,y]=h.pageTranslation;if(a){const S=T(h,Fr,[]);for(let P=0;P<a.length;P+=8)S.push({x:(a[P]-g)/f,y:1-(a[P+1]-y)/p,width:(a[P+2]-a[P])/f,height:(a[P+1]-a[P+5])/p});C(_=h,ve,GA).call(_),C(A=h,ve,Ja).call(A),h.rotate(h.rotation)}else if(l){T(h,Xt,!0);const S=l[0],P={x:S[0]-g,y:p-(S[1]-y)},O=new zA(P,[0,0,f,p],1,u(h,Oi)/2,!0,.001);for(let b=0,k=S.length;b<k;b+=2)P.x=S[b]-g,P.y=p-(S[b+1]-y),O.add(P);const{id:F,clipPathId:I}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:O.toSVGPath()}},!0,!0);C(v=h,ve,xy).call(v,{highlightOutlines:O.getOutlines(),highlightId:F,clipPathId:I}),C(E=h,ve,Ja).call(E)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=ct._colorManager.convert(this.color),r={annotationType:we.HIGHLIGHT,color:s,opacity:u(this,Vr),thickness:u(this,Oi),quadPoints:C(this,ve,eM).call(this),outlines:C(this,ve,tM).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:C(this,ve,Jd).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!C(this,ve,sM).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};fh=new WeakMap,ug=new WeakMap,Fr=new WeakMap,Wl=new WeakMap,ph=new WeakMap,Wn=new WeakMap,hg=new WeakMap,dg=new WeakMap,Gl=new WeakMap,Mi=new WeakMap,fi=new WeakMap,Xt=new WeakMap,gh=new WeakMap,Vr=new WeakMap,yn=new WeakMap,mh=new WeakMap,Oi=new WeakMap,fg=new WeakMap,ve=new WeakSet,GA=function(){const t=new BA(u(this,Fr),.001);T(this,Mi,t.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,Mi).box;const i=new BA(u(this,Fr),.0025,.001,this._uiManager.direction==="ltr");T(this,Wn,i.getOutlines());const{lastPoint:s}=u(this,Wn);T(this,gh,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},xy=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var f,p;if(T(this,Mi,t),T(this,Wn,t.getNewOutline(u(this,Oi)/2+1.5,.0025)),i>=0)T(this,fi,i),T(this,Wl,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),T(this,yn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,Wn).box,path:{d:u(this,Wn).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,fi),{bbox:C(f=Oe,$i,Xc).call(f,u(this,Mi).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,yn),{bbox:C(p=Oe,$i,Xc).call(p,u(this,Wn).box,g),path:{d:u(this,Wn).toSVGPath()}})}const[o,a,l,c]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=c;break;case 90:{const[g,y]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*y/g,this.height=c*g/y;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=c;break;case 270:{const[g,y]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*y/g,this.height=c*g/y;break}}const{lastPoint:h}=u(this,Wn);T(this,gh,[(h[0]-o)/l,(h[1]-a)/c])},QD=function(t){const i=(o,a)=>{var l,c;this.color=o,T(this,Vr,a),(l=this.parent)==null||l.drawLayer.updateProperties(u(this,fi),{root:{fill:o,"fill-opacity":a}}),(c=u(this,ph))==null||c.updateColor(o)},s=this.color,r=u(this,Vr);this.addCommands({cmd:i.bind(this,t,Oe._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},YD=function(t){const i=u(this,Oi),s=r=>{T(this,Oi,r),C(this,ve,JD).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},JD=function(t){if(!u(this,Xt))return;C(this,ve,xy).call(this,{highlightOutlines:u(this,Mi).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},KA=function(){u(this,fi)===null||!this.parent||(this.parent.drawLayer.remove(u(this,fi)),T(this,fi,null),this.parent.drawLayer.remove(u(this,yn)),T(this,yn,null))},Ja=function(t=this.parent){u(this,fi)===null&&({id:Rn(this,fi)._,clipPathId:Rn(this,Wl)._}=t.drawLayer.draw({bbox:u(this,Mi).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":u(this,Vr)},rootClass:{highlight:!0,free:u(this,Xt)},path:{d:u(this,Mi).toSVGPath()}},!1,!0),T(this,yn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,Xt)},bbox:u(this,Wn).box,path:{d:u(this,Wn).toSVGPath()}},u(this,Xt))),u(this,Gl)&&(u(this,Gl).style.clipPath=u(this,Wl)))},$i=new WeakSet,Xc=function([t,i,s,r],o){switch(o){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},ZD=function(t){Oe._keyboardManager.exec(this,t)},Py=function(t){if(!u(this,fh))return;const i=window.getSelection();t?i.setPosition(u(this,fh),u(this,ug)):i.setPosition(u(this,hg),u(this,dg))},Jd=function(){return u(this,Xt)?this.rotation:0},eM=function(){if(u(this,Xt))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,o=u(this,Fr),a=new Float32Array(o.length*8);let l=0;for(const{x:c,y:h,width:f,height:p}of o){const g=c*t+s,y=(1-h)*i+r;a[l]=a[l+4]=g,a[l+1]=a[l+3]=y,a[l+2]=a[l+6]=g+f*t,a[l+5]=a[l+7]=y-p*i,l+=8}return a},tM=function(t){return u(this,Mi).serialize(t,C(this,ve,Jd).call(this))},nM=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},iM=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},sM=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},R(Oe,$i),ce(Oe,"_defaultColor",null),ce(Oe,"_defaultOpacity",1),ce(Oe,"_defaultThickness",12),ce(Oe,"_type","highlight"),ce(Oe,"_editorType",we.HIGHLIGHT),ce(Oe,"_freeHighlightId",-1),ce(Oe,"_freeHighlight",null),ce(Oe,"_freeHighlightClipId","");let Fv=Oe;var Kl;class t8{constructor(){R(this,Kl,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){u(this,Kl)[e]=t}toSVGProperties(){const e=u(this,Kl);return T(this,Kl,Object.create(null)),{root:e}}reset(){T(this,Kl,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){He("Not implemented")}}Kl=new WeakMap;var pi,yh,Le,QA,YA,JA,Zd,rM,Ny,ef,Qc;const Pi=class Pi extends ct{constructor(t){super(t);R(this,Le);R(this,pi,null);R(this,yh);ce(this,"_drawId",null);T(this,yh,t.mustBeCommitted||!1),t.drawOutlines&&(C(this,Le,QA).call(this,t),C(this,Le,Zd).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(i))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){He("Not implemented")}static get typesMap(){He("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(this._currentDraw.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,o=r[i],a=l=>{var h;r.updateProperty(i,l);const c=u(this,pi).updateProperty(i,l);c&&C(this,Le,ef).call(this,c),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Pi._mergeSVGProperties(u(this,pi).getPathResizingSVGProperties(C(this,Le,Ny).call(this)),{bbox:C(this,Le,Qc).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Pi._mergeSVGProperties(u(this,pi).getPathResizedSVGProperties(C(this,Le,Ny).call(this)),{bbox:C(this,Le,Qc).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:C(this,Le,Qc).call(this,t,i)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Pi._mergeSVGProperties(u(this,pi).getPathTranslatedSVGProperties(C(this,Le,Ny).call(this),this.parentDimensions),{bbox:C(this,Le,Qc).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,yh)&&(T(this,yh,!1),this.commit(),this.parent.setSelected(this),this.div.focus())}remove(){C(this,Le,JA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,Le,Zd).call(this),C(this,Le,ef).call(this,u(this,pi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),C(this,Le,JA).call(this)):t&&(this._uiManager.addShouldRescale(this),C(this,Le,Zd).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Pi._mergeSVGProperties({bbox:C(this,Le,Qc).call(this)},u(this,pi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&C(this,Le,ef).call(this,u(this,pi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,s,r,o){He("Not implemented")}static startDrawing(t,i,s,{target:r,offsetX:o,offsetY:a}){const{viewport:{rotation:l}}=t,{width:c,height:h}=r.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f);if(window.addEventListener("pointerup",g=>{f.abort(),t.toggleDrawing(!0),this._endDraw(g)},{signal:p}),window.addEventListener("pointerdown",ms,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Is,{signal:p}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),t.toggleDrawing(),this._currentDraw){t.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.startNew(o,a,c,h,l));return}i.updateUIForDefaultProperties(this),this._currentDraw=this.createDrawerInstance(o,a,c,h,l),this._currentDrawingOptions=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(this._currentDrawingOptions.toSVGProperties(),this._currentDraw.defaultSVGProperties),!0,!1)}static _drawMove({offsetX:t,offsetY:i}){this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.add(t,i))}static _endDraw({offsetX:t,offsetY:i}){const s=this._currentParent;if(s.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.end(t,i)),this.supportMultipleDrawings){const r=this._currentDraw,o=this._currentDrawId,a=r.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(o,r.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(o,r.removeLastElement())},mustExec:!1,type:Re.DRAW_STEP});return}this.endDrawing(!1)}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Re.DRAW_STEP),!this._currentDraw.isEmpty()){const{pageDimensions:[s,r],scale:o}=i,a=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:this._currentDraw.getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:this._currentDrawingOptions,mustBeCommitted:!t});return this._cleanup(),a}return i.drawLayer.remove(this._currentDrawId),this._cleanup(),null}static _cleanup(){this._currentDrawId=-1,this._currentDraw=null,this._currentDrawingOptions=null,this._currentParent=null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,o,a){He("Not implemented")}static async deserialize(t,i,s){var f,p;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}=i.viewport,c=this.deserializeDraw(a,l,r,o,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),C(f=h,Le,QA).call(f,{drawOutlines:c}),C(p=h,Le,Zd).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,o]=this.pageDimensions;return u(this,pi).serialize([i,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};pi=new WeakMap,yh=new WeakMap,Le=new WeakSet,QA=function({drawOutlines:t,drawId:i,drawingOptions:s}){T(this,pi,t),this._drawingOptions||(this._drawingOptions=s),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=C(this,Le,YA).call(this,t,this.parent),C(this,Le,ef).call(this,t.box)},YA=function(t,i){const{id:s}=i.drawLayer.draw(Pi._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},JA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Zd=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=C(this,Le,YA).call(this,u(this,pi),t)}},rM=function([t,i,s,r]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},Ny=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},ef=function(t){if([this.x,this.y,this.width,this.height]=C(this,Le,rM).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},Qc=function(){const{x:t,y:i,width:s,height:r,rotation:o,parentRotation:a,parentDimensions:[l,c]}=this;switch((o*4+a)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/c),r*(c/l),s*(l/c)];case 5:return[1-i,t,s*(l/c),r*(c/l)];case 6:return[1-t-r*(c/l),1-i,r*(c/l),s*(l/c)];case 7:return[i-s*(l/c),1-t-r*(c/l),s*(l/c),r*(c/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(c/l),i,r*(c/l),s*(l/c)];case 13:return[1-i-s*(l/c),t-r*(c/l),s*(l/c),r*(c/l)];case 14:return[1-t,1-i-s*(l/c),r*(c/l),s*(l/c)];case 15:return[i,1-t,s*(l/c),r*(c/l)];default:return[t,i,s,r]}},ce(Pi,"_currentDrawId",-1),ce(Pi,"_currentDraw",null),ce(Pi,"_currentDrawingOptions",null),ce(Pi,"_currentParent",null),ce(Pi,"_INNER_MARGIN",3);let XA=Pi;var qs,Bt,$t,Xl,vh,Gn,Qt,Fi,Ql,Yl,Jl,_h,Ly;class n8{constructor(e,t,i,s,r,o){R(this,_h);R(this,qs,new Float64Array(6));R(this,Bt);R(this,$t);R(this,Xl);R(this,vh);R(this,Gn);R(this,Qt,"");R(this,Fi,0);R(this,Ql,new Vv);R(this,Yl);R(this,Jl);T(this,Yl,i),T(this,Jl,s),T(this,Xl,r),T(this,vh,o),[e,t]=C(this,_h,Ly).call(this,e,t);const a=T(this,Bt,[NaN,NaN,NaN,NaN,e,t]);T(this,Gn,[e,t]),T(this,$t,[{line:a,points:u(this,Gn)}]),u(this,qs).set(a,0)}updateProperty(e,t){e==="stroke-width"&&T(this,vh,t)}isEmpty(){return!u(this,$t)||u(this,$t).length===0}add(e,t){[e,t]=C(this,_h,Ly).call(this,e,t);const[i,s,r,o]=u(this,qs).subarray(2,6),a=e-r,l=t-o;return Math.hypot(u(this,Yl)*a,u(this,Jl)*l)<=2?null:(u(this,Gn).push(e,t),isNaN(i)?(u(this,qs).set([r,o,e,t],2),u(this,Bt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(u(this,qs)[0])&&u(this,Bt).splice(6,6),u(this,qs).set([i,s,r,o,e,t],0),u(this,Bt).push((i+5*r)/6,(s+5*o)/6,(5*r+e)/6,(5*o+t)/6,(r+e)/2,(o+t)/2),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(u(this,Gn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){T(this,Yl,i),T(this,Jl,s),T(this,Xl,r),[e,t]=C(this,_h,Ly).call(this,e,t);const o=T(this,Bt,[NaN,NaN,NaN,NaN,e,t]);T(this,Gn,[e,t]);const a=u(this,$t).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),u(this,$t).push({line:o,points:u(this,Gn)}),u(this,qs).set(o,0),T(this,Fi,0),this.toSVGPath(),null}getLastElement(){return u(this,$t).at(-1)}setLastElement(e){return u(this,$t)?(u(this,$t).push(e),T(this,Bt,e.line),T(this,Gn,e.points),T(this,Fi,0),{path:{d:this.toSVGPath()}}):u(this,Ql).setLastElement(e)}removeLastElement(){if(!u(this,$t))return u(this,Ql).removeLastElement();u(this,$t).pop(),T(this,Qt,"");for(let e=0,t=u(this,$t).length;e<t;e++){const{line:i,points:s}=u(this,$t)[e];T(this,Bt,i),T(this,Gn,s),T(this,Fi,0),this.toSVGPath()}return{path:{d:u(this,Qt)}}}toSVGPath(){const e=te.svgRound(u(this,Bt)[4]),t=te.svgRound(u(this,Bt)[5]);if(u(this,Gn).length===2)return T(this,Qt,`${u(this,Qt)} M ${e} ${t} Z`),u(this,Qt);if(u(this,Gn).length<=6){const s=u(this,Qt).lastIndexOf("M");T(this,Qt,`${u(this,Qt).slice(0,s)} M ${e} ${t}`),T(this,Fi,6)}if(u(this,Gn).length===4){const s=te.svgRound(u(this,Bt)[10]),r=te.svgRound(u(this,Bt)[11]);return T(this,Qt,`${u(this,Qt)} L ${s} ${r}`),T(this,Fi,12),u(this,Qt)}const i=[];u(this,Fi)===0&&(i.push(`M ${e} ${t}`),T(this,Fi,6));for(let s=u(this,Fi),r=u(this,Bt).length;s<r;s+=6){const[o,a,l,c,h,f]=u(this,Bt).slice(s,s+6).map(te.svgRound);i.push(`C${o} ${a} ${l} ${c} ${h} ${f}`)}return T(this,Qt,u(this,Qt)+i.join(" ")),T(this,Fi,u(this,Bt).length),u(this,Qt)}getOutlines(e,t,i,s){const r=u(this,$t).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),u(this,Ql).build(u(this,$t),e,t,i,u(this,Xl),u(this,vh),s),T(this,qs,null),T(this,Bt,null),T(this,$t,null),T(this,Qt,null),u(this,Ql)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}qs=new WeakMap,Bt=new WeakMap,$t=new WeakMap,Xl=new WeakMap,vh=new WeakMap,Gn=new WeakMap,Qt=new WeakMap,Fi=new WeakMap,Ql=new WeakMap,Yl=new WeakMap,Jl=new WeakMap,_h=new WeakSet,Ly=function(e,t){return te._normalizePoint(e,t,u(this,Yl),u(this,Jl),u(this,Xl))};var Pn,pg,gg,gi,Ws,Gs,wh,Eh,Ah,en,mr,oM,aM,lM;const Tb=class Tb extends te{constructor(){super(...arguments);R(this,en);R(this,Pn);R(this,pg,0);R(this,gg);R(this,gi);R(this,Ws);R(this,Gs);R(this,wh);R(this,Eh);R(this,Ah)}build(t,i,s,r,o,a,l){T(this,Ws,i),T(this,Gs,s),T(this,wh,r),T(this,Eh,o),T(this,Ah,a),T(this,gg,l??0),T(this,gi,t),C(this,en,aM).call(this)}setLastElement(t){return u(this,gi).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,gi).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of u(this,gi)){if(t.push(`M${te.svgRound(i[4])} ${te.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12){t.push(`L${te.svgRound(i[10])} ${te.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[o,a,l,c,h,f]=i.subarray(s,s+6).map(te.svgRound);t.push(`C${o} ${a} ${l} ${c} ${h} ${f}`)}}return t.join("")}serialize([t,i,s,r],o){const a=[],l=[],[c,h,f,p]=C(this,en,oM).call(this);let g,y,_,A,v,E,S,P,O;switch(u(this,Eh)){case 0:O=te._rescale,g=t,y=i+r,_=s,A=-r,v=t+c*s,E=i+(1-h-p)*r,S=t+(c+f)*s,P=i+(1-h)*r;break;case 90:O=te._rescaleAndSwap,g=t,y=i,_=s,A=r,v=t+h*s,E=i+c*r,S=t+(h+p)*s,P=i+(c+f)*r;break;case 180:O=te._rescale,g=t+s,y=i,_=-s,A=r,v=t+(1-c-f)*s,E=i+h*r,S=t+(1-c)*s,P=i+(h+p)*r;break;case 270:O=te._rescaleAndSwap,g=t+s,y=i+r,_=-s,A=-r,v=t+(1-h-p)*s,E=i+(1-c-f)*r,S=t+(1-h)*s,P=i+(1-c)*r;break}for(const{line:F,points:I}of u(this,gi))a.push(O(F,g,y,_,A,o?new Array(F.length):null)),l.push(O(I,g,y,_,A,o?new Array(I.length):null));return{lines:a,points:l,rect:[v,E,S,P]}}static deserialize(t,i,s,r,o,{paths:{lines:a,points:l},rotation:c,thickness:h}){const f=[];let p,g,y,_,A;switch(c){case 0:A=te._rescale,p=-t/s,g=i/r+1,y=1/s,_=-1/r;break;case 90:A=te._rescaleAndSwap,p=-i/r,g=-t/s,y=1/r,_=1/s;break;case 180:A=te._rescale,p=t/s+1,g=-i/r,y=-1/s,_=1/r;break;case 270:A=te._rescaleAndSwap,p=i/r+1,g=t/s+1,y=-1/r,_=-1/s;break}for(let E=0,S=a.length;E<S;E++)f.push({line:A(a[E].map(P=>P??NaN),p,g,y,_),points:A(l[E].map(P=>P??NaN),p,g,y,_)});const v=new Tb;return v.build(f,s,r,1,c,h,o),v}get box(){return u(this,Pn)}updateProperty(t,i){return t==="stroke-width"?C(this,en,lM).call(this,i):null}updateParentDimensions([t,i],s){const[r,o]=C(this,en,mr).call(this);T(this,Ws,t),T(this,Gs,i),T(this,wh,s);const[a,l]=C(this,en,mr).call(this),c=a-r,h=l-o,f=u(this,Pn);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f}updateRotation(t){return T(this,pg,t),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,Pn).map(te.svgRound).join(" ")}get defaultProperties(){const[t,i]=u(this,Pn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${te.svgRound(t)} ${te.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=u(this,Pn);let s=0,r=0,o=0,a=0,l=0,c=0;switch(u(this,pg)){case 90:r=i/t,o=-t/i,l=t;break;case 180:s=-1,a=-1,l=t,c=i;break;case 270:r=-i/t,o=t/i,c=i;break;default:return""}return`matrix(${s} ${r} ${o} ${a} ${te.svgRound(l)} ${te.svgRound(c)})`}getPathResizingSVGProperties([t,i,s,r]){const[o,a]=C(this,en,mr).call(this),[l,c,h,f]=u(this,Pn);if(Math.abs(h-o)<=te.PRECISION||Math.abs(f-a)<=te.PRECISION){const A=t+s/2-(l+h/2),v=i+r/2-(c+f/2);return{path:{"transform-origin":`${te.svgRound(t)} ${te.svgRound(i)}`,transform:`${this.rotationTransform} translate(${A} ${v})`}}}const p=(s-2*o)/(h-2*o),g=(r-2*a)/(f-2*a),y=h/s,_=f/r;return{path:{"transform-origin":`${te.svgRound(l)} ${te.svgRound(c)}`,transform:`${this.rotationTransform} scale(${y} ${_}) translate(${te.svgRound(o)} ${te.svgRound(a)}) scale(${p} ${g}) translate(${te.svgRound(-o)} ${te.svgRound(-a)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[o,a]=C(this,en,mr).call(this),l=u(this,Pn),[c,h,f,p]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(f-o)<=te.PRECISION||Math.abs(p-a)<=te.PRECISION){const v=t+s/2-(c+f/2),E=i+r/2-(h+p/2);for(const{line:S,points:P}of u(this,gi))te._translate(S,v,E,S),te._translate(P,v,E,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${te.svgRound(t)} ${te.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(s-2*o)/(f-2*o),y=(r-2*a)/(p-2*a),_=-g*(c+o)+t+o,A=-y*(h+a)+i+a;if(g!==1||y!==1||_!==0||A!==0)for(const{line:v,points:E}of u(this,gi))te._rescale(v,_,A,g,y,v),te._rescale(E,_,A,g,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${te.svgRound(t)} ${te.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,o]=s,a=u(this,Pn),l=t-a[0],c=i-a[1];if(u(this,Ws)===r&&u(this,Gs)===o)for(const{line:h,points:f}of u(this,gi))te._translate(h,l,c,h),te._translate(f,l,c,f);else{const h=u(this,Ws)/r,f=u(this,Gs)/o;T(this,Ws,r),T(this,Gs,o);for(const{line:p,points:g}of u(this,gi))te._rescale(p,l,c,h,f,p),te._rescale(g,l,c,h,f,g);a[2]*=h,a[3]*=f}return a[0]=t,a[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${te.svgRound(t)} ${te.svgRound(i)}`}}}get defaultSVGProperties(){const t=u(this,Pn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${te.svgRound(t[0])} ${te.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Pn=new WeakMap,pg=new WeakMap,gg=new WeakMap,gi=new WeakMap,Ws=new WeakMap,Gs=new WeakMap,wh=new WeakMap,Eh=new WeakMap,Ah=new WeakMap,en=new WeakSet,mr=function(t=u(this,Ah)){const i=u(this,gg)+t/2*u(this,wh);return u(this,Eh)%180===0?[i/u(this,Ws),i/u(this,Gs)]:[i/u(this,Gs),i/u(this,Ws)]},oM=function(){const[t,i,s,r]=u(this,Pn),[o,a]=C(this,en,mr).call(this,0);return[t+o,i+a,s-2*o,r-2*a]},aM=function(){const t=T(this,Pn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of u(this,gi)){if(r.length<=12){for(let l=4,c=r.length;l<c;l+=6){const[h,f]=r.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],f)}continue}let o=r[4],a=r[5];for(let l=6,c=r.length;l<c;l+=6){const[h,f,p,g,y,_]=r.subarray(l,l+6);re.bezierBoundingBox(o,a,h,f,p,g,y,_,t),o=y,a=_}}const[i,s]=C(this,en,mr).call(this);t[0]=Math.min(1,Math.max(0,t[0]-i)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+i)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},lM=function(t){const[i,s]=C(this,en,mr).call(this);T(this,Ah,t);const[r,o]=C(this,en,mr).call(this),[a,l]=[r-i,o-s],c=u(this,Pn);return c[0]-=a,c[1]-=l,c[2]+=2*a,c[3]+=2*l,c};let Vv=Tb;var Th;const Sb=class Sb extends t8{constructor(t){super();R(this,Th);T(this,Th,t),super.updateProperties({fill:"none",stroke:ct._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=u(this,Th).realScale),super.updateSVGProperty(t,i)}clone(){const t=new Sb(u(this,Th));return t.updateAll(this),t}};Th=new WeakMap;let ZA=Sb;const hu=class hu extends XA{constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){ct.initialize(e,t),this._defaultDrawingOptions=new ZA(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Te(this,"typesMap",new Map([[Re.INK_THICKNESS,"stroke-width"],[Re.INK_COLOR,"stroke"],[Re.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,s,r){return new n8(e,t,i,s,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,s,r,o){return Vv.deserialize(e,t,i,s,r,o)}static async deserialize(e,t,i){return e instanceof _b?null:super.deserialize(e,t,i)}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=hu.getDefaultDrawingOptions({stroke:re.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:i,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":o,"stroke-width":a}}=this,l={annotationType:we.INK,color:ct._colorManager.convert(r),opacity:o,thickness:a,paths:{lines:t,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return l.id=this.annotationElementId,l}};ce(hu,"_type","ink"),ce(hu,"_editorType",we.INK),ce(hu,"_defaultDrawingOptions",null);let eT=hu;var at,Yt,ta,Ur,na,Sh,Ks,jr,Xs,mi,bh,Ce,tf,nf,Dy,nT,cM,My,iT,Oy,uM,hM;const Ef=class Ef extends ct{constructor(t){super({...t,name:"stampEditor"});R(this,Ce);R(this,at,null);R(this,Yt,null);R(this,ta,null);R(this,Ur,null);R(this,na,null);R(this,Sh,"");R(this,Ks,null);R(this,jr,null);R(this,Xs,null);R(this,mi,!1);R(this,bh,!1);T(this,Ur,t.bitmapUrl),T(this,na,t.bitmapFile)}static initialize(t,i){ct.initialize(t,i)}static get supportedTypes(){return Te(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return Te(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,i){i.pasteEditor(we.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),i&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t,i;u(this,Yt)&&(T(this,at,null),this._uiManager.imageManager.deleteId(u(this,Yt)),(t=u(this,Ks))==null||t.remove(),T(this,Ks,null),(i=u(this,jr))==null||i.disconnect(),T(this,jr,null),u(this,Xs)&&(clearTimeout(u(this,Xs)),T(this,Xs,null))),super.remove()}rebuild(){if(!this.parent){u(this,Yt)&&C(this,Ce,Dy).call(this);return}super.rebuild(),this.div!==null&&(u(this,Yt)&&u(this,Ks)===null&&C(this,Ce,Dy).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(u(this,ta)||u(this,at)||u(this,Ur)||u(this,na)||u(this,Yt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),u(this,at)?C(this,Ce,nT).call(this):C(this,Ce,Dy).call(this),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r)}return this.div}copyCanvas(t,i,s=!1){var g;t||(t=224);const{width:r,height:o}=u(this,at),a=new eA;let l=u(this,at),c=r,h=o,f=null;if(i){if(r>i||o>i){const b=Math.min(i/r,i/o);c=Math.floor(r*b),h=Math.floor(o*b)}f=document.createElement("canvas");const y=f.width=Math.ceil(c*a.sx),_=f.height=Math.ceil(h*a.sy);u(this,mi)||(l=C(this,Ce,My).call(this,y,_));const A=f.getContext("2d");A.filter=this._uiManager.hcmFilter;let v="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",E="#42414d");const S=15,P=S*a.sx,O=S*a.sy,F=new OffscreenCanvas(P*2,O*2),I=F.getContext("2d");I.fillStyle=v,I.fillRect(0,0,P*2,O*2),I.fillStyle=E,I.fillRect(0,0,P,O),I.fillRect(P,O,P,O),A.fillStyle=A.createPattern(F,"repeat"),A.fillRect(0,0,y,_),A.drawImage(l,0,0,l.width,l.height,0,0,y,_)}let p=null;if(s){let y,_;if(a.symmetric&&l.width<t&&l.height<t)y=l.width,_=l.height;else if(l=u(this,at),r>t||o>t){const E=Math.min(t/r,t/o);y=Math.floor(r*E),_=Math.floor(o*E),u(this,mi)||(l=C(this,Ce,My).call(this,y,_))}const v=new OffscreenCanvas(y,_).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,y,_),p={width:y,height:_,data:v.getImageData(0,0,y,_).data}}return{canvas:f,width:c,height:h,imageData:p}}getImageForAltText(){return u(this,Ks)}static async deserialize(t,i,s){var _;let r=null;if(t instanceof PD){const{data:{rect:A,rotation:v,id:E,structParent:S,popupRef:P},container:O,parent:{page:{pageNumber:F}}}=t,I=O.querySelector("canvas"),b=s.imageManager.getFromCanvas(O.id,I);I.remove();const k=((_=await i._structTree.getAriaAttributes(`${hb}${E}`))==null?void 0:_.get("aria-label"))||"";r=t={annotationType:we.STAMP,bitmapId:b.id,bitmap:b.bitmap,pageIndex:F-1,rect:A.slice(0),rotation:v,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:k},isSvg:!1,structParent:S,popupRef:P}}const o=await super.deserialize(t,i,s),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:h,isSvg:f,accessibilityData:p}=t;h&&s.imageManager.isValidId(h)?(T(o,Yt,h),l&&T(o,at,l)):T(o,Ur,c),T(o,mi,f);const[g,y]=o.pageDimensions;return o.width=(a[2]-a[0])/g,o.height=(a[3]-a[1])/y,o.annotationElementId=t.id||null,p&&(o.altTextData=p),o._initialData=r,T(o,bh,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:we.STAMP,bitmapId:u(this,Yt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:u(this,mi),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=C(this,Ce,Oy).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=C(this,Ce,hM).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const a=u(this,mi)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(u(this,Yt)))i.stamps.set(u(this,Yt),{area:a,serialized:s}),s.bitmap=C(this,Ce,Oy).call(this,!1);else if(u(this,mi)){const l=i.stamps.get(u(this,Yt));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=C(this,Ce,Oy).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};at=new WeakMap,Yt=new WeakMap,ta=new WeakMap,Ur=new WeakMap,na=new WeakMap,Sh=new WeakMap,Ks=new WeakMap,jr=new WeakMap,Xs=new WeakMap,mi=new WeakMap,bh=new WeakMap,Ce=new WeakSet,tf=function(t,i=!1){if(!t){this.remove();return}T(this,at,t.bitmap),i||(T(this,Yt,t.id),T(this,mi,t.isSvg)),t.file&&T(this,Sh,t.file.name),C(this,Ce,nT).call(this)},nf=function(){if(T(this,ta,null),this._uiManager.enableWaiting(!1),!!u(this,Ks)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,at)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,at)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Dy=function(){if(u(this,Yt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,Yt)).then(s=>C(this,Ce,tf).call(this,s,!0)).finally(()=>C(this,Ce,nf).call(this));return}if(u(this,Ur)){const s=u(this,Ur);T(this,Ur,null),this._uiManager.enableWaiting(!0),T(this,ta,this._uiManager.imageManager.getFromUrl(s).then(r=>C(this,Ce,tf).call(this,r)).finally(()=>C(this,Ce,nf).call(this)));return}if(u(this,na)){const s=u(this,na);T(this,na,null),this._uiManager.enableWaiting(!0),T(this,ta,this._uiManager.imageManager.getFromFile(s).then(r=>C(this,Ce,tf).call(this,r)).finally(()=>C(this,Ce,nf).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Ef.supportedTypesStr;const i=this._uiManager._signal;T(this,ta,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),C(this,Ce,tf).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>C(this,Ce,nf).call(this))),t.click()},nT=function(){const{div:t}=this;let{width:i,height:s}=u(this,at);const[r,o]=this.pageDimensions,a=.75;if(this.width)i=this.width*r,s=this.height*o;else if(i>a*r||s>a*o){const f=Math.min(a*r/i,a*o/s);i*=f,s*=f}const[l,c]=this.parentDimensions;this.setDims(i*l/r,s*c/o),this._uiManager.enableWaiting(!1);const h=T(this,Ks,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),C(this,Ce,iT).call(this,i,s),C(this,Ce,uM).call(this),u(this,bh)||(this.parent.addUndoableEditor(this),T(this,bh,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,Sh)&&h.setAttribute("aria-label",u(this,Sh))},cM=function(t,i){var a;const[s,r]=this.parentDimensions;this.width=t/s,this.height=i/r,(a=this._initialOptions)!=null&&a.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,u(this,Xs)!==null&&clearTimeout(u(this,Xs)),T(this,Xs,setTimeout(()=>{T(this,Xs,null),C(this,Ce,iT).call(this,t,i)},200))},My=function(t,i){const{width:s,height:r}=u(this,at);let o=s,a=r,l=u(this,at);for(;o>2*t||a>2*i;){const c=o,h=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*i&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const f=new OffscreenCanvas(o,a);f.getContext("2d").drawImage(l,0,0,c,h,0,0,o,a),l=f.transferToImageBitmap()}return l},iT=function(t,i){const s=new eA,r=Math.ceil(t*s.sx),o=Math.ceil(i*s.sy),a=u(this,Ks);if(!a||a.width===r&&a.height===o)return;a.width=r,a.height=o;const l=u(this,mi)?u(this,at):C(this,Ce,My).call(this,r,o),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,r,o)},Oy=function(t){if(t){if(u(this,mi)){const r=this._uiManager.imageManager.getSvgUrl(u(this,Yt));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=u(this,at),i.getContext("2d").drawImage(u(this,at),0,0),i.toDataURL()}if(u(this,mi)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*xa.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*xa.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(u(this,at),0,0,u(this,at).width,u(this,at).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(u(this,at))},uM=function(){this._uiManager._signal&&(T(this,jr,new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&C(this,Ce,cM).call(this,i.width,i.height)})),u(this,jr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=u(this,jr))==null||t.disconnect(),T(this,jr,null)},{once:!0}))},hM=function(t){var c;const{rect:i,pageIndex:s,accessibilityData:{altText:r}}=this._initialData,o=t.rect.every((h,f)=>Math.abs(h-i[f])<1),a=t.pageIndex===s,l=(((c=t.accessibilityData)==null?void 0:c.alt)||"")===r;return{isSame:o&&a&&l,isSameAltText:l}},ce(Ef,"_type","stamp"),ce(Ef,"_editorType",we.STAMP);let tT=Ef;var Zl,Ih,Qs,ia,Br,Vi,sa,Ch,ds,vn,$r,se,ra,it,dM,Ps,rT,oT,Fy;const Ji=class Ji{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:h}){R(this,it);R(this,Zl);R(this,Ih,!1);R(this,Qs,null);R(this,ia,null);R(this,Br,null);R(this,Vi,new Map);R(this,sa,!1);R(this,Ch,!1);R(this,ds,null);R(this,vn,null);R(this,$r,null);R(this,se);const f=[...u(Ji,ra).values()];if(!Ji._initialized){Ji._initialized=!0;for(const p of f)p.initialize(h,e)}e.registerEditorTypes(f),T(this,se,e),this.pageIndex=t,this.div=i,T(this,Zl,r),T(this,Qs,o),this.viewport=c,T(this,vn,l),this.drawLayer=a,this._structTree=s,u(this,se).addLayer(this)}get isEmpty(){return u(this,Vi).size===0}get isInvisible(){return this.isEmpty&&u(this,se).getMode()===we.NONE}updateToolbar(e){u(this,se).updateToolbar(e)}updateMode(e=u(this,se).getMode()){switch(C(this,it,Fy).call(this),e){case we.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case we.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case we.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of u(Ji,ra).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=u(this,vn))==null?void 0:t.div)}setEditingState(e){u(this,se).setEditingState(e)}addCommands(e){u(this,se).addCommands(e)}cleanUndoStack(e){u(this,se).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=u(this,Qs))==null||t.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of u(this,Vi).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(u(this,se).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!u(this,Qs))return;const t=u(this,Qs).getEditableAnnotations();for(const i of t){if(i.hide(),u(this,se).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){var s;T(this,Ch,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of u(this,Vi).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(u(this,Qs)){const r=u(this,Qs).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(u(this,se).isDeletedAnnotationElement(a))continue;let l=t.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=e.get(a),l&&(u(this,se).addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}C(this,it,Fy).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of u(Ji,ra).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,Ch,!1)}getEditableAnnotation(e){var t;return((t=u(this,Qs))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){u(this,se).getActive()!==e&&u(this,se).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=u(this,vn))!=null&&e.div&&!u(this,$r)){T(this,$r,new AbortController);const t=u(this,se).combinedSignal(u(this,$r));u(this,vn).div.addEventListener("pointerdown",C(this,it,dM).bind(this),{signal:t}),u(this,vn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=u(this,vn))!=null&&e.div&&u(this,$r)&&(u(this,$r).abort(),T(this,$r,null),u(this,vn).div.classList.remove("highlighting"))}enableClick(){if(u(this,ia))return;T(this,ia,new AbortController);const e=u(this,se).combinedSignal(u(this,ia));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){var e;(e=u(this,ia))==null||e.abort(),T(this,ia,null)}attach(e){u(this,Vi).set(e.id,e);const{annotationElementId:t}=e;t&&u(this,se).isDeletedAnnotationElement(t)&&u(this,se).removeDeletedAnnotationElement(e)}detach(e){var t;u(this,Vi).delete(e.id),(t=u(this,Zl))==null||t.removePointerInTextLayer(e.contentDiv),!u(this,Ch)&&e.annotationElementId&&u(this,se).addDeletedAnnotationElement(e)}remove(e){this.detach(e),u(this,se).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(u(this,se).addDeletedAnnotationElement(e.annotationElementId),ct.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),u(this,se).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),u(this,se).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!u(this,Br)&&(e._focusEventsAllowed=!1,T(this,Br,setTimeout(()=>{T(this,Br,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:u(this,se)._signal}),t.focus())},0))),e._structTreeParentId=(i=u(this,Zl))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return u(this,se).getId()}combinedSignal(e){return u(this,se).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=u(this,it,Ps))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){u(this,se).updateToolbar(e),u(this,se).updateMode(e);const{offsetX:i,offsetY:s}=C(this,it,oT).call(this),r=this.getNextId(),o=C(this,it,rT).call(this,{parent:this,id:r,x:i,y:s,uiManager:u(this,se),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=u(Ji,ra).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,u(this,se)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=C(this,it,rT).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:u(this,se),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(C(this,it,oT).call(this),!0)}setSelected(e){u(this,se).setSelected(e)}toggleSelected(e){u(this,se).toggleSelected(e)}unselect(e){u(this,se).unselect(e)}pointerup(e){var i;const{isMac:t}=Fn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&u(this,sa)&&(T(this,sa,!1),!((i=u(this,it,Ps))!=null&&i.isDrawer&&u(this,it,Ps).supportMultipleDrawings))){if(!u(this,Ih)){T(this,Ih,!0);return}if(u(this,se).getMode()===we.STAMP){u(this,se).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(u(this,se).getMode()===we.HIGHLIGHT&&this.enableTextSelection(),u(this,sa)){T(this,sa,!1);return}const{isMac:t}=Fn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(T(this,sa,!0),(s=u(this,it,Ps))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=u(this,se).getActive();T(this,Ih,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus(),u(this,ds)){u(this,it,Ps).startDrawing(this,u(this,se),!1,e);return}u(this,se).unselectAll(),T(this,ds,new AbortController);const t=u(this,se).combinedSignal(u(this,ds));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&this.commitOrRemove()},{signal:t}),u(this,se).disableUserSelect(!0),u(this,it,Ps).startDrawing(this,u(this,se),!1,e)}endDrawingSession(e=!1){return u(this,ds)?(u(this,ds).abort(),T(this,ds,null),u(this,se).disableUserSelect(!1),u(this,it,Ps).endDrawing(e)):null}findNewParent(e,t,i){const s=u(this,se).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return u(this,ds)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,ds)&&u(this,it,Ps).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=u(this,se).getActive())==null?void 0:e.parent)===this&&(u(this,se).commitOrRemove(),u(this,se).setActiveEditor(null)),u(this,Br)&&(clearTimeout(u(this,Br)),T(this,Br,null));for(const i of u(this,Vi).values())(t=u(this,Zl))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,u(this,Vi).clear(),u(this,se).removeLayer(this)}render({viewport:e}){this.viewport=e,yc(this.div,e);for(const t of u(this,se).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){u(this,se).commitOrRemove(),C(this,it,Fy).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,yc(this.div,{rotation:i}),t!==i)for(const s of u(this,Vi).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return u(this,se).viewParameters.realScale}};Zl=new WeakMap,Ih=new WeakMap,Qs=new WeakMap,ia=new WeakMap,Br=new WeakMap,Vi=new WeakMap,sa=new WeakMap,Ch=new WeakMap,ds=new WeakMap,vn=new WeakMap,$r=new WeakMap,se=new WeakMap,ra=new WeakMap,it=new WeakSet,dM=function(e){u(this,se).unselectAll();const{target:t}=e;if(t===u(this,vn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&u(this,vn).div.contains(t)){const{isMac:i}=Fn.platform;if(e.button!==0||e.ctrlKey&&i)return;u(this,se).showAllEditors("highlight",!0,!0),u(this,vn).div.classList.add("free"),this.toggleDrawing(),Fv.startHighlighting(this,u(this,se).direction==="ltr",{target:u(this,vn).div,x:e.x,y:e.y}),u(this,vn).div.addEventListener("pointerup",()=>{u(this,vn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,se)._signal}),e.preventDefault()}},Ps=function(){return u(Ji,ra).get(u(this,se).getMode())},rT=function(e){const t=u(this,it,Ps);return t?new t.prototype.constructor(e):null},oT=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),c=(r+a)/2-e,h=(o+l)/2-t,[f,p]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:f,offsetY:p}},Fy=function(){for(const e of u(this,Vi).values())e.isEmpty()&&e.remove()},ce(Ji,"_initialized",!1),R(Ji,ra,new Map([UA,eT,tT,Fv].map(e=>[e._editorType,e])));let sT=Ji;var fs,mg,Nn,ec,n_,fM,ar,lT,pM,cT;const pn=class pn{constructor({pageIndex:e}){R(this,ar);R(this,fs,null);R(this,mg,0);R(this,Nn,new Map);R(this,ec,new Map);this.pageIndex=e}setParent(e){if(!u(this,fs)){T(this,fs,e);return}if(u(this,fs)!==e){if(u(this,Nn).size>0)for(const t of u(this,Nn).values())t.remove(),e.append(t);T(this,fs,e)}}static get _svgFactory(){return Te(this,"_svgFactory",new vb)}draw(e,t=!1,i=!1){const s=Rn(this,mg)._++,r=C(this,ar,lT).call(this),o=pn._svgFactory.createElement("defs");r.append(o);const a=pn._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&u(this,ec).set(s,a);const c=i?C(this,ar,pM).call(this,o,l):null,h=pn._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),u(this,Nn).set(s,r),{id:s,clipPathId:`url(#${c})`}}drawOutline(e,t){const i=Rn(this,mg)._++,s=C(this,ar,lT).call(this),r=pn._svgFactory.createElement("defs");s.append(r);const o=pn._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=pn._svgFactory.createElement("mask");r.append(f),l=`mask_p${this.pageIndex}_${i}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=pn._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=pn._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${a}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const c=pn._svgFactory.createElement("use");s.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return s.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),u(this,Nn).set(i,s),i}finalizeDraw(e,t){u(this,ec).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:o}=t,a=typeof e=="number"?u(this,Nn).get(e):e;if(a){if(i&&C(this,ar,cT).call(this,a,i),s&&C(l=pn,n_,fM).call(l,a,s),r){const{classList:c}=a;for(const[h,f]of Object.entries(r))c.toggle(h,f)}if(o){const h=a.firstChild.firstChild;C(this,ar,cT).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const i=u(this,Nn).get(e);i&&(u(t,fs).append(i),u(this,Nn).delete(e),u(t,Nn).set(e,i))}remove(e){u(this,ec).delete(e),u(this,fs)!==null&&(u(this,Nn).get(e).remove(),u(this,Nn).delete(e))}destroy(){T(this,fs,null);for(const e of u(this,Nn).values())e.remove();u(this,Nn).clear(),u(this,ec).clear()}};fs=new WeakMap,mg=new WeakMap,Nn=new WeakMap,ec=new WeakMap,n_=new WeakSet,fM=function(e,[t,i,s,r]){const{style:o}=e;o.top=`${100*i}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*r}%`},ar=new WeakSet,lT=function(){const e=pn._svgFactory.create(1,1,!0);return u(this,fs).append(e),e.setAttribute("aria-hidden",!0),e},pM=function(e,t){const i=pn._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=pn._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},cT=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},R(pn,n_);let aT=pn;globalThis.pdfjsTestingUtils={HighlightOutliner:BA};ge.AbortException;ge.AnnotationEditorLayer;ge.AnnotationEditorParamsType;ge.AnnotationEditorType;ge.AnnotationEditorUIManager;ge.AnnotationLayer;ge.AnnotationMode;ge.ColorPicker;ge.DOMSVGFactory;ge.DrawLayer;ge.FeatureTest;var i8=ge.GlobalWorkerOptions;ge.ImageKind;ge.InvalidPDFException;ge.MissingPDFException;ge.OPS;ge.OutputScale;ge.PDFDataRangeTransport;ge.PDFDateString;ge.PDFWorker;ge.PasswordResponses;ge.PermissionFlag;ge.PixelsPerInch;ge.RenderingCancelledException;ge.TextLayer;ge.UnexpectedResponseException;ge.Util;ge.VerbosityLevel;ge.XfaLayer;ge.build;ge.createValidAbsoluteUrl;ge.fetchData;var s8=ge.getDocument;ge.getFilenameFromUrl;ge.getPdfFilenameFromUrl;ge.getXfaPageViewport;ge.isDataScheme;ge.isPdfFile;ge.noContextMenu;ge.normalizeUnicode;ge.setLayerDimensions;ge.shadow;ge.stopEvent;ge.version;typeof window<"u"&&"Worker"in window&&(i8.workerPort=new Worker(new URL("/assets/pdf.worker-CEmIRqIf.js",import.meta.url),{type:"module"}));async function r8(n){const e=await n.arrayBuffer(),t=await s8({data:e}).promise;let i="";for(let s=1;s<=t.numPages;s++){const a=(await(await t.getPage(s)).getTextContent()).items.map(l=>l.str).join(" ");i+=a+`
`}return console.log(i),i}function o8(n,e=500){const t=n.split(/\s+/),i=[];for(let s=0;s<t.length;s+=e){const r=t.slice(s,s+e).join(" ");i.push(r)}return i}const a8=(n,e)=>new Promise(async(t,i)=>{try{if(!await S9("Course",e))throw new Error("document-non-existent");const r=await ab("Course",e);if(r.uid!==n)throw new Error("not-user-course");t(r)}catch(s){console.error(s),i(s)}}),l8=(n,e)=>new Promise(async(t,i)=>{try{console.log(e),await Mg("Course",n,e),t()}catch(s){console.error(s),i(s)}}),c8=(n,e,t,i,s,r)=>new Promise(async(o,a)=>{try{console.log("hehrehreh");const l=await r8(n),c=o8(l),h=await G9(c),f=await X9(c),p={assimilation:100,courseCode:e,notepadId:r,outline:f,summary:h,pdfTitle:`${n.name}`,uid:i},g=await lb("Course",{...p});await Mg("Lecture",s,{courses:WH({courseId:g,fileName:n.name,fileSize:n.size/(1024*1024)})}),o()}catch(l){console.error(l),a(l)}}),u8=n=>new Promise(async(e,t)=>{try{const i=await lb("Notepad",{lectureId:n,notes:[]});e(i)}catch(i){console.error(i),t(i)}}),gM=(n,e)=>new Promise(async(t,i)=>{try{await Mg("Notepad",n,{notes:e}),t()}catch(s){console.error(s),i(s)}}),mM=n=>new Promise(async(e,t)=>{try{console.log(n);const i=await ab("Notepad",n);e(i)}catch(i){console.error(i),t(i)}}),h8=()=>{var V,D,oe,Pe;U.useRef(null);const{userCredential:n}=Og(),e=cP(),t=Tc();U.useState(!1);const[i,s]=U.useState(!1),[r,o]=U.useState(null),[a,l]=U.useState(0),[c,h]=U.useState(!1),[f,p]=U.useState([]),[g,y]=U.useState(!1),[_,A]=U.useState(null),[v,E]=U.useState(e.lectureId),S=K=>{p(z=>z.filter((B,Q)=>Q!==K))},P=K=>{p(z=>[...z,K])},O=async K=>{var B;const z={...r};if(z.outline[K].covered=!0,o(z),l(K),setTimeout(()=>{L(z)},300),z.outline[K].isQuiz){Nv();return}cy((B=z==null?void 0:z.outline[K])==null?void 0:B.explanation,()=>{})},F=(K,z)=>{const B={...r};B.outline[a].quiz[K].response=z,console.log(B.outline[a].quiz[K]),o(B)},I=()=>{const K=nq({...r.outline[a]}),z={...r};z.outline[a]=K;const Q=z.outline.filter(ne=>ne.isQuiz).map(ne=>ne.score),fe=Q.reduce((ne,ae)=>ae===null?ne+=100:ne+=ae)/Q.length;z.assimilation=fe,o(z),console.log(K)},b=()=>{Nv(),l(K=>{const z=r==null?void 0:r.outline[K+1],B={...r};return B.outline[K+1].covered=!0,z.isQuiz||cy(z==null?void 0:z.explanation,()=>{}),K+1})},k=()=>{if(a===null)return;const K={...r};K.outline[a].covered=!0,o(K)},L=async K=>{try{const z=K?{...K.outline[a]}:{...r.outline[a]};if(console.log(z),z.explanation===""&&!z.isQuiz){console.log("FIlling up sir"),z.explanation=await z9(r==null?void 0:r.outline[a||0].title,r==null?void 0:r.summary),z.powerPoint=await H9(z.explanation);const B={...K};console.log(B,a),B.outline[a||0]=z,cy(z.explanation),o(B)}else if(z.isQuiz){console.log("FIlling up sir"),z.quiz=await q9(r==null?void 0:r.summary,a);const B={...r};B.outline[a]=z,console.log(B),o(B)}}catch(z){console.log(z)}},M=async()=>{try{const K=await a8(n.uid,e.lectureId);console.log(K);const z=await mM(K.notepadId);o(K),A(K.notepadId),p(z.notes),L(K),y(!0)}catch(K){if(console.error(K),K.message.includes("document-non-existent")){he.error("Wrong document id"),t("/");return}if(K.message.includes("not-user-course")){he.error("Course doesn't belong to you"),t("/");return}he.error("Error occurred")}};return U.useEffect(()=>{g&&gM(_,f)},[f]),U.useEffect(()=>{n&&(console.log(n),M())},[n]),U.useEffect(()=>{g&&(console.log(r),l8(e.lectureId,{...r}).then(()=>{console.log("Data updated")}).catch(K=>console.log(K)))},[r]),U.useEffect(()=>{r===null||a===null||_===null||v===null?$f("lecture"):(r.outline[a].covered===!1&&k(),Mh("lecture"))},[r]),U.useEffect(()=>{},[a]),N.jsxs("div",{className:"LecturePage ",children:[N.jsxs("div",{className:"location-block flex items-center",children:[N.jsx("p",{className:"course-code",children:r==null?void 0:r.courseCode}),N.jsx("i",{className:"fa-light fa-chevron-right"}),N.jsx("p",{className:"file-name",children:r==null?void 0:r.pdfTitle})]}),N.jsxs("div",{className:"explanation-block",children:[N.jsx("div",{className:"outline-block fade-right",children:N.jsx(V9,{lecture:r,onSelectLectureIndex:O})}),N.jsx("div",{className:"presentation-block intro-anim-fade",children:(V=r==null?void 0:r.outline[a])!=null&&V.isQuiz?N.jsx(tq,{currentLectureData:r.outline[a],onSelectOption:F,onSubmitQuiz:I}):N.jsx(U9,{lectureData:r,currentIndex:a,onShowQuestionBox:()=>{D9(),h(!0)},onNextOutline:b,onAddPoint:P})}),N.jsx("div",{className:"preview-block fade-left",children:!((D=r==null?void 0:r.outline[a])!=null&&D.isQuiz)&&N.jsx(iq,{content:(oe=r==null?void 0:r.outline[a])==null?void 0:oe.explanation})})]}),!((Pe=r==null?void 0:r.outline[a])!=null&&Pe.isQuiz)&&N.jsx("div",{className:`notepad-block fade-up ${i?"full-note":"small-note"} `,children:N.jsx(B9,{maxNotepad:i,setMaxNotepad:s,notepad:f,onAddPoint:P,onDeletePoint:S})}),N.jsx(Y9,{visible:c,courseSummary:r==null?void 0:r.summary,onHideQuestionBox:()=>{cb(),h(!1)}})]})},d8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABFCAYAAADO3SFxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKRSURBVHgB7ZxNShxBFMf/9aZN4iKBZJddwBuEHCDZZJkLZOFW0I03EFwIorhSL6AIHkIP4NaVg4LgB34ijqIy3VN26wgi6nRP96vqqno/GGVW1fPjzb+r3swbhZSFpv4HhZH08YsUGqgSjYYGjrXCOmnMjAypJgJCLW7r/+n/JZjhMAF+jw2pLQQCpVW7CHN8j4CV5Qv9FYFA6Vv4MwySxsXPy1PMrW7qDwgAgg0Uhs8GMYoAsCP4kan5Hf0XnpPd5DQsoYAjTRimDg7gCXGC+GQfzYk/Ks6eWxXsK7qDKxVhdm0DkyKYl2mbGRwC4yKYl4Eo+3uTaFzcJbiJNd7OC7tJ4kqOpTdufGoQvn0kDEaEqNXW2G21c74Ay5IdsXzdTnB+m+DHlwHQ/nVcQJuCTZR6fLhA5nTvKga1O0XLQkFE5yNzW+ImZ/8VuiC55C5CqrkXFW3TRPRbVLwPlth4CcNBQ6r5OYwnORGdYeCoHHZsGOpFhFvNhps94Ym21E0LJzYstivDqGayv53xWzRxL5AfP2ODuBcohn/VTNwL9Ic/ool7gXLUQ3QZeu4i6nGmd7eac23TpJq7V9DH8oX2wSK6uIO+DhoSG/lF932Sk2ruXkGP5UsflUX0+w4q60VIbLwuutJmj1Rz9wqeLR+BgacF7H7VKbsIexfw5IC1XSnVbKAfHHpsGGu4h9oSNf6JRmjVbOUjo5Biw+oIQQixUYsZDZ+ruTZDML7GRu2mjHyLjdqOcflSzbWek/MhNpwYRHQ5Npya9HSxmp0bpXUtNpydVXYlNh76wfKDBmV4T7IGiVxe5OcMmBHBzIhgVpQI5kYEMyOCmRHBzIhgZkQwMyKYGRHMDKWdnjsILHSSpHUPJV54WTBqVgIAAAAASUVORK5CYII=";var yM={exports:{}},f8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",p8=f8,g8=p8;function vM(){}function _M(){}_M.resetWarningCache=vM;var m8=function(){function n(i,s,r,o,a,l){if(l!==g8){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:_M,resetWarningCache:vM};return t.PropTypes=t,t};yM.exports=m8();var y8=yM.exports;const wM=uT(y8),EM=({onClick:n,courseData:e})=>N.jsxs("div",{className:"course-folder",onClick:n,children:[N.jsx("img",{src:d8,alt:"Folder",className:"course-icon"}),N.jsx("p",{className:"course-code",children:e==null?void 0:e.courseCode}),N.jsx("p",{className:"course-title",children:e==null?void 0:e.courseTitle})]});EM.propTypes={onClick:wM.func.isRequired};const v8="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M13.8164%200.481201C13.1748%20-0.1604%2012.1377%20-0.1604%2011.4961%200.481201L10.6143%201.36011L13.4824%204.22827L14.3643%203.34644C15.0059%202.70483%2015.0059%201.66772%2014.3643%201.02612L13.8164%200.481201ZM5.05078%206.92651C4.87207%207.10522%204.73438%207.32495%204.65527%207.56812L3.78809%2010.1697C3.70312%2010.4216%203.77051%2010.7%203.95801%2010.8904C4.14551%2011.0808%204.42383%2011.1453%204.67871%2011.0603L7.28027%2010.1931C7.52051%2010.114%207.74023%209.97632%207.92188%209.79761L12.8232%204.89331L9.95215%202.02222L5.05078%206.92651ZM2.8125%201.72046C1.25977%201.72046%200%202.98022%200%204.53296V12.033C0%2013.5857%201.25977%2014.8455%202.8125%2014.8455H10.3125C11.8652%2014.8455%2013.125%2013.5857%2013.125%2012.033V9.22046C13.125%208.7019%2012.7061%208.28296%2012.1875%208.28296C11.6689%208.28296%2011.25%208.7019%2011.25%209.22046V12.033C11.25%2012.5515%2010.8311%2012.9705%2010.3125%2012.9705H2.8125C2.29395%2012.9705%201.875%2012.5515%201.875%2012.033V4.53296C1.875%204.0144%202.29395%203.59546%202.8125%203.59546H5.625C6.14355%203.59546%206.5625%203.17651%206.5625%202.65796C6.5625%202.1394%206.14355%201.72046%205.625%201.72046H2.8125Z'%20fill='white'/%3e%3c/svg%3e",_8="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_45_1320)'%3e%3cpath%20d='M7.5%2015C9.48912%2015%2011.3968%2014.2098%2012.8033%2012.8033C14.2098%2011.3968%2015%209.48912%2015%207.5C15%205.51088%2014.2098%203.60322%2012.8033%202.1967C11.3968%200.790176%209.48912%200%207.5%200C5.51088%200%203.60322%200.790176%202.1967%202.1967C0.790176%203.60322%200%205.51088%200%207.5C0%209.48912%200.790176%2011.3968%202.1967%2012.8033C3.60322%2014.2098%205.51088%2015%207.5%2015ZM6.79688%2010.0781V8.20312H4.92188C4.53223%208.20312%204.21875%207.88965%204.21875%207.5C4.21875%207.11035%204.53223%206.79688%204.92188%206.79688H6.79688V4.92188C6.79688%204.53223%207.11035%204.21875%207.5%204.21875C7.88965%204.21875%208.20312%204.53223%208.20312%204.92188V6.79688H10.0781C10.4678%206.79688%2010.7812%207.11035%2010.7812%207.5C10.7812%207.88965%2010.4678%208.20312%2010.0781%208.20312H8.20312V10.0781C8.20312%2010.4678%207.88965%2010.7812%207.5%2010.7812C7.11035%2010.7812%206.79688%2010.4678%206.79688%2010.0781Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_45_1320'%3e%3crect%20width='15'%20height='15'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",w8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATQSURBVHgBzVddaFxFFD5n5t6bbdomWdOWJmg3m+zmRwgIUotQNCIKVTA+qIVU6otCBfFBHwTpm1b0QYhCX3wVbemLWtCnxLbBvpiCFkOa/900bWgpWRoak+zunTmee+9u9mb/QxO33zI7O3fmzvnmnDPnnAWoMTD7I9bd3YZr6bcl0l6de1wWAsjdQrsjch5AWkmcFPbZV2Ox+Wr2cCWNh8OhRi2vaMLQpokSoDKbpbnFJM082K2O9o/F7kLFQzBMJQf8wrNCSrVKxCTIyJ4V49eLLS31UA0BCykI2wkiMACfbgg0nPstEqmDSgQ2um2GIHitjqzBsmtgB0H8MbR9aqSj+wzUgkCGBZCtP70Uip6GmhBwwNcDET77vaPrQ6gJAZcDOj7x9VC46w3YSQKSm1liDjUZFsCPlyPdz+4YAWSjH9QEAb6Kku2f34Qm01Dq4rW2zm5nvQHbDnQ10EreLcDcYw/8HBXsSwr9Oo++3AECfio+UP5P4fuuIbZMAF0dVlqT6yvl1aImSBnwvlRqAaQEBRAQIF5CW70lEIJaiHdI05JiQ6Y1yTop21lMv6GhLys0aeDHUtmTyr0TGUiIWAoG87NZgQY079B+8sR3hPpqUqdnV6nuj/Dc5CkVsN5kl0ocmpv8njB91ZKpKW3A9bbY9Dfh+PQL65I+cLKQs3/7yYFvnfctuTZlKW7cG4Y5RkVSaUkT8AaH67V5I6iSdyYikf6OqfFhhXDPVRvRK2DvmtqrjfhCqHPyn3Dk5Whs5qxC/IJyqn3KWQOCG/diPT1UzBw+ApRHIHBfCYxrQSONtnF9+tgxTqvk5XcpN17hqijaoOj8re5nmpN1OMghVzlTNpj3uRtxGl/HEUAqWiFlfEBDvjI65qZGuQu7cohwvi36uQDc7c1KH23kEQbX00vPdc3O/jQfirpVEJvlb+6ez6672dZzHMk+X4KA/+heNxWN9hgpepfV1nQzHH1RkAhxLE24k0rlSDgBBwnWaNfCpb4+A2O3m5zHC+3tvVrBJ9mDkU4dxSIWN/xCXWQMVWfbjwsyPsrN5+KaAse/PQLIwtlUg71zY9dmITRAZHlm0rpZkHmiYOOiBFAUFHuKp0p5KFk4bifhKxMhTQjDofj05bmWcMjS5hkqWzXmIDYR8IEPBDO/DDcLDfsR8nhxjrl95Mhj4em4Y1+nwdj+J/fMhDvfs2w6zXo+5LwzeuHCvhZpBUFXJlNIgJuZWJxmhwtQntp4VK/vJmZjoY5l7xTCREoeEEpIctl66w8+SE5ogRzAKv+/KBoJJYnGUi8gYSNXvL55UaB0RNGI1Vki66JQM3gEKmnKq+kKkky5MSBUYYBqCpIGC8zeVketsBU4NWDqrwWAf1PwUATQ4DhnsNUlFYSLcmNS1Vm2IgFKrEHqykxOpeRtjL4Sa2OckUgF97cQumoCrHnZVJ+T6LctbR5zwQl2YnVLTp0hIHyc8ha0NoF1+AmoBshs9dAN0CspqBYVNaDuLENqlEOScEiSp1+/CnxjSnOWWEm6DliW6FYIgM3J5tYyVItKwh14FvI07t4tjelF+B/hKg3F4gYBWqVz7GPxagLHw0t3K+uYOhD82RluyJwL94RQ2cdNKfbCDoJI32sMBH9omPhzCR4F/Af6JdSFjuWzfAAAAABJRU5ErkJggg==";function E8(n){const e=new Date(n*1e3);function t(f){if(f>3&&f<21)return"th";switch(f%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}const i=["January","February","March","April","May","June","July","August","September","October","November","December"],s=e.getDate(),r=i[e.getMonth()],o=e.getFullYear();let a=e.getHours();const l=e.getMinutes().toString().padStart(2,"0"),c=a>=12?"pm":"am";return a=a%12||12,`${s}${t(s)} ${r} ${o}, ${a}:${l}${c}`}const AM=({onClick:n,coursePreviewData:e,onAddDocument:t})=>{var s;const i=Tc();return N.jsx("div",{className:"CoursePreview",onClick:n,children:N.jsxs("div",{className:"course-preview-container",onClick:r=>r.stopPropagation(),children:[N.jsxs("div",{className:"course-header",children:[N.jsxs("div",{className:"course-details",children:[N.jsxs("h2",{className:"course-preview-code",children:[e==null?void 0:e.courseCode,": ",e==null?void 0:e.courseTitle]}),N.jsx("p",{className:"course-date",children:E8((s=e==null?void 0:e.createdAt)==null?void 0:s.seconds)})]}),N.jsxs("div",{className:"course-icons",children:[N.jsx("img",{src:v8,alt:"Edit pdf icon",className:"pointer",onClick:()=>i(Yn.notepadPage.baseUrl+"/"+(e==null?void 0:e.notepadId))}),N.jsx("img",{src:_8,alt:"Add pdf icon",onClick:t,className:"pointer"})]})]}),e.courses.length===0&&N.jsx("p",{children:"No Document Uploaded yet"}),e==null?void 0:e.courses.map((r,o)=>{var a;return N.jsxs("div",{className:"course-preview-pdfs",onClick:l=>i(Yn.lecturePage.baseUrl+"/"+r.courseId),children:[N.jsx("img",{src:w8,alt:"pdf"}),N.jsxs("div",{className:"course-pdf-details",children:[N.jsx("p",{className:"course-preview-title",children:r==null?void 0:r.fileName}),N.jsxs("p",{className:"course-pdf-size",children:[(a=r==null?void 0:r.fileSize)==null?void 0:a.toFixed(2),"Mb"]})]})]},o)})]})})};AM.propTypes={onClick:wM.func.isRequired};const TM=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),A8=(n,e,t,i,s,r,o)=>{o=o||TM(),r=r||(()=>{}),Kr.emit("modal",{title:n,fieldData:e,buttonText:t,onButtonClick:i,id:o,canHide:s,type:"input",onClose:r})},T8=n=>new Promise(async(e,t)=>{try{const i=await C9("Lecture","uid",n);e(i)}catch(i){console.error(i),t(i)}}),S8=(n,e,t)=>new Promise(async(i,s)=>{try{const r=await lb("Lecture",{courseCode:n,courseTitle:e,uid:t,createdAt:new Date,courses:[]}),o=await u8(r);Mg("Lecture",r,{notepadId:o}),i()}catch(r){console.error(r)}}),b8=()=>new Promise((n,e)=>{try{const t=document.createElement("input");t.type="file",t.accept="application/pdf",t.onchange=i=>{const s=i.target.files[0];n(s)},t.click()}catch(t){console.error(t),e(t)}}),I8="lic-store",Wh="Files";function SM(){return new Promise((n,e)=>{const t=indexedDB.open(I8,1);t.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains(Wh)||s.createObjectStore(Wh,{keyPath:"id"})},t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{e(`Database error: ${i.target.error}`)}})}async function C8(n){const e=await SM();return new Promise((t,i)=>{const r=e.transaction(Wh,"readwrite").objectStore(Wh),o=TM(),a={id:o,file:n,timestamp:Date.now()},l=r.put(a);l.onsuccess=()=>{t(o)},l.onerror=c=>{i(`Error storing file: ${c.target.error}`)}})}async function R8(n){const e=await SM();return new Promise((t,i)=>{const o=e.transaction(Wh,"readonly").objectStore(Wh).get(n);o.onsuccess=()=>{t(o.result)},o.onerror=a=>{i(`Error retrieving file: ${a.target.error}`)}})}const UR=()=>{const[n,e]=U.useState(null),[t,i]=U.useState([]),[s,r]=U.useState(!1),{userCredential:o}=Og(),a=async()=>{try{const h=await b8();console.log(h);const f=await C8(h);console.log(f);const p=await R8(f);$f("cccc"),await c8(h,n.courseCode,n.courseTitle,o.uid,n.docId,n.notepadId),window.location.reload()}catch(h){console.error(h),he.error("Could not add document")}finally{Mh("cccc")}},l=()=>{A8("Create Course",[{label:"Enter Course Code",placeholder:"E.g. CSC 201",value:""},{label:"Enter Course Title",placeholder:"E.g. Computer Science",value:""}],"Create Course",async h=>{try{if(!h[0]||!h[1])return;await S8(h[0],h[1],o.uid),r(f=>!f)}catch(f){console.error(f),he.error("Couldn't create lecture")}finally{}},!0,()=>console.log("Modal Closed"))},c=async()=>{try{$f("courses");const h=await T8(o.uid);i(h),console.log(h),Mh("courses")}catch{console.error(),he.error("Couldn't load registered courses")}};return U.useEffect(()=>{o&&c()},[o,s]),N.jsxs("div",{className:"DashboardPage",children:[N.jsx("h2",{className:"dashboard-title fade-down",children:"Registered Courses"}),N.jsxs("div",{className:"all-courses fade-up",children:[t.map((h,f)=>N.jsx(EM,{courseData:h,onClick:()=>e(h)},f)),n&&N.jsx(AM,{coursePreviewData:n,onClick:()=>e(null),onAddDocument:a}),N.jsx("div",{className:"btn-create-course",onClick:l,children:N.jsx("i",{className:"fa-light fa-plus create-course-icon"})})]})]})},k8=()=>{Og();const n=Tc(),e=cP(),[t,i]=U.useState(!1),[s,r]=U.useState(null),[o,a]=U.useState(!1),[l,c]=U.useState([]),[h,f]=U.useState(""),[p,g]=U.useState(!1),y=O=>{const F=l.filter((I,b)=>b!==O);c(F),i(!1),r(null),a(!1)},_=O=>{r(O),i(s!==O||!t),a(!1)},A=O=>{a(!0),r(O)},v=(O,F)=>{const I=[...l];I[F]=O.target.value,c(I)},E=()=>{a(!1)},S=()=>{h.trim()!==""&&(c([...l,h]),f(""))},P=async()=>{try{$f("note");const O=await mM(e.notepadId);c(O.notes),g(!0)}catch(O){console.error(O),he.error("Can't load notebook"),n("/")}finally{Mh("note")}};return U.useEffect(()=>{P()},[]),U.useEffect(()=>{p&&gM(e.notepadId,l).then(()=>{}).catch(()=>{he.error("Can't update notepad")})},[l]),N.jsxs("div",{className:"NotepadPage",children:[N.jsx("div",{className:"notepad-title",children:"Notes"}),N.jsx("ul",{className:"notepad-container",children:l.map((O,F)=>N.jsxs("div",{className:"notepad-list",children:[N.jsxs("div",{className:"notepad-content-container",children:[N.jsx("i",{className:"fa-solid fa-diamond point-marker"}),o&&s===F?N.jsx("textarea",{className:"notepad-textarea",value:l[F],onChange:I=>v(I,F)}):N.jsx("li",{className:"notepad-point",onClick:()=>_(F),children:O})]}),t&&s===F&&N.jsxs("div",{className:"notepad-edit-buttons",children:[o?N.jsxs("button",{className:"notepad-button notepad-save-button",onClick:E,children:["Save Note ",N.jsx("i",{className:"fa-solid fa-check"})]}):N.jsxs("button",{className:"notepad-button notepad-edit-button",onClick:()=>A(F),children:["Edit Note ",N.jsx("i",{className:"fa-solid fa-pen"})]}),N.jsxs("button",{className:"notepad-button notepad-delete-button",onClick:()=>y(F),children:["Delete Note ",N.jsx("i",{className:"fa-solid fa-trash"})]})]})]},F))}),N.jsxs("div",{className:"notepad-add-container",children:[N.jsx("textarea",{className:"notepad-add-content",value:h,onChange:O=>f(O.target.value),placeholder:"Write your new note here..."}),N.jsx("i",{className:"fa-solid fa-circle-arrow-up btn-notepad-submit",onClick:S})]})]})},x8=()=>{const[n,e]=U.useState([]);console.log(n);const t=s=>{console.log(n);var r=[...n];console.log(r),console.log("adding",s),r.push(s),console.log(r),e(null),e(r)},i=s=>{let r=[...n];r=r.filter(o=>o.id!==s),e(r)};return U.useEffect(()=>(Kr.on("modal",s=>t(s)),()=>{Kr.off("modal",s=>t(s))}),[t]),N.jsx(N.Fragment,{children:n.map(s=>s.type==="success"?N.jsx("div",{className:"Modal",children:N.jsx(P8,{fieldData:s==null?void 0:s.fieldData,message:s==null?void 0:s.message,buttonText:s==null?void 0:s.buttonText,onClickButton:s==null?void 0:s.onButtonClick,onHide:r=>{(s.canHide||r)&&(i(s.id),s==null||s.onClose())}})},"success"):s.type==="error"?N.jsx("div",{className:"Modal",children:N.jsx(N8,{fieldData:s==null?void 0:s.fieldData,message:s==null?void 0:s.message,buttonText:s==null?void 0:s.buttonText,onClickButton:s==null?void 0:s.onButtonClick,onHide:r=>{(s.canHide||r)&&(i(s.id||r),s==null||s.onClose())}})},"error"):s.type==="warning"?N.jsx("div",{className:"Modal",children:N.jsx(L8,{fieldData:s==null?void 0:s.fieldData,message:s==null?void 0:s.message,buttonText:s==null?void 0:s.buttonText,onClickButton:s==null?void 0:s.onButtonClick,onHide:r=>{(s.canHide||r)&&(i(s.id),s==null||s.onClose())}})},"warning"):s.type==="input"?N.jsx("div",{className:"Modal",children:N.jsx(D8,{title:s.title,fieldData:s==null?void 0:s.fieldData,buttonText:s==null?void 0:s.buttonText,onClickButton:s==null?void 0:s.onButtonClick,onHide:r=>{(s.canHide||r)&&(i(s.id),s==null||s.onClose())}})},"input"):N.jsx(N.Fragment,{}))})},P8=({onHide:n,onClickButton:e,message:t,buttonText:i})=>N.jsxs("div",{className:"SuccessModal modal-container fade",children:[N.jsx("div",{className:"cancel-block",children:N.jsx("i",{className:"fa-solid fa-xmark",onClick:()=>n(!1)})}),N.jsx("div",{className:"icon-block flex justify-center",children:N.jsx("i",{className:"fa-solid fa-circle-check"})}),N.jsx("div",{className:"message-block flex justify-center w-full",children:N.jsx("p",{children:t})}),N.jsx("div",{className:"button-block w-full ",children:N.jsx("button",{onClick:()=>{e(),n(!0)},children:i||"Okay"})})]}),N8=({onHide:n,onClickButton:e,message:t,buttonText:i})=>N.jsxs("div",{className:"ErrorModal modal-container fade",children:[N.jsx("div",{className:"cancel-block",children:N.jsx("i",{className:"fa-solid fa-xmark",onClick:()=>n(!1)})}),N.jsx("div",{className:"icon-block flex justify-center",children:N.jsx("i",{className:"fa-solid fa-circle-exclamation"})}),N.jsx("div",{className:"message-block flex justify-center w-full",children:N.jsx("p",{children:t})}),N.jsx("div",{className:"button-block w-full ",children:N.jsx("button",{onClick:()=>{e(),n(!0)},children:i||"Okay"})})]}),L8=({onHide:n,onClickButton:e,message:t,buttonText:i})=>N.jsxs("div",{className:"WarningModal modal-container fade",children:[N.jsx("div",{className:"cancel-block",children:N.jsx("i",{className:"fa-solid fa-xmark",onClick:()=>n(!1)})}),N.jsx("div",{className:"icon-block flex justify-center",children:N.jsx("i",{className:"fa-solid fa-triangle-exclamation"})}),N.jsx("div",{className:"message-block flex justify-center w-full",children:N.jsx("p",{children:t})}),N.jsx("div",{className:"button-block w-full ",children:N.jsx("button",{onClick:()=>{e(),n(!0)},children:i||"Okay"})})]}),D8=({title:n,fieldData:e,buttonText:t,onClickButton:i,onHide:s})=>{const[r,o]=U.useState([""]);U.useEffect(()=>{o(new Array(e.length).fill(""))},[e]);const a=()=>{o(c=>new Array(c.length).fill(""))},l=(c,h)=>{let f=[...r];f[c]=h,o(f)};return N.jsxs("div",{className:"InputModal modal-container fade",children:[N.jsx("div",{className:"cancel-block",children:N.jsx("i",{className:"fa-solid fa-xmark",onClick:()=>s(!1)})}),N.jsx("div",{className:"title-block flex justify-center  ",children:N.jsx("p",{children:n||""})}),N.jsx("div",{className:"input-block w-full mt-6 flex flex-col gap-3",children:e.map((c,h)=>N.jsxs("div",{className:"field-block w-full flex flex-col gap-2",children:[N.jsx("p",{children:c.label}),N.jsx("input",{type:"text",placeholder:c.placeholder||"Value here",value:r[h],onChange:f=>l(h,f.target.value)})]}))}),N.jsx("div",{className:"button-block w-full ",children:N.jsx("button",{onClick:()=>{i(r),a(),s(!0)},children:t||"Okay"})})]})},M8=()=>{const[n,e]=U.useState([]),t=s=>{console.log("Adding loader:",s),e(r=>[...r,s])},i=s=>{console.log("Removing loader with id:",s),e(r=>r.filter(o=>o.id!==s))};return U.useEffect(()=>{const s=o=>t(o),r=o=>i(o);return Kr.on("loader",s),Kr.on("hide-loader",r),()=>{Kr.off("loader",s),Kr.off("hide-loader",r)}},[]),U.useEffect(()=>{e(n)},[n]),N.jsx(N.Fragment,{children:n.map(s=>N.jsxs("div",{className:"Loader",children:[N.jsx("img",{src:hS,alt:"Loader logo",className:"anim-infinite-scale"}),N.jsx("p",{children:s.message})]},s.id))})},O8=()=>N.jsxs("div",{className:"LogoComponent flex items-center",children:[N.jsx("img",{src:hS,alt:""}),N.jsxs("div",{className:"name-container flex flex-col",children:[N.jsx("p",{className:"short-name",children:"LIC"}),N.jsx("p",{className:"full-name",children:"Learn in comfort"})]})]}),F8=({onClick:n,photoURL:e})=>N.jsx("img",{src:e,alt:"/img",className:"Avatar",onClick:n}),V8=({visible:n,userCredentials:e,onSignout:t})=>{const[i,s]=U.useState(),[r,o]=U.useState(!1),a=async()=>{try{const c=await P9(e.uid);s(c)}catch(c){console.error(c),he.error("Can't load account information")}},l=async()=>{try{await x9(e.uid,i),o(c=>!c),he("Successfully saved update")}catch(c){console.error(c),he.error("Error saving update")}};return U.useEffect(()=>{e&&a()},[e,n,r]),N.jsxs("div",{className:`AccountComponent ${n?" AccountComponent-active":"AccountComponent-inactive"} flex flex-col items-center`,children:[N.jsx("img",{src:i==null?void 0:i.photoURL,alt:""}),N.jsx("p",{className:"email",children:i==null?void 0:i.email}),N.jsxs("div",{className:"input-block w-full",children:[N.jsx("input",{type:"text",placeholder:"Firstname",value:i==null?void 0:i.firstname,onChange:c=>s(h=>({...h,firstname:c.target.value}))}),N.jsx("input",{type:"text",placeholder:"Lastname",value:i==null?void 0:i.lastname,onChange:c=>s(h=>({...h,lastname:c.target.value}))}),N.jsx("input",{type:"text",placeholder:"School or Instituition",value:i==null?void 0:i.institution,onChange:c=>s(h=>({...h,institution:c.target.value}))})]}),N.jsx("button",{onClick:l,children:"Save changes"}),N.jsxs("div",{className:"signout-container",onClick:t,children:[N.jsx("i",{className:"fa-solid fa-right-from-bracket"}),N.jsx("p",{children:"Signout"})]})]})},U8=()=>{const n=mo(),e=Tc(),{userLiveData:t,signout:i,userCredential:s}=Og(),[r,o]=U.useState(!1);return n.pathname===Yn.authPage.baseUrl?null:N.jsxs("div",{className:"Navbar flex justify-between items-center fade-down",children:[N.jsx("div",{className:"left-container",children:N.jsx(O8,{})}),N.jsxs("div",{className:"right-container flex items-center",children:[N.jsxs("button",{className:"btn-2",onClick:()=>e(Yn.dashboardPage.baseUrl),children:["My Dashboard",N.jsx("i",{className:"fa-solid fa-book-bookmark"})]}),N.jsx(F8,{onClick:()=>{o(!r)},photoURL:t==null?void 0:t.photoURL})]}),N.jsx(V8,{visible:r,userLiveData:t,userCredentials:s,onSignout:()=>{o(!1),i()}})]})};function j8(){return U.useEffect(()=>{},[]),N.jsx("div",{className:"App",children:N.jsx(YU,{children:N.jsxs(M9,{children:[N.jsx(U8,{}),N.jsxs(CU,{children:[N.jsx(Uc,{path:Yn.unresolvedPage.dynamicUrl,element:N.jsx(UR,{})}),N.jsx(Uc,{path:Yn.authPage.dynamicUrl,element:N.jsx(F9,{})}),N.jsx(Uc,{path:Yn.dashboardPage.dynamicUrl,element:N.jsx(UR,{})}),N.jsx(Uc,{path:Yn.notepadPage.dynamicUrl,element:N.jsx(k8,{})}),N.jsx(Uc,{path:Yn.lecturePage.dynamicUrl,element:N.jsx(h8,{})})]}),N.jsx(v4,{position:window.innerWidth>800?"bottom-left":"top-center",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"dark",transition:window.innerWidth>800?m4:EP}),N.jsx(M8,{}),N.jsx(x8,{})]})})})}Zx(document.getElementById("root")).render(N.jsx(U.StrictMode,{children:N.jsx(j8,{})}));
